(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{231:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"openwrt-基础"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openwrt-基础","aria-hidden":"true"}},[t._v("#")]),t._v(" OpenWrt 基础")]),t._v(" "),a("h2",{attrs:{id:"flash-分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flash-分区","aria-hidden":"true"}},[t._v("#")]),t._v(" Flash 分区")]),t._v(" "),a("p",[t._v("Linux系统对闪存类存储器是采用MTD设备驱动实现的。")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.290000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" spi-mt7621 10000b00.spi: sys_freq: 193333333\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.300000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" m25p80 spi32766.0: w25q256 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("32768 Kbytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.300000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" m25p80 spi32766.0: using chunked io\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.310000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 4 ofpart partitions found on MTD device spi32766.0\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.310000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Creating 4 MTD partitions on "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spi32766.0"')]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.320000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 0x000000000000-0x000000030000 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u-boot"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.320000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 0x000000030000-0x000000040000 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u-boot-env"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.330000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 0x000000040000-0x000000050000 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"factory"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.340000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 0x000000050000-0x000002000000 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"firmware"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.410000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 2 uimage-fw partitions found on MTD device firmware\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.410000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 0x000000050000-0x000000168da1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kernel"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.420000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 0x000000168da1-0x000002000000 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rootfs"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.420000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" mtd: device 5 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rootfs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" to be root filesystem\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.430000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 1 squashfs-split partitions found on MTD device rootfs\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("    0.440000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 0x000000620000-0x000002000000 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rootfs_data"')]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])]),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("系统在SPI设备上创建了4个MTD分区")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("分区名")]),t._v(" "),a("th",[t._v("分区作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("u-boot")]),t._v(" "),a("td",[t._v("引导程序")])]),t._v(" "),a("tr",[a("td",[t._v("u-boot-env")]),t._v(" "),a("td",[t._v("引导程序的配置数据")])]),t._v(" "),a("tr",[a("td",[t._v("factory")]),t._v(" "),a("td",[t._v("路由器芯片的初始化参数")])]),t._v(" "),a("tr",[a("td",[t._v("firmware")]),t._v(" "),a("td",[t._v("固件分区")])]),t._v(" "),a("tr",[a("td",[t._v("kernel")]),t._v(" "),a("td",[t._v("固件分区"),a("br"),t._v("Linux 内核")])]),t._v(" "),a("tr",[a("td",[t._v("rootfs")]),t._v(" "),a("td",[t._v("固件分区"),a("br"),t._v("文件系统子集")])]),t._v(" "),a("tr",[a("td",[t._v("rootfs_rom")]),t._v(" "),a("td",[t._v("固件分区"),a("br"),t._v("文件系统子集"),a("br"),t._v("只读分区子集")])]),t._v(" "),a("tr",[a("td",[t._v("rootfs_data")]),t._v(" "),a("td",[t._v("固件分区"),a("br"),t._v("文件系统子集"),a("br"),t._v("可写分区子集")])])])]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("分区存在子分区，kernel和rootfs就是firmware的子分区，rootfs_rom和rootfs_data就是rootfs的子分区。")])]),t._v(" "),a("h3",{attrs:{id:"查看系统-mtd-分配"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看系统-mtd-分配","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看系统 MTD 分配")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat /proc/mtd")]),t._v("\ndev:    size   erasesize  name\nmtd0: 00030000 00010000 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u-boot"')]),t._v("\nmtd1: 00010000 00010000 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u-boot-env"')]),t._v("\nmtd2: 00010000 00010000 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"factory"')]),t._v("\nmtd3: 01fb0000 00010000 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"firmware"')]),t._v("\nmtd4: 00118da1 00010000 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kernel"')]),t._v("\nmtd5: 01e9725f 00010000 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rootfs"')]),t._v("\nmtd6: 019e0000 00010000 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rootfs_data"')]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("h3",{attrs:{id:"查看系统-mtd-分配-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看系统-mtd-分配-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看系统 MTD 分配")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat /proc/partitions ")]),t._v("\nmajor   minor  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#blocks    name")]),t._v("\n31       0        192   mtdblock0\n31       1         64   mtdblock1\n31       2         64   mtdblock2\n31       3      32448   mtdblock3\n31       4       1123   mtdblock4\n31       5      31324   mtdblock5\n31       6      26496   mtdblock6\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("h3",{attrs:{id:"读取-备份-factory-分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读取-备份-factory-分区","aria-hidden":"true"}},[t._v("#")]),t._v(" 读取/备份 factory 分区")]),t._v(" "),a("p",[t._v("factory 分区（位于 /dev/mtd2）保存了重要的配置参数（如MAC地址，天线匹配参数等）。")]),t._v(" "),a("h4",{attrs:{id:"查看分区内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看分区内容","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看分区内容")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# hexdump /dev/mtd2")]),t._v("\n0000000 7628 0001 ef0c d2af b8a9 0000 0000 0000\n0000010 ffff ffff ffff ffff ffff ffff ffff ffff\n0000020 0000 0000 0020 0000 ef0c d2af b8a9 ef0c\n0000030 d2af b9a9 3422 2000 ffff 0100 0000 0000\n0000040 0000 0022 0000 0000 0030 0000 0000 0000\n0000050 0081 9400 b040 c640 c31a c2c3 c5c0 0027\n0000060 ffff ffff ffff ffff ffff ffff ffff ffff\n*\n00000a0 c6c6 c4c4 c0c4 c4c0 c4c4 c0c4 c0c0 0000\n00000b0 ffff ffff ffff ffff ffff ffff ffff ffff\n*\n00000f0 0000 0000 00d1 8800 0000 0000 0000 0000\n0000100 ffff ffff ffff ffff ffff ffff ffff ffff\n*\n0000120 0000 0000 0000 0000 0000 0000 0000 0077\n0000130 1d11 1d11 7f15 7f15 7f17 7f17 3b10 3b10\n0000140 ffff ffff ffff ffff ffff ffff ffff ffff\n*\n0010000\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br")])]),a("h4",{attrs:{id:"备份分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份分区","aria-hidden":"true"}},[t._v("#")]),t._v(" 备份分区")]),t._v(" "),a("p",[t._v("使用 "),a("code",[t._v("dd")]),t._v(" 命令将分区读到一个文件中，然后使用浏览器下载到本地。")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# dd if=/dev/mtd2 of=/www/art.bin")]),t._v("\n128+0 records "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v("\n128+0 records out\nroot@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls -l /www/art.bin")]),t._v("\n-rw-r--r--    1 root     root         65536 Apr 27 18:26 /www/art.bin\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h2",{attrs:{id:"文件系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件系统","aria-hidden":"true"}},[t._v("#")]),t._v(" 文件系统")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# df")]),t._v("\nFilesystem           1K-blocks      Used Available Use% Mounted on\nrootfs                   26496       752     25744   3% /\n/dev/root                 4864      4864         0 100% /rom\ntmpfs                    63232        84     63148   0% /tmp\n/dev/mtdblock6           26496       752     25744   3% /overlay\noverlayfs:/overlay       26496       752     25744   3% /\ntmpfs                      512         0       512   0% /dev\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("ol",[a("li",[t._v("引导程序启动内核完成后，由内核加载 "),a("code",[t._v("rootfs_rom")]),t._v(" 只读分区来完成系统的初步启动。"),a("code",[t._v("rootfs_rom")]),t._v(" 只读分区采用的是 Linux 内核支持的 "),a("strong",[t._v("squashFS")]),t._v(" 文件系统，加载完毕后将其挂载到 "),a("code",[t._v("/rom")]),t._v(" 目录，同时也挂载为 "),a("code",[t._v("/")]),t._v(" 目录。")]),t._v(" "),a("li",[t._v("系统将使用 "),a("strong",[t._v("JFFS2")]),t._v(" 文件系统格式化的 "),a("code",[t._v("rootfs_data")]),t._v(" 可写文件分区并将这部分挂载到 "),a("code",[t._v("/overlay")]),t._v(" 目录。")]),t._v(" "),a("li",[t._v("系统再将 "),a("code",[t._v("/overlay")]),t._v(" 透明挂载为 "),a("code",[t._v("/")]),t._v(" 根目录。")]),t._v(" "),a("li",[t._v("最后将一部分内存挂载为"),a("code",[t._v("/tmp")]),t._v(" 目录。")])]),t._v(" "),a("h3",{attrs:{id:"透明挂载根目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#透明挂载根目录","aria-hidden":"true"}},[t._v("#")]),t._v(" 透明挂载根目录 /")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("OpenWrt 设计的一个特点是：系统先将 "),a("code",[t._v("rootfs_rom")]),t._v(" 挂载为 "),a("code",[t._v("/")]),t._v(" 根目录，这样就具备了一个完整的系统，然后再将 "),a("code",[t._v("rootfs_data")]),t._v(" 以透明方式挂载在 "),a("code",[t._v("/")]),t._v(" 根目录上。")])]),t._v(" "),a("ul",[a("li",[t._v("最终呈现的根文件系统是由 "),a("code",[t._v("rootfs_rom")]),t._v(" 和 "),a("code",[t._v("rootfs_data")]),t._v(" 两个分区组合在一起的效果。")]),t._v(" "),a("li",[t._v("对任何文件的修改（增、删、改）都会记录在 "),a("code",[t._v("rootfs_data")]),t._v(" 分区中。")]),t._v(" "),a("li",[t._v("读取文件内容时，首先检测 "),a("code",[t._v("rootfs_data")]),t._v(" 里的状态，再检测 "),a("code",[t._v("roots_rom")]),t._v(" 里的内容，最后输出结果。")])]),t._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",[t._v("如果修改了一个名为 abc 的文件，那么在 "),a("code",[t._v("/rom")]),t._v(" 里还会保留修改之前的那个 abc 文件，同时在 "),a("code",[t._v("/overlay")]),t._v(" 里有修改后的 abc 文件，因此所占的空间将会倍增。这样带来的一个好处是，在任何时候，只要删除 "),a("code",[t._v("/overlay")]),t._v(" 里所有的文件，就能达到恢复出厂的效果。")])]),t._v(" "),a("h3",{attrs:{id:"常用文件夹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用文件夹","aria-hidden":"true"}},[t._v("#")]),t._v(" 常用文件夹")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("文件夹路径")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("/etc/")]),t._v(" "),a("td",[t._v("存放系统所有的配置文件")])]),t._v(" "),a("tr",[a("td",[t._v("/etc/init.d/")]),t._v(" "),a("td",[t._v("存放启动的服务脚本")])]),t._v(" "),a("tr",[a("td",[t._v("/etc/config/")]),t._v(" "),a("td",[t._v("存放 OpenWrt 的配置文件，包括网络")])]),t._v(" "),a("tr",[a("td",[t._v("/tmp/")]),t._v(" "),a("td",[t._v("存放临时文件和动态的配置文件")])]),t._v(" "),a("tr",[a("td",[t._v("/tmp/TZ")]),t._v(" "),a("td",[t._v("系统启动后所使用的时区参数")])])])]),t._v(" "),a("h2",{attrs:{id:"软件包管理器-opkg"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#软件包管理器-opkg","aria-hidden":"true"}},[t._v("#")]),t._v(" 软件包管理器 OPKG")]),t._v(" "),a("h3",{attrs:{id:"配置-opkg"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-opkg","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置 OPKG")]),t._v(" "),a("p",[a("code",[t._v("/etc/opkg.conf")]),t._v(" 文件保存 OPKG 相关设置：")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat /etc/opkg.conf ")]),t._v("\ndest root /\ndest "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ram")]),t._v(" /tmp\nlists_dir ext /var/opkg-lists\noption overlay_root /overlay\noption check_signature 1\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("table",[a("thead",[a("tr",[a("th",[t._v("配置选项")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("dest root")]),t._v(" "),a("td",[t._v("安装目标的跟路径")])]),t._v(" "),a("tr",[a("td",[t._v("dest ram")]),t._v(" "),a("td",[t._v("内存临时文件路径")])]),t._v(" "),a("tr",[a("td",[t._v("lists_dir ext")]),t._v(" "),a("td",[t._v("软件包列表文件")])]),t._v(" "),a("tr",[a("td",[t._v("option overlay_root")]),t._v(" "),a("td",[t._v("可写分区挂载位置")])])])]),t._v(" "),a("h3",{attrs:{id:"常用命令搭配"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用命令搭配","aria-hidden":"true"}},[t._v("#")]),t._v(" 常用命令搭配")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("命令")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("opkg update")]),t._v(" "),a("td",[t._v("下载服务器上可用的软件包列表")])]),t._v(" "),a("tr",[a("td",[t._v("opkg upgrade <package>")]),t._v(" "),a("td",[t._v("升级软件包")])]),t._v(" "),a("tr",[a("td",[t._v("opkg install <package>")]),t._v(" "),a("td",[t._v("安装软件包")])]),t._v(" "),a("tr",[a("td",[t._v("opkg configure <package>")]),t._v(" "),a("td",[t._v("配置某一个软件包")])]),t._v(" "),a("tr",[a("td",[t._v("opkg remove <package>")]),t._v(" "),a("td",[t._v("卸载软件包")])]),t._v(" "),a("tr",[a("td",[t._v("opkg list")]),t._v(" "),a("td",[t._v("列出全部可用的软件包")])]),t._v(" "),a("tr",[a("td",[t._v("opkg list-installed")]),t._v(" "),a("td",[t._v("列出已安装的软件包")])]),t._v(" "),a("tr",[a("td",[t._v("opkg list-upgradable")]),t._v(" "),a("td",[t._v("列出可以升级的软件包")])]),t._v(" "),a("tr",[a("td",[t._v("opkg info [package|regexp]")]),t._v(" "),a("td",[t._v("显示指定软件包的信息")])]),t._v(" "),a("tr",[a("td",[t._v("opkg status [package|regexp]")]),t._v(" "),a("td",[t._v("显示指定软件包的状态")])]),t._v(" "),a("tr",[a("td",[t._v("opkg download <package>")]),t._v(" "),a("td",[t._v("下载一个软件包到当前目录，但不安装")])])])]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("软件包列表可能会比较大，因此并不保存在系统中，每次启动需要首先执行 "),a("code",[t._v("opkg update")]),t._v(" 取得最新的软件包。")])]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# opkg update")]),t._v("\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/base/Packages.gz.\nUpdated list of available packages "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /var/opkg-lists/chaos_calmer_base.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/base/Packages.sig.\nSignature check passed.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/luci/Packages.gz.\nUpdated list of available packages "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /var/opkg-lists/chaos_calmer_luci.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/luci/Packages.sig.\nSignature check passed.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/management/Packages.gz.\nUpdated list of available packages "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /var/opkg-lists/chaos_calmer_management.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/management/Packages.sig.\nSignature check passed.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/packages/Packages.gz.\nUpdated list of available packages "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /var/opkg-lists/chaos_calmer_packages.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/packages/Packages.sig.\nSignature check passed.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/routing/Packages.gz.\nUpdated list of available packages "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /var/opkg-lists/chaos_calmer_routing.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/routing/Packages.sig.\nSignature check passed.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/telephony/Packages.gz.\nUpdated list of available packages "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /var/opkg-lists/chaos_calmer_telephony.\nDownloading http://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/mt7688/packages/telephony/Packages.sig.\nSignature check passed.\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br")])]),a("h2",{attrs:{id:"uci-命令系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uci-命令系统","aria-hidden":"true"}},[t._v("#")]),t._v(" UCI 命令系统")]),t._v(" "),a("p",[t._v("UCI (Unified Configuration Interface) 是 OpenWrt 中配置参数管理系统，UCI 中已经包含了网络配置、无线配置、系统信息配置等基本路由器所需的主要配置参数。")]),t._v(" "),a("p",[t._v("UCI 配置文件全部存储在 "),a("code",[t._v("/etc/config")]),t._v(" 目录下：")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls /etc/config/")]),t._v("\ndhcp           fstab          mountd         shairport      uhttpd\ndropbear       luci           network        system         wireless\nfirewall       mjpg-streamer  rpcd           ucitrack\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("常见的 UCI 配置：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("配置文件")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("/etc/config/dhcp")]),t._v(" "),a("td",[t._v("面向 LAN 口提供的 IP 地址分配服务配置")])]),t._v(" "),a("tr",[a("td",[t._v("/etc/config/dropbear")]),t._v(" "),a("td",[t._v("SSH 服务配置")])]),t._v(" "),a("tr",[a("td",[t._v("/etc/config/firewall")]),t._v(" "),a("td",[t._v("路由转发，端口转发，防火墙规则")])]),t._v(" "),a("tr",[a("td",[t._v("/etc/config/network")]),t._v(" "),a("td",[t._v("自身网络接口配置")])]),t._v(" "),a("tr",[a("td",[t._v("/etc/config/system")]),t._v(" "),a("td",[t._v("时间服务器时区配置")])]),t._v(" "),a("tr",[a("td",[t._v("/etc/config/wireless")]),t._v(" "),a("td",[t._v("无线网络配置")])])])]),t._v(" "),a("p",[t._v("支持 UCI 管理模式的软件包是这样完成启动的（以 "),a("strong",[t._v("samba")]),t._v(" 软件为例）：")]),t._v(" "),a("ol",[a("li",[t._v("启动脚本 "),a("code",[t._v("/etc/init.d/samba")])]),t._v(" "),a("li",[t._v("启动脚本通过 UCI 分析库从 "),a("code",[t._v("/etc/config/samba")]),t._v(" 获得启动参数")]),t._v(" "),a("li",[t._v("启动脚本完成正常启动")])]),t._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",[t._v("UCI 配置文件既可以使用 UCI 命令进行修改，也可以使用文本编辑器直接修改。但如果两种方式都使用，需要注意 UCI 命令修改会产生缓存，每次修改好要尽快保存确认，以免出现冲突。")])]),t._v(" "),a("h3",{attrs:{id:"uci-文件格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uci-文件格式","aria-hidden":"true"}},[t._v("#")]),t._v(" UCI 文件格式")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("config 'section-type' 'section'\n\toption 'key' 'value'\n\toption 'list_key' 'list_value1'\n\toption 'list_key' 'list_value2'\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("UCI 允许只有 "),a("strong",[t._v("section-type")]),t._v(" 的匿名配置节点。")])]),t._v(" "),a("h3",{attrs:{id:"uci-命令读写配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uci-命令读写配置","aria-hidden":"true"}},[t._v("#")]),t._v(" UCI 命令读写配置")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("uci "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("option"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("command"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("arguments"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h4",{attrs:{id:"读取类语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读取类语法","aria-hidden":"true"}},[t._v("#")]),t._v(" 读取类语法")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("命令")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("uci get <config>.<section>")]),t._v(" "),a("td",[t._v("获取节点类型")])]),t._v(" "),a("tr",[a("td",[t._v("uci get <config>.<section>.<option>")]),t._v(" "),a("td",[t._v("获取取得一个值")])]),t._v(" "),a("tr",[a("td",[t._v("uci show")]),t._v(" "),a("td",[t._v("显示全部 UCI 配置")])]),t._v(" "),a("tr",[a("td",[t._v("uci show <config>")]),t._v(" "),a("td",[t._v("显示指定文件配置")])]),t._v(" "),a("tr",[a("td",[t._v("uci show <config>.<section>")]),t._v(" "),a("td",[t._v("显示指定节点的配置")])]),t._v(" "),a("tr",[a("td",[t._v("uci show <config>.<section>.<option>")]),t._v(" "),a("td",[t._v("显示指定选项配置")])]),t._v(" "),a("tr",[a("td",[t._v("uci changes <config>")]),t._v(" "),a("td",[t._v("显示尚未生效的修改记录")])]),t._v(" "),a("tr",[a("td",[t._v("uci show -X <config>.<section>.<option>")]),t._v(" "),a("td",[t._v("显示匿名节点")])])])]),t._v(" "),a("h4",{attrs:{id:"写入类语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#写入类语法","aria-hidden":"true"}},[t._v("#")]),t._v(" 写入类语法")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("命令")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("uci add <config> <section-type>")]),t._v(" "),a("td",[t._v("增加一个匿名节点")])]),t._v(" "),a("tr",[a("td",[t._v("uci set <config>.<section> = <section-type>")]),t._v(" "),a("td",[t._v("增加一个节点/修改节点类型")])]),t._v(" "),a("tr",[a("td",[t._v("uci set <config>.<section>.<option> = <value>")]),t._v(" "),a("td",[t._v("增加一个选项值/修改一个选项值")])]),t._v(" "),a("tr",[a("td",[t._v("uci add_list <config>.<section>.<option> = <value>")]),t._v(" "),a("td",[t._v("在列表中增加一个值")])]),t._v(" "),a("tr",[a("td",[t._v("uci delete <config>.<section>")]),t._v(" "),a("td",[t._v("删除指定节点")])]),t._v(" "),a("tr",[a("td",[t._v("uci delete <config>.<section>.<option>")]),t._v(" "),a("td",[t._v("删除指定选项")])]),t._v(" "),a("tr",[a("td",[t._v("uci delete <config>.<section>.<list>")]),t._v(" "),a("td",[t._v("删除列表")])]),t._v(" "),a("tr",[a("td",[t._v("uci del_list <config>.<section>.<option> = <string>")]),t._v(" "),a("td",[t._v("删除列表中的一个值")])]),t._v(" "),a("tr",[a("td",[t._v("uci commit <config>")]),t._v(" "),a("td",[t._v("使修改生效")])])])]),t._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",[t._v("UCI 读取总是先读取内存中的缓存，然后再读取文件中的。进行过增删改操作后要执行生效指令，否则所有的修改只留存在缓存中。")])]),t._v(" "),a("h2",{attrs:{id:"常用配置操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用配置操作","aria-hidden":"true"}},[t._v("#")]),t._v(" 常用配置操作")]),t._v(" "),a("h3",{attrs:{id:"查看-system-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看-system-配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看 system 配置")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat /etc/config/system ")]),t._v("\nconfig system\n\toption "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hostname")]),t._v("\tWidora\n\toption timezone\tCST-8\n\nconfig timeserver ntp\n\tlist server\t0.openwrt.pool.ntp.org\n\tlist server\t1.openwrt.pool.ntp.org\n\tlist server\t2.openwrt.pool.ntp.org\n\tlist server\t3.openwrt.pool.ntp.org\n\toption enabled 1\n\toption enable_server 0\nroot@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# uci show system")]),t._v("\nsystem.@system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("system\nsystem.@system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(".hostname"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Widora'")]),t._v("\nsystem.@system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(".timezone"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CST-8'")]),t._v("\nsystem.ntp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("timeserver\nsystem.ntp.server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0.openwrt.pool.ntp.org'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1.openwrt.pool.ntp.org'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2.openwrt.pool.ntp.org'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3.openwrt.pool.ntp.org'")]),t._v("\nsystem.ntp.enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v("\nsystem.ntp.enable_server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br")])]),a("h3",{attrs:{id:"查看网络配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看网络配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看网络配置")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat /etc/config/network ")]),t._v("\n\nconfig interface "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'loopback'")]),t._v("\n\toption ifname "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lo'")]),t._v("\n\toption proto "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'static'")]),t._v("\n\toption ipaddr "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'127.0.0.1'")]),t._v("\n\toption netmask "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'255.0.0.0'")]),t._v("\n\nconfig globals "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'globals'")]),t._v("\n\toption ula_prefix "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fdff:c5b2:821c::/48'")]),t._v("\n\nconfig interface "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lan'")]),t._v("\n\toption force_link "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v("\n\toption macaddr "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0c:ef:af:d2:a9:b9'")]),t._v("\n\toption "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bridge'")]),t._v("\n\toption proto "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'static'")]),t._v("\n\toption ipaddr "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'192.168.8.1'")]),t._v("\n\toption netmask "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'255.255.255.0'")]),t._v("\n\toption ip6assign "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'60'")]),t._v("\n\toption ifname "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'eth0.1'")]),t._v("\n\nconfig interface "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wan'")]),t._v("\n\toption force_link "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v("\n\toption macaddr "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0c:ef:af:d2:a9:b8'")]),t._v("\n\toption proto "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dhcp'")]),t._v("\n\toption ifname "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'eth0.2'")]),t._v("\n\nconfig interface "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wan6'")]),t._v("\n\toption proto "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dhcpv6'")]),t._v("\n\toption ifname "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'eth0.2'")]),t._v("\n\nconfig switch\n\toption name "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'switch0'")]),t._v("\n\toption reset "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v("\n\toption enable_vlan "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v("\n\nconfig switch_vlan\n\toption device "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'switch0'")]),t._v("\n\toption vlan "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v("\n\toption ports "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1 2 3 4 6t'")]),t._v("\n\nconfig switch_vlan\n\toption device "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'switch0'")]),t._v("\n\toption vlan "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\toption ports "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0 6t'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br"),a("span",{staticClass:"line-number"},[t._v("39")]),a("br"),a("span",{staticClass:"line-number"},[t._v("40")]),a("br"),a("span",{staticClass:"line-number"},[t._v("41")]),a("br"),a("span",{staticClass:"line-number"},[t._v("42")]),a("br"),a("span",{staticClass:"line-number"},[t._v("43")]),a("br"),a("span",{staticClass:"line-number"},[t._v("44")]),a("br"),a("span",{staticClass:"line-number"},[t._v("45")]),a("br")])]),a("h3",{attrs:{id:"重启网络使配置生效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启网络使配置生效","aria-hidden":"true"}},[t._v("#")]),t._v(" 重启网络使配置生效")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/init.d/network restart")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"开启-wi-fi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开启-wi-fi","aria-hidden":"true"}},[t._v("#")]),t._v(" 开启 Wi-Fi")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("uci "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" wireless.radio0.disabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("0 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使能 Wi-Fi")]),t._v("\nuci commit wireless "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使配置生效")]),t._v("\nwifi "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动 Wi-Fi")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h3",{attrs:{id:"查看当前网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看当前网络","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看当前网络")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ifconfig")]),t._v("\nbr-lan    Link encap:Ethernet  HWaddr 0C:EF:AF:D2:A9:B9  \n          inet addr:192.168.8.1  Bcast:192.168.8.255  Mask:255.255.255.0\n          inet6 addr: fe80::eef:afff:fed2:a9b9/64 Scope:Link\n          inet6 addr: fdff:c5b2:821c::1/60 Scope:Global\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:574264 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:1217669 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0 \n          RX bytes:48102567 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("45.8 MiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  TX bytes:1634912136 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1.5 GiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\neth0      Link encap:Ethernet  HWaddr 0C:EF:AF:D2:A9:B8  \n          inet6 addr: fe80::eef:afff:fed2:a9b8/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:1225320 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:579507 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:1641989813 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1.5 GiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  TX bytes:59132909 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("56.3 MiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          Interrupt:5 \n\neth0.1    Link encap:Ethernet  HWaddr 0C:EF:AF:D2:A9:B8  \n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:1 errors:0 dropped:1 overruns:0 frame:0\n          TX packets:3544 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0 \n          RX bytes:46 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("46.0 B"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  TX bytes:244206 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("238.4 KiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\neth0.2    Link encap:Ethernet  HWaddr 0C:EF:AF:D2:A9:B8  \n          inet addr:192.168.1.5  Bcast:192.168.1.255  Mask:255.255.255.0\n          inet6 addr: fe80::eef:afff:fed2:a9b8/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:1176423 errors:0 dropped:10706 overruns:0 frame:0\n          TX packets:575928 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0 \n          RX bytes:1617670919 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1.5 GiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  TX bytes:56565373 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("53.9 MiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nlo        Link encap:Local Loopback  \n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:294 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:294 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0 \n          RX bytes:41961 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("40.9 KiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  TX bytes:41961 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("40.9 KiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nra0       Link encap:Ethernet  HWaddr 0C:EF:AF:D2:A9:B8  \n          inet6 addr: fe80::eef:afff:fed2:a9b8/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:641847 errors:830 dropped:0 overruns:0 frame:0\n          TX packets:1228723 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:70965355 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("67.6 MiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  TX bytes:1630822247 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1.5 GiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          Interrupt:6 \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br"),a("span",{staticClass:"line-number"},[t._v("39")]),a("br"),a("span",{staticClass:"line-number"},[t._v("40")]),a("br"),a("span",{staticClass:"line-number"},[t._v("41")]),a("br"),a("span",{staticClass:"line-number"},[t._v("42")]),a("br"),a("span",{staticClass:"line-number"},[t._v("43")]),a("br"),a("span",{staticClass:"line-number"},[t._v("44")]),a("br"),a("span",{staticClass:"line-number"},[t._v("45")]),a("br"),a("span",{staticClass:"line-number"},[t._v("46")]),a("br"),a("span",{staticClass:"line-number"},[t._v("47")]),a("br"),a("span",{staticClass:"line-number"},[t._v("48")]),a("br"),a("span",{staticClass:"line-number"},[t._v("49")]),a("br"),a("span",{staticClass:"line-number"},[t._v("50")]),a("br"),a("span",{staticClass:"line-number"},[t._v("51")]),a("br"),a("span",{staticClass:"line-number"},[t._v("52")]),a("br"),a("span",{staticClass:"line-number"},[t._v("53")]),a("br")])]),a("table",[a("thead",[a("tr",[a("th",[t._v("网络设备名")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("br-lan")]),t._v(" "),a("td",[t._v("虚拟设备，LAN 口桥接设备，包含通过 LAN 口和 WAN 口连入系统的设备统一桥接")])]),t._v(" "),a("tr",[a("td",[t._v("eth0")]),t._v(" "),a("td",[t._v("真实设备，CPU 内部到交换机芯片之间只有一个接口")])]),t._v(" "),a("tr",[a("td",[t._v("eth0.1")]),t._v(" "),a("td",[t._v("虚拟设备，由 VLAN 划分的有线的 LAN 口，VLAN 编号为 1")])]),t._v(" "),a("tr",[a("td",[t._v("eth0.2")]),t._v(" "),a("td",[t._v("虚拟设备，由 VLAN 划分的有线的 LAN 口，VLAN编号为 2")])]),t._v(" "),a("tr",[a("td",[t._v("lo")]),t._v(" "),a("td",[t._v("虚拟设备，回环设备")])]),t._v(" "),a("tr",[a("td",[t._v("ra0")]),t._v(" "),a("td",[t._v("真实设备，启动 Wi-Fi 后将会产生此无线设备")])]),t._v(" "),a("tr",[a("td",[t._v("pppoe-wan")]),t._v(" "),a("td",[t._v("虚拟设备，是 PPPoE 拨号上网成功后产生的")])])])]),t._v(" "),a("h3",{attrs:{id:"查看-br-lan-桥状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看-br-lan-桥状态","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看 br-lan 桥状态")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# brctl show")]),t._v("\nbridge name\tbridge "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("id")]),t._v("\t\t\tSTP enabled\tinterfaces\nbr-lan\t\t7fff.0cefafd2a9b9\tno\t\t\teth0.1\n\t\t\t\t\t\t\t\t\t\t\tra0\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("h3",{attrs:{id:"查看内核日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看内核日志","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看内核日志")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# logread ")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"查看当前-vlan-划分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看当前-vlan-划分","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看当前 VLAN 划分")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# swconfig dev switch0 show")]),t._v("\nGlobal attributes:\n\tenable_vlan: 1\n\talternate_vlan_disable: 0\n\tbc_storm_protect: 0\n\tled_frequency: 0\nPort 0:\n\tdisable: 0\n\tdoubletag: 0\n\tuntag: 1\n\tled: 5\n\tlan: 1\n\trecv_bad: 0\n\trecv_good: 2205\n\ttr_bad: 0\n\ttr_good: 52155\n\tpvid: 2\n\tlink: port:0 link:up speed:100baseT full-duplex \nPort 1:\n\tdisable: 0\n\tdoubletag: 0\n\tuntag: 1\n\tled: 5\n\tlan: 1\n\trecv_bad: 0\n\trecv_good: 0\n\ttr_bad: 0\n\ttr_good: 0\n\tpvid: 1\n\tlink: port:1 link:down\nPort 2:\n\tdisable: 0\n\tdoubletag: 0\n\tuntag: 1\n\tled: 5\n\tlan: 1\n\trecv_bad: 0\n\trecv_good: 0\n\ttr_bad: 0\n\ttr_good: 0\n\tpvid: 1\n\tlink: port:2 link:down\nPort 3:\n\tdisable: 0\n\tdoubletag: 0\n\tuntag: 1\n\tled: 5\n\tlan: 1\n\trecv_bad: 0\n\trecv_good: 0\n\ttr_bad: 0\n\ttr_good: 0\n\tpvid: 1\n\tlink: port:3 link:down\nPort 4:\n\tdisable: 0\n\tdoubletag: 0\n\tuntag: 1\n\tled: 5\n\tlan: 1\n\trecv_bad: 0\n\trecv_good: 0\n\ttr_bad: 0\n\ttr_good: 0\n\tpvid: 1\n\tlink: port:4 link:down\nPort 5:\n\tdisable: 1\n\tdoubletag: 0\n\tuntag: 0\n\tled: ???\n\tlan: 1\n\trecv_bad: 0\n\trecv_good: 0\n\ttr_bad: 0\n\ttr_good: 0\n\tpvid: 0\n\tlink: port:5 link:down\nPort 6:\n\tdisable: 0\n\tdoubletag: 0\n\tuntag: 0\n\tled: ???\n\tlan: ???\n\trecv_bad: ???\n\trecv_good: ???\n\ttr_bad: ???\n\ttr_good: ???\n\tpvid: 0\n\tlink: port:6 link:up speed:1000baseT full-duplex \nVLAN 1:\n\tports: 1 2 3 4 6t \nVLAN 2:\n\tports: 0 6t \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br"),a("span",{staticClass:"line-number"},[t._v("39")]),a("br"),a("span",{staticClass:"line-number"},[t._v("40")]),a("br"),a("span",{staticClass:"line-number"},[t._v("41")]),a("br"),a("span",{staticClass:"line-number"},[t._v("42")]),a("br"),a("span",{staticClass:"line-number"},[t._v("43")]),a("br"),a("span",{staticClass:"line-number"},[t._v("44")]),a("br"),a("span",{staticClass:"line-number"},[t._v("45")]),a("br"),a("span",{staticClass:"line-number"},[t._v("46")]),a("br"),a("span",{staticClass:"line-number"},[t._v("47")]),a("br"),a("span",{staticClass:"line-number"},[t._v("48")]),a("br"),a("span",{staticClass:"line-number"},[t._v("49")]),a("br"),a("span",{staticClass:"line-number"},[t._v("50")]),a("br"),a("span",{staticClass:"line-number"},[t._v("51")]),a("br"),a("span",{staticClass:"line-number"},[t._v("52")]),a("br"),a("span",{staticClass:"line-number"},[t._v("53")]),a("br"),a("span",{staticClass:"line-number"},[t._v("54")]),a("br"),a("span",{staticClass:"line-number"},[t._v("55")]),a("br"),a("span",{staticClass:"line-number"},[t._v("56")]),a("br"),a("span",{staticClass:"line-number"},[t._v("57")]),a("br"),a("span",{staticClass:"line-number"},[t._v("58")]),a("br"),a("span",{staticClass:"line-number"},[t._v("59")]),a("br"),a("span",{staticClass:"line-number"},[t._v("60")]),a("br"),a("span",{staticClass:"line-number"},[t._v("61")]),a("br"),a("span",{staticClass:"line-number"},[t._v("62")]),a("br"),a("span",{staticClass:"line-number"},[t._v("63")]),a("br"),a("span",{staticClass:"line-number"},[t._v("64")]),a("br"),a("span",{staticClass:"line-number"},[t._v("65")]),a("br"),a("span",{staticClass:"line-number"},[t._v("66")]),a("br"),a("span",{staticClass:"line-number"},[t._v("67")]),a("br"),a("span",{staticClass:"line-number"},[t._v("68")]),a("br"),a("span",{staticClass:"line-number"},[t._v("69")]),a("br"),a("span",{staticClass:"line-number"},[t._v("70")]),a("br"),a("span",{staticClass:"line-number"},[t._v("71")]),a("br"),a("span",{staticClass:"line-number"},[t._v("72")]),a("br"),a("span",{staticClass:"line-number"},[t._v("73")]),a("br"),a("span",{staticClass:"line-number"},[t._v("74")]),a("br"),a("span",{staticClass:"line-number"},[t._v("75")]),a("br"),a("span",{staticClass:"line-number"},[t._v("76")]),a("br"),a("span",{staticClass:"line-number"},[t._v("77")]),a("br"),a("span",{staticClass:"line-number"},[t._v("78")]),a("br"),a("span",{staticClass:"line-number"},[t._v("79")]),a("br"),a("span",{staticClass:"line-number"},[t._v("80")]),a("br"),a("span",{staticClass:"line-number"},[t._v("81")]),a("br"),a("span",{staticClass:"line-number"},[t._v("82")]),a("br"),a("span",{staticClass:"line-number"},[t._v("83")]),a("br"),a("span",{staticClass:"line-number"},[t._v("84")]),a("br"),a("span",{staticClass:"line-number"},[t._v("85")]),a("br"),a("span",{staticClass:"line-number"},[t._v("86")]),a("br"),a("span",{staticClass:"line-number"},[t._v("87")]),a("br"),a("span",{staticClass:"line-number"},[t._v("88")]),a("br"),a("span",{staticClass:"line-number"},[t._v("89")]),a("br"),a("span",{staticClass:"line-number"},[t._v("90")]),a("br"),a("span",{staticClass:"line-number"},[t._v("91")]),a("br"),a("span",{staticClass:"line-number"},[t._v("92")]),a("br"),a("span",{staticClass:"line-number"},[t._v("93")]),a("br"),a("span",{staticClass:"line-number"},[t._v("94")]),a("br")])]),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("哪个网口是 LAN， 哪个是 WAN， 是由 VLAN 划分的。VLAN1 为 LAN 口，包含 1、2、3、4 接口；VLAN2 为 WAN 口，包含了 0 接口。")])]),t._v(" "),a("h3",{attrs:{id:"配置-wan-口外网"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-wan-口外网","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置 WAN 口外网")]),t._v(" "),a("h4",{attrs:{id:"查看-wan-口配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看-wan-口配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看 WAN 口配置")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# uci show network.wan")]),t._v("\nnetwork.wan"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("interface\nnetwork.wan.force_link"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v("\nnetwork.wan.macaddr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0c:ef:af:d2:a9:b8'")]),t._v("\nnetwork.wan.proto"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dhcp'")]),t._v("\nnetwork.wan.ifname"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'eth0.2'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("说明")]),t._v(" "),a("th",[t._v("可选值")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("ifname")]),t._v(" "),a("td",[t._v("设备接口名")]),t._v(" "),a("td",[t._v("eth0.2")])]),t._v(" "),a("tr",[a("td",[t._v("proto")]),t._v(" "),a("td",[t._v("协议类型")]),t._v(" "),a("td",[t._v("static：静态 IP 地址"),a("br"),t._v("dhcp：动态获取 IP 地址"),a("br"),t._v("pppoe：拨号上网"),a("br"),t._v("pptp：远程 VPN 服务器"),a("br"),t._v("3g：连接 3G/4G 无线电话网络")])]),t._v(" "),a("tr",[a("td",[t._v("macaddr")]),t._v(" "),a("td",[t._v("WAN 口 MAC 地址，修改该地址即可实现 MAC 地址克隆")]),t._v(" "),a("td",[t._v("首次数据根据 factory 分区内参数自动生成")])])])]),t._v(" "),a("h4",{attrs:{id:"动态获取-ip-选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态获取-ip-选项","aria-hidden":"true"}},[t._v("#")]),t._v(" 动态获取 IP 选项")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("说明")]),t._v(" "),a("th",[t._v("可选值及说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("proto")]),t._v(" "),a("td",[t._v("协议类型")]),t._v(" "),a("td",[t._v("dhcp")])]),t._v(" "),a("tr",[a("td",[t._v("ifname")]),t._v(" "),a("td",[t._v("设备名称")]),t._v(" "),a("td",[t._v("eth0.2")])]),t._v(" "),a("tr",[a("td",[t._v("macaddr")]),t._v(" "),a("td",[t._v("MAC 地址")]),t._v(" "),a("td",[t._v("根据 factory 分区自动生成的值")])]),t._v(" "),a("tr",[a("td",[t._v("mtu")]),t._v(" "),a("td",[t._v("最大数据包大小，默认不用设置")]),t._v(" "),a("td",[t._v("数值")])]),t._v(" "),a("tr",[a("td",[t._v("reqopts")]),t._v(" "),a("td",[t._v("在向 DHCP 服务器发出请求时增加附加的 DHCP 信息")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("dns")]),t._v(" "),a("td",[t._v("使用指定的 DNS 服务器地址替代获得的 DNS")]),t._v(" "),a("td",[t._v("字符串")])])])]),t._v(" "),a("h4",{attrs:{id:"指定静态-ip-选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#指定静态-ip-选项","aria-hidden":"true"}},[t._v("#")]),t._v(" 指定静态 IP 选项")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("说明")]),t._v(" "),a("th",[t._v("可选值及说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("proto")]),t._v(" "),a("td",[t._v("协议类型")]),t._v(" "),a("td",[t._v("static")])]),t._v(" "),a("tr",[a("td",[t._v("ifname")]),t._v(" "),a("td",[t._v("设备名称")]),t._v(" "),a("td",[t._v("eth0.2")])]),t._v(" "),a("tr",[a("td",[t._v("macaddr")]),t._v(" "),a("td",[t._v("MAC 地址")]),t._v(" "),a("td",[t._v("根据 factory 分区自动生成的值")])]),t._v(" "),a("tr",[a("td",[t._v("mtu")]),t._v(" "),a("td",[t._v("最大数据包大小，默认不用设置")]),t._v(" "),a("td",[t._v("数值")])]),t._v(" "),a("tr",[a("td",[t._v("ipaddr")]),t._v(" "),a("td",[t._v("WAN 口的 IP 地址")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("netmask")]),t._v(" "),a("td",[t._v("WAN 口的子网掩码")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("gateway")]),t._v(" "),a("td",[t._v("默认网关")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("broadcast")]),t._v(" "),a("td",[t._v("广播地址")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("dns")]),t._v(" "),a("td",[t._v("使用指定的 DNS 服务器地址替代获得的 DNS")]),t._v(" "),a("td",[t._v("字符串")])])])]),t._v(" "),a("h4",{attrs:{id:"pppoe-拨号上网选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pppoe-拨号上网选项","aria-hidden":"true"}},[t._v("#")]),t._v(" PPPOE 拨号上网选项")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("说明")]),t._v(" "),a("th",[t._v("可选值及说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("proto")]),t._v(" "),a("td",[t._v("协议类型")]),t._v(" "),a("td",[t._v("pppoe")])]),t._v(" "),a("tr",[a("td",[t._v("ifname")]),t._v(" "),a("td",[t._v("设备名称")]),t._v(" "),a("td",[t._v("eth0.2")])]),t._v(" "),a("tr",[a("td",[t._v("macaddr")]),t._v(" "),a("td",[t._v("MAC 地址")]),t._v(" "),a("td",[t._v("根据 factory 分区自动生成的值")])]),t._v(" "),a("tr",[a("td",[t._v("mtu")]),t._v(" "),a("td",[t._v("最大数据包大小，默认不用设置")]),t._v(" "),a("td",[t._v("数值")])]),t._v(" "),a("tr",[a("td",[t._v("username")]),t._v(" "),a("td",[t._v("拨号使用的帐号")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("password")]),t._v(" "),a("td",[t._v("拨号使用的密码")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("ac")]),t._v(" "),a("td",[t._v("使用指定的访问集中器进行连接")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("service")]),t._v(" "),a("td",[t._v("连接的服务名称")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("connect")]),t._v(" "),a("td",[t._v("连接时候执行的外部脚本")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("disconnect")]),t._v(" "),a("td",[t._v("断开连接时执行的外部脚本")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("demand")]),t._v(" "),a("td",[t._v("等待多久没有活动就断开 PPPOE 连接")]),t._v(" "),a("td",[t._v("数字，单位秒")])]),t._v(" "),a("tr",[a("td",[t._v("dns")]),t._v(" "),a("td",[t._v("DNS 服务器地址")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("pppd_options")]),t._v(" "),a("td",[t._v("用于 pppd 进程执行时候的附加参数")]),t._v(" "),a("td",[t._v("字符串")])])])]),t._v(" "),a("h3",{attrs:{id:"配置-lan-口服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-lan-口服务","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置 LAN 口服务")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("LAN 口下的设备可以通过 WAN 口接入网络，也可以直接访问设备上的各项功能（系统防火墙对 LAN 口默认不做任何拦截）。")])]),t._v(" "),a("h4",{attrs:{id:"查看-lan-口配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看-lan-口配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看 LAN 口配置")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# uci show network.lan")]),t._v("\nnetwork.lan"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("interface\nnetwork.lan.force_link"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v("\nnetwork.lan.macaddr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0c:ef:af:d2:a9:b9'")]),t._v("\nnetwork.lan.type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bridge'")]),t._v("\nnetwork.lan.proto"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'static'")]),t._v("\nnetwork.lan.ipaddr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'192.168.8.1'")]),t._v("\nnetwork.lan.netmask"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'255.255.255.0'")]),t._v("\nnetwork.lan.ip6assign"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'60'")]),t._v("\nnetwork.lan.ifname"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'eth0.1'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("说明")]),t._v(" "),a("th",[t._v("可选值及说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("ifname")]),t._v(" "),a("td",[t._v("设备名称")]),t._v(" "),a("td",[t._v("eth0.1")])]),t._v(" "),a("tr",[a("td",[t._v("proto")]),t._v(" "),a("td",[t._v("协议类型")]),t._v(" "),a("td",[t._v("static")])]),t._v(" "),a("tr",[a("td",[t._v("macaddr")]),t._v(" "),a("td",[t._v("MAC 地址")]),t._v(" "),a("td",[t._v("根据 factory 分区自动生成的值")])]),t._v(" "),a("tr",[a("td",[t._v("type")]),t._v(" "),a("td",[t._v("网络类型")]),t._v(" "),a("td",[t._v("bridge，桥模式（这样才有交换机功能）")])]),t._v(" "),a("tr",[a("td",[t._v("ipaddr")]),t._v(" "),a("td",[t._v("LAN 口的 IP 地址，用于局域网内其它设备访问路由器")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("netmask")]),t._v(" "),a("td",[t._v("LAN 口的子网掩码")]),t._v(" "),a("td",[t._v("字符串")])])])]),t._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",[t._v("修改过 LAN 口的配置后要重启网络以及 DHCP 服务。")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/init.d/network restart")]),t._v("\nroot@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/odhcpd restart")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("h3",{attrs:{id:"配置无线网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置无线网络","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置无线网络")]),t._v(" "),a("h4",{attrs:{id:"查看无线网络配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看无线网络配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看无线网络配置")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat /etc/config/wireless ")]),t._v("\n\nconfig wifi-device "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'radio0'")]),t._v("\n\toption "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ralink'")]),t._v("\n\toption variant "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mt7628'")]),t._v("\n\toption country "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CN'")]),t._v("\n\toption hwmode "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'11bgn'")]),t._v("\n\toption htmode "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HT40'")]),t._v("\n\toption channel "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'auto'")]),t._v("\n\toption disabled "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),t._v("\n\nconfig wifi-iface "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ap'")]),t._v("\n\toption device "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'radio0'")]),t._v("\n\toption mode "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ap'")]),t._v("\n\toption network "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lan'")]),t._v("\n\toption ifname "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ra0'")]),t._v("\n\toption ssid "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Widora-A9B8'")]),t._v("\n\toption hidden "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),t._v("\n\toption encryption "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'psk2'")]),t._v("\n\toption key "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'passworkd'")]),t._v("\n\nconfig wifi-iface "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sta'")]),t._v("\n\toption device "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'radio0'")]),t._v("\n\toption disabled "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v("\n\toption mode "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sta'")]),t._v("\n\toption network "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wwan'")]),t._v("\n\toption ifname "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'apcli0'")]),t._v("\n\toption ssid "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UplinkAp'")]),t._v("\n\toption key "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SecretKey'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br")])]),a("h4",{attrs:{id:"wifi-device-选项参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wifi-device-选项参数","aria-hidden":"true"}},[t._v("#")]),t._v(" wifi-device 选项参数")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("说明")]),t._v(" "),a("th",[t._v("可选值及说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("type")]),t._v(" "),a("td",[t._v("设备类型")]),t._v(" "),a("td",[t._v("ralink")])]),t._v(" "),a("tr",[a("td",[t._v("channel")]),t._v(" "),a("td",[t._v("无线信道，不同的国家支持的信道不同")]),t._v(" "),a("td",[t._v("auto 或 1～13")])]),t._v(" "),a("tr",[a("td",[t._v("hwmode")]),t._v(" "),a("td",[t._v("无线协议类型")]),t._v(" "),a("td",[t._v("11bgn: IEEE802.11b + IEEE802.11g + IEEE802.11n")])]),t._v(" "),a("tr",[a("td",[t._v("htmode")]),t._v(" "),a("td",[t._v("无线频宽")]),t._v(" "),a("td",[t._v("HT20、HT40")])]),t._v(" "),a("tr",[a("td",[t._v("disable")]),t._v(" "),a("td",[t._v("关闭无线设备")]),t._v(" "),a("td",[t._v("0：启用；1：禁用")])]),t._v(" "),a("tr",[a("td",[t._v("country")]),t._v(" "),a("td",[t._v("国家类型，跟支持的频道有关，中国为 CN，支持 1～13")]),t._v(" "),a("td",[t._v("CN：中国")])])])]),t._v(" "),a("h4",{attrs:{id:"wifi-iface-选项参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wifi-iface-选项参数","aria-hidden":"true"}},[t._v("#")]),t._v(" wifi-iface 选项参数")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("说明")]),t._v(" "),a("th",[t._v("可选值及说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("device")]),t._v(" "),a("td",[t._v("关联的无线设备")]),t._v(" "),a("td",[t._v("radio0")])]),t._v(" "),a("tr",[a("td",[t._v("network")]),t._v(" "),a("td",[t._v("关联网络设备类型")]),t._v(" "),a("td",[t._v("lan：表示桥接到 LAN 网上"),a("br"),t._v("wwan：表示启用无线中继")])]),t._v(" "),a("tr",[a("td",[t._v("mode")]),t._v(" "),a("td",[t._v("无线工作模式")]),t._v(" "),a("td",[t._v("ap：热点模式"),a("br"),t._v("sta：客户端模式")])]),t._v(" "),a("tr",[a("td",[t._v("ssid")]),t._v(" "),a("td",[t._v("无线的名称")]),t._v(" "),a("td",[t._v("字符串")])]),t._v(" "),a("tr",[a("td",[t._v("hidden")]),t._v(" "),a("td",[t._v("隐藏无线名称")]),t._v(" "),a("td",[t._v("0：显示名称"),a("br"),t._v("1：隐藏名称")])]),t._v(" "),a("tr",[a("td",[t._v("encryption")]),t._v(" "),a("td",[t._v("无线加密方式")]),t._v(" "),a("td",[t._v("none：不加密"),a("br"),t._v("psk：WPA-PSK 模式"),a("br"),t._v("psk2：WPA-PSK2 模式"),a("br"),t._v("psk-mixed：WPA-PSK / WPA-PSK2 混合模式")])]),t._v(" "),a("tr",[a("td",[t._v("key")]),t._v(" "),a("td",[t._v("无线密钥")]),t._v(" "),a("td",[t._v("字符串，长度为 8～64 个 ASCII 字符")])])])]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("修改过无线配置后需要使用命令 "),a("code",[t._v("wifi")]),t._v(" 使之生效")])]),t._v(" "),a("h4",{attrs:{id:"查看无线网络状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看无线网络状态","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看无线网络状态")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# iwinfo ")]),t._v("\nra0       ESSID: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Widora-A9B8"')]),t._v("\n          Access Point: 0C:EF:AF:D2:A9:B8\n          Mode: Client  Channel: 7 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("2.442 GHz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          Tx-Power: 18 dBm  Link Quality: 10/100\n          Signal: -256 dBm  Noise: -82 dBm\n          Bit Rate: 150.0 MBit/s\n          Encryption: unknown\n          Type: wext  HW Mode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": 802.11bg\n          Hardware: unknown "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Generic WEXT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n          TX power offset: unknown\n          Frequency offset: unknown\n          Supports VAPs: no  PHY name: ra0\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("h4",{attrs:{id:"搜索范围内的其它无线设备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#搜索范围内的其它无线设备","aria-hidden":"true"}},[t._v("#")]),t._v(" 搜索范围内的其它无线设备")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# iwinfo ra0 scan")]),t._v("\nCell 01 - Address: 50:64:2B:4B:02:4E\n          ESSID: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Xiaomi_024D"')]),t._v("\n          Mode: Master  Channel: 11\n          Signal: -256 dBm  Quality: 55/100\n          Encryption: WPA2 PSK "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TKIP, AES-OCB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nCell 02 - Address: 44:97:5A:EC:C5:14\n          ESSID: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FAST_C514"')]),t._v("\n          Mode: Master  Channel: 1\n          Signal: -256 dBm  Quality: 47/100\n          Encryption: WPA2 PSK "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AES-OCB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("h2",{attrs:{id:"防火墙"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防火墙","aria-hidden":"true"}},[t._v("#")]),t._v(" 防火墙")]),t._v(" "),a("p",[t._v("防火墙、DMZ（独立隔离区）、NAT 转发在 OpenWrt 系统中都是由 /etc/config/firewall 配置文件管理的。")]),t._v(" "),a("h3",{attrs:{id:"防火墙命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防火墙命令","aria-hidden":"true"}},[t._v("#")]),t._v(" 防火墙命令")]),t._v(" "),a("h4",{attrs:{id:"重置防火墙"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重置防火墙","aria-hidden":"true"}},[t._v("#")]),t._v(" 重置防火墙")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/init.d/firewall reload")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"重启防火墙"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启防火墙","aria-hidden":"true"}},[t._v("#")]),t._v(" 重启防火墙")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/init.d/firewall restart")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h4",{attrs:{id:"查看防火墙完整策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看防火墙完整策略","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看防火墙完整策略")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# iptables -L")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"防火墙-defaults-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防火墙-defaults-配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 防火墙 defaults 配置")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("config defaults\n\toption syn_flood\t1\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启用防洪水攻击")]),t._v("\n\toption input\t\tACCEPT\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# INPUT 链过滤策略")]),t._v("\n\toption output\t\tACCEPT\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# OUTPUT 链过滤策略")]),t._v("\n\toption forward\t\tREJECT\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# FORWARD 链过滤策略")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h3",{attrs:{id:"防火墙-zone-域配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防火墙-zone-域配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 防火墙 zone 域配置")]),t._v(" "),a("p",[t._v("系统将 LAN 和 WAN 分为两个不同的 zone，它们之间是隔离的。")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("config zone\n\toption name\t\t\tlan\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zone 节点名")]),t._v("\n\tlist   network\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lan'")]),t._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定绑定到该 zone 上的设备")]),t._v("\n\toption input\t\tACCEPT\n\toption output\t\tACCEPT\n\toption forward\t\tACCEPT\n\nconfig zone\n\toption name\t\t\twan\n\tlist   network\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wan'")]),t._v("\n\tlist   network\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wan6'")]),t._v("\n\tlist   network\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wwan'")]),t._v("\n\toption input\t\tACCEPT\n\toption output\t\tACCEPT\n\toption forward\t\tREJECT\n\toption masq\t\t\t1\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 传输伪装开关，WAN 必须设为 1")]),t._v("\n\toption mtu_fix\t\t1\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据输出时开启 MSS 钳制，WAN 必须设为 1")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br")])]),a("h3",{attrs:{id:"防火墙-forwarding-转发配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防火墙-forwarding-转发配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 防火墙 forwarding 转发配置")]),t._v(" "),a("p",[t._v("forwarding 配置可以实现两个不同 zone 域之间的数据发送")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("config forwarding\n\toption src\t\tlan\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 来源 zone")]),t._v("\n\toption dest\t\twan\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 目标 zone")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h3",{attrs:{id:"防火墙-rule-规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防火墙-rule-规则","aria-hidden":"true"}},[t._v("#")]),t._v(" 防火墙 rule 规则")]),t._v(" "),a("p",[t._v("默认情况下，所有进入 WAN 口的请求都会被拒绝，如果希望有例外，那么要通过 rule 来实现许可。")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Allow IPv4 ping")]),t._v("\nconfig rule\n\toption name\t\t\tAllow-Ping\n\toption src\t\t\twan\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据源的 zone 域")]),t._v("\n\toption proto\t\ticmp\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据源的协议类型")]),t._v("\n\toption icmp_type\techo-request\n\toption family\t\tipv4\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# IP 协议类型")]),t._v("\n\toption target\t\tACCEPT\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 规则动作")]),t._v("\n\t\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 禁止 LAN 口的某个 IP 访问 WAN 口")]),t._v("\nconfig rule\n\toption src\t\tlan\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据源的 zone 域")]),t._v("\n\toption src_ip\t192.168.45.2\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据源的 IP 地址")]),t._v("\n\toption dest\t\twan\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 目的地的 zone 域")]),t._v("\n\toption proto\ttcp\t\t\t\t\t\t\n\toption target\tREJECT\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 禁止某个 MAC 地址访问 WAN")]),t._v("\nconfig rule\n\toption dest\t\twan\t\t\t\t\n\toption src_mac\t00:11:22:33:44:66\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据源的 MAC 地址")]),t._v("\n\toption target\tREJECT\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 阻塞某个 zone 上的 ICMP 流量")]),t._v("\nconfig rule\n\toption src\t\tlan\n\toption proto\tICMP\n\toption target\tDROP\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br")])]),a("h3",{attrs:{id:"防火墙-redirect-端口转发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防火墙-redirect-端口转发","aria-hidden":"true"}},[t._v("#")]),t._v(" 防火墙 redirect 端口转发")]),t._v(" "),a("p",[t._v("端口转发允许访问者通过 WAN 口访问 LAN 口中的一个特定端口，并将结果转发回给访问者。")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将 LAN 口的 80 端口开放到 WAN 口上")]),t._v("\nconfig redirect\n\toption src\t\t\twan\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 被转发来源 zone 域")]),t._v("\n\toption src_dport\t80\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 被转发的端口")]),t._v("\n\toption dest\t\t\tlan\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 转发到哪个 zone 域")]),t._v("\n\toption dest_ip\t\t192.168.16.235 \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 转发到哪个 IP 地址")]),t._v("\n\toption dest_port\t80\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 转发到哪个端口")]),t._v("\n\toption proto\t\ttcp\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 协议类型")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将所有来自 WAN 口的 TCP 协议访问 22001 的请求都转发给 LAN 中的一台 80 端口的计算机")]),t._v("\nconfig redirect\n\toption src\t\t\twan\n\toption src_dport\t22001\n\toption dest\t\t\tlan\n\toption dest_port\t22\n\toption proto\t\ttcp\n\t\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将 IP 地址 192.168.1.2 设置到 DMZ 隔离区")]),t._v("\nconfig redirect\n\toption src\t\t\twan\n\toption proto\t\tall\n\toption dest_ip\t\t192.168.1.2\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br")])]),a("h2",{attrs:{id:"ntp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ntp","aria-hidden":"true"}},[t._v("#")]),t._v(" NTP")]),t._v(" "),a("p",[t._v("NTP 用来使网络中的各个计算机时间同步的一种协议，它的用途是把系统的时钟同步到 UTC 时区，其精度在局域网内可达到 0.1ms，在互联网上绝大多数情况其精度可以达到1～50ms。")]),t._v(" "),a("p",[t._v("配置内容如下：")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat /etc/config/system ")]),t._v("\nconfig system\n\toption "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hostname")]),t._v("\tWidora\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 主机名")]),t._v("\n\toption timezone\tCST-8\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 时区")]),t._v("\n\nconfig timeserver ntp\n\tlist server\t0.openwrt.pool.ntp.org\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# NTP 服务器地址")]),t._v("\n\tlist server\t1.openwrt.pool.ntp.org\n\tlist server\t2.openwrt.pool.ntp.org\n\tlist server\t3.openwrt.pool.ntp.org\n\toption enabled 1\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启 NTP 功能")]),t._v("\n\toption enable_server 0\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("阿里云提供了 NTP 服务功能：")]),t._v(" "),a("p",[t._v("ntp1.aliyun.com")]),t._v(" "),a("p",[t._v("ntp2.aliyun.com")]),t._v(" "),a("p",[t._v("ntp3.aliyun.com")])]),t._v(" "),a("h2",{attrs:{id:"服务管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务管理","aria-hidden":"true"}},[t._v("#")]),t._v(" 服务管理")]),t._v(" "),a("h3",{attrs:{id:"查看系统服务命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看系统服务命令","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看系统服务命令")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("root@Widora:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls /etc/init.d/")]),t._v("\navahi-daemon   dbus           dropbear       led            mountd         rpcd           sysctl         system         "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("umount")]),t._v("\nboot           dnsmasq        firewall       log            network        setnetmode     sysfixtime     telnet\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cron")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("           fstab          mjpg-streamer  odhcpd         shairport      sysntpd        uhttpd\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("h3",{attrs:{id:"服务命令的语法格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务命令的语法格式","aria-hidden":"true"}},[t._v("#")]),t._v(" 服务命令的语法格式")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("服务的语法格式：/etc/init.d/服务名称 [命令]\n可用命令：\n\t\tstart\t临时开启这个服务\n\t\tstop\t临时关闭这个服务\n\t\trestart 重启当前已开启的服务，如果没有开启就开启它\n\t\treload \t重新读取该服务的配置信息（如果服务支持的话）\n\t\tenable\t设置该服务随系统一同启动\n\t\tdisable\t禁止该服务随系统一同启动\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])])])},[],!1,null,null,null);s.default=e.exports}}]);
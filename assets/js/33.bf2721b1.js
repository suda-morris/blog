(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{532:function(s,t,a){"use strict";a.r(t);var e=a(12),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"é˜²ç«å¢™-iptables-åŸºç¡€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é˜²ç«å¢™-iptables-åŸºç¡€"}},[s._v("#")]),s._v(" é˜²ç«å¢™ ğ™ğ™¥ğ™©ğ™–ğ™—ğ™¡ğ™šğ™¨ åŸºç¡€")]),s._v(" "),t("p",[t("code",[s._v("iptables")]),s._v(" æ˜¯ä¸€ç§"),t("strong",[s._v("åŒ…è¿‡æ»¤é˜²ç«å¢™")]),s._v("ï¼Œç”¨æ¥å¯¹ IPï¼ŒICMPï¼ŒTCPï¼ŒUDPï¼Œç«¯å£å·è¿›è¡Œæ§åˆ¶ã€‚")]),s._v(" "),t("p",[t("code",[s._v("iptables")]),s._v(" æ˜¯åº”ç”¨ç¨‹åºçš„æ¥å£ï¼Œå…·ä½“çš„æ•°æ®åŒ…è¿‡æ»¤éœ€è¦é…åˆå†…æ ¸æä¾›çš„ "),t("code",[s._v("netfilter")]),s._v(" æ¨¡å—ã€‚")]),s._v(" "),t("h2",{attrs:{id:"iptables-çš„è¡¨å’Œé“¾"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iptables-çš„è¡¨å’Œé“¾"}},[s._v("#")]),s._v(" iptables çš„è¡¨å’Œé“¾")]),s._v(" "),t("h3",{attrs:{id:"è§„åˆ™è¡¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è§„åˆ™è¡¨"}},[s._v("#")]),s._v(" è§„åˆ™è¡¨")]),s._v(" "),t("p",[t("code",[s._v("filter")]),s._v(" è¡¨ï¼Œ"),t("code",[s._v("nat")]),s._v(" è¡¨ï¼Œ"),t("code",[s._v("mangle")]),s._v(" è¡¨ï¼Œ"),t("code",[s._v("raw")]),s._v(" è¡¨")]),s._v(" "),t("h3",{attrs:{id:"è§„åˆ™é“¾"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è§„åˆ™é“¾"}},[s._v("#")]),s._v(" è§„åˆ™é“¾")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("INPUT")]),s._v(" "),t("code",[s._v("OUTPUT")]),s._v(" "),t("code",[s._v("FORWARD")])]),s._v(" "),t("li",[t("code",[s._v("PREROUTING")]),s._v(" "),t("code",[s._v("POSTROUTING")])])]),s._v(" "),t("h2",{attrs:{id:"iptables-è¿‡æ»¤è§„åˆ™çš„ä½¿ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iptables-è¿‡æ»¤è§„åˆ™çš„ä½¿ç”¨"}},[s._v("#")]),s._v(" iptables è¿‡æ»¤è§„åˆ™çš„ä½¿ç”¨")]),s._v(" "),t("h3",{attrs:{id:"åŸºæœ¬å‘½ä»¤ç»“æ„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŸºæœ¬å‘½ä»¤ç»“æ„"}},[s._v("#")]),s._v(" åŸºæœ¬å‘½ä»¤ç»“æ„")]),s._v(" "),t("ul",[t("li",[s._v("iptables -t filter å‘½ä»¤ è§„åˆ™é“¾ è§„åˆ™")])]),s._v(" "),t("h3",{attrs:{id:"æŸ¥çœ‹-filter-è¡¨ä¸­çš„å·²æœ‰è§„åˆ™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æŸ¥çœ‹-filter-è¡¨ä¸­çš„å·²æœ‰è§„åˆ™"}},[s._v("#")]),s._v(" æŸ¥çœ‹ filter è¡¨ä¸­çš„å·²æœ‰è§„åˆ™")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("â¤ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables -t filter -vnL                                                 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":04:32\nChain INPUT "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("policy ACCEPT "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1941")]),s._v(" packets, 11M bytes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n pkts bytes target     prot opt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("     out     "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v("               destination\n\nChain FORWARD "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("policy ACCEPT "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" packets, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" bytes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n pkts bytes target     prot opt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("     out     "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v("               destination\n\nChain OUTPUT "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("policy ACCEPT "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1728")]),s._v(" packets, 178K bytes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n pkts bytes target     prot opt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("     out     "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v("               destination\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"æ·»åŠ è§„åˆ™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ·»åŠ è§„åˆ™"}},[s._v("#")]),s._v(" æ·»åŠ è§„åˆ™")]),s._v(" "),t("ul",[t("li",[s._v("-I æ’å…¥åˆ°è§„åˆ™é“¾çš„æœ€å‰é¢")]),s._v(" "),t("li",[s._v("-A æ’å…¥åˆ°è§„åˆ™é“¾çš„æœ€åé¢")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å‘ filter è¡¨çš„ INPUT è§„åˆ™é“¾ä¸­æ·»åŠ æ–°çš„è§„åˆ™ï¼Œå…è®¸æº ip ä¸º 10.0.0.1 çš„æ•°æ®åŒ…è¿›å…¥")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables -t filter -A INPUT -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.1 -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å‘ filter è¡¨çš„ INPUT è§„åˆ™é“¾ä¸­æ·»åŠ æ–°çš„è§„åˆ™ï¼Œé˜»æ­¢æº IP ç½‘æ®µä¸º 10.0.0.0/24 çš„æ•°æ®åŒ…è¿›å…¥")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables -t filter -A INPUT -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.0/24 -j DROP\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å…è®¸ 10.0.0.2 çš„ä¸»æœºä»æœ¬æœºçš„ eth0 æ¥å£è®¿é—® 80 ç«¯å£")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables -t filter -A INPUT -i eth0 -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.2 -p tcp --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -j ACCEPT\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"ä¿®æ”¹é»˜è®¤è§„åˆ™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä¿®æ”¹é»˜è®¤è§„åˆ™"}},[s._v("#")]),s._v(" ä¿®æ”¹é»˜è®¤è§„åˆ™")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å°† filter è¡¨çš„ INPUT è§„åˆ™é“¾çš„é»˜è®¤è§„åˆ™ä¿®æ”¹ä¸º DROP")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables -t filter -P INPUT DROP\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"æ¸…é™¤è§„åˆ™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ¸…é™¤è§„åˆ™"}},[s._v("#")]),s._v(" æ¸…é™¤è§„åˆ™")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables -t filter -F\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"åˆ é™¤æŒ‡å®šçš„è§„åˆ™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ é™¤æŒ‡å®šçš„è§„åˆ™"}},[s._v("#")]),s._v(" åˆ é™¤æŒ‡å®šçš„è§„åˆ™")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ é™¤ filter è¡¨çš„ INPUT è§„åˆ™é“¾ä¸­çš„ç¬¬ 5 æ¡è§„åˆ™")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables -t filter -D "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"è‡ªå®šä¹‰è§„åˆ™é“¾"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è‡ªå®šä¹‰è§„åˆ™é“¾"}},[s._v("#")]),s._v(" è‡ªå®šä¹‰è§„åˆ™é“¾")]),s._v(" "),t("ul",[t("li",[s._v("-N æ–°å»ºè‡ªå®šä¹‰è§„åˆ™é“¾")]),s._v(" "),t("li",[s._v("-X åˆ é™¤è‡ªå®šä¹‰è§„åˆ™é“¾")]),s._v(" "),t("li",[s._v("-E é‡å‘½åè‡ªå®šä¹‰è§„åˆ™é“¾")])]),s._v(" "),t("h2",{attrs:{id:"iptables-nat-è¡¨çš„ä½¿ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iptables-nat-è¡¨çš„ä½¿ç”¨"}},[s._v("#")]),s._v(" iptables NAT è¡¨çš„ä½¿ç”¨")]),s._v(" "),t("h3",{attrs:{id:"åŸºæœ¬å‘½ä»¤ç»“æ„-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŸºæœ¬å‘½ä»¤ç»“æ„-2"}},[s._v("#")]),s._v(" åŸºæœ¬å‘½ä»¤ç»“æ„")]),s._v(" "),t("ul",[t("li",[s._v("iptables -t nat å‘½ä»¤ è§„åˆ™é“¾ è§„åˆ™\n"),t("ul",[t("li",[s._v("PREROUTING ç›®çš„åœ°å€è½¬æ¢")]),s._v(" "),t("li",[s._v("POSTROUTING æºåœ°å€è½¬æ¢")])])])]),s._v(" "),t("h3",{attrs:{id:"ç›®çš„åœ°å€è½¬æ¢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç›®çš„åœ°å€è½¬æ¢"}},[s._v("#")]),s._v(" ç›®çš„åœ°å€è½¬æ¢")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å°†åˆ° 114.115.116.117 tcp 80 ç«¯å£çš„è®¿é—®è½¬ç»™å†…ç½‘çš„ 10.0.0.1 ä¸»æœº")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables -t nat -A PREROUTING -i eth0 -d "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("114.115")]),s._v(".116.117 -p tcp --dport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -j DNAT --to-destination "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"æºåœ°å€è½¬æ¢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æºåœ°å€è½¬æ¢"}},[s._v("#")]),s._v(" æºåœ°å€è½¬æ¢")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ¥è‡ªå†…ç½‘ 10.0.0.0/24 çš„ç½‘ç»œæ•°æ®åŒ…çš„æºåœ°å€éƒ½ä¼šè¢«æ›¿æ¢æˆ eth1 æ¥å£çš„ 111.112.113.114ï¼Œç„¶åå‘å¾€å¤–ç½‘")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables -t nat -A OSTROUTING -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.0/24 -o eth1 -j SNAT --to-source "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("111.112")]),s._v(".113.114\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{299:function(s,t,a){s.exports=a.p+"assets/img/tcp_ip_stack.13913b2b.png"},300:function(s,t,a){s.exports=a.p+"assets/img/ethernet_frame.f4de10c4.png"},301:function(s,t,a){s.exports=a.p+"assets/img/netif_list.73bfcf79.png"},302:function(s,t,a){s.exports=a.p+"assets/img/setup_lwip.c67664dc.png"},303:function(s,t,a){s.exports=a.p+"assets/img/lwip_memp.1fc0c568.png"},304:function(s,t,a){s.exports=a.p+"assets/img/lwip_heap.1ac8ef3c.png"},312:function(s,t,a){"use strict";a.r(t);var n=a(24),e=Object(n.a)({},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"ð™‡ð™¬ð™„ð™‹-åŸºç¡€"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ð™‡ð™¬ð™„ð™‹-åŸºç¡€","aria-hidden":"true"}},[s._v("#")]),s._v(" ð™‡ð™¬ð™„ð™‹ åŸºç¡€")]),s._v(" "),n("p",[n("img",{attrs:{src:a(299),alt:"TCP/IPåè®®æ ˆ"}})]),s._v(" "),n("h2",{attrs:{id:"æ ‡å‡†ä»¥å¤ªç½‘æ•°æ®å¸§æ ¼å¼"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ ‡å‡†ä»¥å¤ªç½‘æ•°æ®å¸§æ ¼å¼","aria-hidden":"true"}},[s._v("#")]),s._v(" æ ‡å‡†ä»¥å¤ªç½‘æ•°æ®å¸§æ ¼å¼")]),s._v(" "),n("p",[n("img",{attrs:{src:a(300),alt:"Ethernet_Frame"}})]),s._v(" "),n("h2",{attrs:{id:"lwip-çš„ç½‘ç»œæŽ¥å£ç®¡ç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lwip-çš„ç½‘ç»œæŽ¥å£ç®¡ç†","aria-hidden":"true"}},[s._v("#")]),s._v(" LwIP çš„ç½‘ç»œæŽ¥å£ç®¡ç†")]),s._v(" "),n("p",[s._v("LwIP ä½¿ç”¨ "),n("strong",[s._v("netif")]),s._v(" ç»“æž„ä½“æ¥æè¿°ç¡¬ä»¶ç½‘ç»œæŽ¥å£ï¼Œå¹¶é€šè¿‡ "),n("code",[s._v("netif_add")]),s._v(" å‡½æ•°å°†å…¶æŒ‚è½½åˆ°å…¨å±€ "),n("strong",[s._v("netif é“¾è¡¨")]),s._v("ä¸­ã€‚")]),s._v(" "),n("p",[n("img",{attrs:{src:a(301),alt:"ç½‘å¡é“¾è¡¨"}})]),s._v(" "),n("h3",{attrs:{id:"netif-ç»“æž„ä½“"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#netif-ç»“æž„ä½“","aria-hidden":"true"}},[s._v("#")]),s._v(" netif ç»“æž„ä½“")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* struct netif ç”¨äºŽæè¿°ä¸åŒç±»åž‹çš„ç½‘å¡ï¼Œåœ¨ç½‘å¡åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šå¦‚ä¸‹æˆå‘˜ï¼š\n** hwaddr_len, hwaddr[], mtu, flags\n*/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("netif")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å¦‚æžœæ”¯æŒå¤šç½‘å¡ï¼Œåˆ™ä½¿ç”¨å•å‘é“¾è¡¨æ¥ç®¡ç†åŒä¸€è®¾å¤‡çš„å¤šä¸ªç½‘å¡ */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" !LWIP_SINGLE_NETIF")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("netif")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV4")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ç½‘ç»œå­—èŠ‚åºè¡¨ç¤ºçš„ IPv4 åœ°å€ï¼Œå­ç½‘æŽ©ç ï¼Œé»˜è®¤ç½‘å…³ */")]),s._v("\n    ip_addr_t ip_addr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    ip_addr_t netmask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    ip_addr_t gw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV4 */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ•°ç»„ä¿å­˜å¤šä¸ª IPv6 åœ°å€ */")]),s._v("\n    ip_addr_t ip6_addr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LWIP_IPV6_NUM_ADDRESSES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ¯ä¸ª IPv6 åœ°å€çš„çŠ¶æ€ï¼šä¸´æ—¶çš„è¿˜æ˜¯é¦–é€‰çš„ */")]),s._v("\n    u8_t ip6_addr_state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LWIP_IPV6_NUM_ADDRESSES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6_ADDRESS_LIFETIMES")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ¯ä¸ª IPv6 åœ°å€çš„å‰©ä½™æœ‰æ•ˆæ—¶é—´ä»¥åŠæ€»å…±æœ‰æ•ˆæ—¶é—´ï¼Œå•ä½ï¼šç§’ */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* IP6_ADDR_LIFE_STATIC è¡¨ç¤ºè¿™ä¸ªåœ°å€æ˜¯é™æ€åˆ†é…çš„ */")]),s._v("\n    u32_t ip6_addr_valid_life"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LWIP_IPV6_NUM_ADDRESSES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    u32_t ip6_addr_pref_life"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LWIP_IPV6_NUM_ADDRESSES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6_ADDRESS_LIFETIMES */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6 */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ­¤å‡½æ•°ç”±ä»¥å¤ªç½‘è®¾å¤‡é©±åŠ¨ç¨‹åºè°ƒç”¨ï¼Œå°†æ•°æ®åŒ…ä¼ é€’ç»™ TCP/IP åè®®æ ˆ */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å¯¹äºŽä»¥å¤ªç½‘è®¾å¤‡ï¼Œé€šå¸¸æ˜¯ ethernet_input() */")]),s._v("\n    netif_input_fn input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV4")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ­¤å‡½æ•°ç”± IPv4 æ¨¡å—è°ƒç”¨ï¼Œè¯¥å‡½æ•°ä¼šè§£æžå¾—åˆ°ç¡¬ä»¶åœ°å€ï¼Œç„¶åŽå‘é€æ•°æ®åŒ… */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å¯¹äºŽä»¥å¤ªç½‘è®¾å¤‡ï¼Œé€šå¸¸æ˜¯ etharp_output() */")]),s._v("\n    netif_output_fn output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV4 */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ­¤å‡½æ•°ç”± ARP æ¨¡å—è°ƒç”¨ï¼Œç”¨äºŽå®žçŽ°åœ¨æ•°æ®é“¾è·¯å±‚å‘é€æ•°æ® */")]),s._v("\n    netif_linkoutput_fn linkoutput"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ­¤å‡½æ•°ç”± IPv6 æ¨¡å—è°ƒç”¨ï¼Œè¯¥å‡½æ•°ä¼šè§£æžå¾—åˆ°ç¡¬ä»¶åœ°å€ï¼Œç„¶åŽå‘é€æ•°æ®åŒ… */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å¯¹äºŽä»¥å¤ªç½‘è®¾å¤‡ï¼Œé€šå¸¸æ˜¯ ethip6_output() */")]),s._v("\n    netif_output_ip6_fn output_ip6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6 */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_NETIF_STATUS_CALLBACK")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å½“ç½‘å¡çŠ¶æ€è®¾ç½®ä¸º up æˆ–è€… down æ—¶ï¼Œæ­¤å‡½æ•°ä¼šè¢«è°ƒç”¨ */")]),s._v("\n    netif_status_callback_fn status_callback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_NETIF_STATUS_CALLBACK */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_NETIF_LINK_CALLBACK")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å½“ç½‘å¡çš„æ•°æ®é“¾è·¯è®¾ç½®ä¸º up æˆ–è€… down æ—¶ï¼Œæ­¤å‡½æ•°ä¼šè¢«è°ƒç”¨ */")]),s._v("\n    netif_status_callback_fn link_callback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_NETIF_LINK_CALLBACK */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_NETIF_REMOVE_CALLBACK")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å½“ç½‘å¡è¢«ç§»é™¤æ—¶ï¼Œæ­¤å‡½æ•°ä¼šè¢«è°ƒç”¨ */")]),s._v("\n    netif_status_callback_fn remove_callback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_NETIF_REMOVE_CALLBACK */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ç”¨äºŽå°†ç½‘å¡çš„ç§æœ‰æ•°æ®ä¼ é€’ç»™ä¸Šå±‚ */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("ifdef")]),s._v(" netif_get_client_data")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("client_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LWIP_NETIF_CLIENT_DATA_INDEX_MAX "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" LWIP_NUM_NETIF_CLIENT_DATA"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_NETIF_HOSTNAME")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ç½‘å¡çš„ä¸»æœºåï¼Œè®¾ç½®ä¸º NULL ä¹Ÿåˆæ³• */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("hostname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_NETIF_HOSTNAME */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_CHECKSUM_CTRL_PER_NETIF")]),s._v("\n    u16_t chksum_flags"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_CHECKSUM_CTRL_PER_NETIF*/")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æœ€å¤§ä¼ è¾“å•å…ƒï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼Œå¯¹äºŽä»¥å¤ªç½‘ï¼Œä¸€èˆ¬è®¾ä¸º 1500 */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* IP å±‚ä¼šæ ¹æ®è¯¥å­—æ®µæ¥å†³å®šæ˜¯å¦éœ€è¦å¯¹æ•°æ®åŒ…è¿›è¡Œåˆ†ç‰‡å¤„ç† */")]),s._v("\n    u16_t mtu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6 && LWIP_ND6_ALLOW_RA_UPDATES")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æœ€å¤§ä¼ è¾“å•å…ƒï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼Œç”± RA æ¥æ›´æ–° */")]),s._v("\n    u16_t mtu6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6 && LWIP_ND6_ALLOW_RA_UPDATES */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ•°æ®é“¾è·¯å±‚çš„ç¡¬ä»¶åœ°å€ */")]),s._v("\n    u8_t hwaddr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NETIF_MAX_HWADDR_LEN"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ç¡¬ä»¶åœ°å€é•¿åº¦ï¼Œä»¥å¤ªç½‘æ˜¯ 6 å­—èŠ‚ */")]),s._v("\n    u8_t hwaddr_len"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ç½‘å¡çŠ¶æ€ä¿¡æ¯æ ‡å¿—ä½ï¼ŒåŒ…æ‹¬ç½‘å¡åŠŸèƒ½ä½¿èƒ½ã€å¹¿æ’­ä½¿èƒ½ã€ARP ä½¿èƒ½ç­‰ */")]),s._v("\n    u8_t flags"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ç½‘å¡çš„åå­—ï¼Œè“ç‰™è®¾å¤‡çš„ç½‘å¡åå­—å¯ä»¥ä½¿ btï¼ŒWLAN è®¾å¤‡çš„åå­—å¯ä»¥æ˜¯ wl */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å¦‚æžœç½‘å¡å…·æœ‰ç›¸åŒçš„åå­—ï¼Œéœ€è¦é€šè¿‡ num å­—æ®µæ¥è¿›ä¸€æ­¥åŒºåˆ† */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ç½‘å¡çš„æ ‡å·ï¼Œå¯ç”¨æ¥æ ‡å¿—åŒç§ç±»åž‹çš„ä¸åŒç½‘å¡ */")]),s._v("\n    u8_t num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6_AUTOCONFIG")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ˜¯å¦ä½¿èƒ½ IPv6 è‡ªåŠ¨é…ç½® */")]),s._v("\n    u8_t ip6_autoconfig_enabled"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6_AUTOCONFIG */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6_SEND_ROUTER_SOLICIT")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å‰©ä½™å¾…å‘é€çš„è·¯ç”±è¯·æ±‚æ¶ˆæ¯çš„æ•°é‡ */")]),s._v("\n    u8_t rs_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6_SEND_ROUTER_SOLICIT */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" MIB2_STATS")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* é“¾è·¯ç±»åž‹ */")]),s._v("\n    u8_t link_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* é¢„ä¼°çš„é“¾è·¯å±‚é€ŸçŽ‡ */")]),s._v("\n    u32_t link_speed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æœ€è¿‘ä¸€æ¬¡é“¾è·¯å±‚çŠ¶æ€å˜åŒ–çš„æ—¶é—´ï¼ˆå»ºç«‹æˆ–è€…æ–­å¼€é“¾æŽ¥ï¼‰*/")]),s._v("\n    u32_t ts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* è®¡æ•°å™¨ */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("stats_mib2_netif_ctrs")]),s._v(" mib2_counters"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* MIB2_STATS */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV4 && LWIP_IGMP")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å¯ä»¥è°ƒç”¨æ­¤å‡½æ•°æ¥å‘ä»¥å¤ªç½‘ MAC çš„ç»„æ’­è¿‡æ»¤è¡¨ä¸­æ·»åŠ æˆ–åˆ é™¤æ¡ç›® */")]),s._v("\n    netif_igmp_mac_filter_fn igmp_mac_filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV4 && LWIP_IGMP */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6 && LWIP_IPV6_MLD")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å¯ä»¥è°ƒç”¨æ­¤å‡½æ•°æ¥å‘ä»¥å¤ªç½‘ MAC çš„ IPv6 ç»„æ’­è¿‡æ»¤è¡¨ä¸­æ·»åŠ æˆ–åˆ é™¤æ¡ç›® */")]),s._v("\n    netif_mld_mac_filter_fn mld_mac_filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6 && LWIP_IPV6_MLD */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_NETIF_USE_HINTS")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("netif_hint")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("hints"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_NETIF_USE_HINTS */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" ENABLE_LOOPBACK")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å¾…å‘é€ç»™è‡ªå·±çš„æ•°æ®åŒ…åˆ—è¡¨ */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("pbuf")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("loop_first"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("pbuf")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("loop_last"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_LOOPBACK_MAX_PBUFS")]),s._v("\n    u16_t loop_cnt_current"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_LOOPBACK_MAX_PBUFS */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ENABLE_LOOPBACK */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br")])]),n("h3",{attrs:{id:"netif-add-å‡½æ•°"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#netif-add-å‡½æ•°","aria-hidden":"true"}},[s._v("#")]),s._v(" netif_add å‡½æ•°")]),s._v(" "),n("p",[s._v("åœ¨è°ƒç”¨ "),n("code",[s._v("netif_add")]),s._v(" å‡½æ•°ä¹‹å‰éœ€è¦åˆå§‹åŒ–ä¸»æœºçš„ IP åœ°å€ï¼Œå­ç½‘æŽ©ç ï¼Œç½‘å…³ç­‰ä¿¡æ¯ï¼š")]),s._v(" "),n("p",[n("code",[s._v("IP4_ADDR(&ipaddr,192,168,1,100)")])]),s._v(" "),n("p",[n("code",[s._v("ip_addr_set_zero_ip4(&ipaddr)")])]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @brief å‘ LwIP ä¸­æ·»åŠ æ–°çš„ç½‘å¡\n *\n * @param netifï¼šnetif ç»“æž„ä½“ï¼ˆè°ƒç”¨å‡½æ•°ä¹‹å‰éœ€è¦ä¸ºè¯¥ç»“æž„ä½“åˆ†é…å¥½å†…å­˜ï¼‰\n * @param ipaddrï¼šè¯¥ç½‘å¡çš„ IP åœ°å€\n * @param netmaskï¼šè¯¥ç½‘å¡çš„å­ç½‘æŽ©ç \n * @param gwï¼šè¯¥ç½‘å¡çš„é»˜è®¤ç½‘å…³\n * @param stateï¼š è¯¥ç½‘å¡çš„ç§æœ‰æ•°æ®ï¼ˆLwIP æ— æ³•å¾—çŸ¥è¯¥æ•°æ®çš„å…·ä½“å«ä¹‰ï¼‰\n * @param initï¼šåˆå§‹åŒ–è¯¥ç½‘å¡æ—¶çš„å›žè°ƒå‡½æ•°\n * @param inputï¼š å°†æ•°æ®åŒ…ä¼ é€’ç»™ LwIP ä¸Šå±‚åè®®çš„å›žè°ƒå‡½æ•°ã€‚å¦‚æžœæ²¡æœ‰æ“ä½œç³»ç»Ÿï¼Œå»ºè®®ä½¿ç”¨ netif_inputï¼Œå®ƒä¼šå°†æ•°æ®åŒ…ç›´æŽ¥ä¼ ç»™åè®®æ ˆï¼›å¦‚æžœæœ‰æ“ä½œç³»ç»Ÿï¼Œå»ºè®®ä½¿ç”¨ tcpip_inputï¼Œå®ƒä¼šå‘ TCPIP çº¿ç¨‹å‘é€ä¸€ä¸ªé€šçŸ¥ã€‚è¿™ä¸¤ä¸ªå‡½æ•°ä¼šæ ¹æ®ç½‘å¡çš„ NETIF_FLAG_ETHARP å’Œ NETIF_FLAG_ETHERNET æ ‡å¿—æ¥å†³å®šå°†æ•°æ®åŒ…è½¬å‘ç»™ ethernet_input å‡½æ•°è¿˜æ˜¯ ip_input å‡½æ•°ã€‚\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("netif")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("netif_add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("netif")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV4")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" ip4_addr_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("ipaddr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" ip4_addr_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("netmask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" ip4_addr_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("gw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV4 */")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" netif_init_fn init"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" netif_input_fn input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6")]),s._v("\n  s8_t i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT_CORE_LOCKED")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_SINGLE_NETIF")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif_default "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"single netif already set"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ERROR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"netif_add: invalid netif"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" netif "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ERROR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"netif_add: No init function given"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" init "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV4")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ipaddr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    ipaddr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip_2_ip4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP4_ADDR_ANY"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netmask "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    netmask "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip_2_ip4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP4_ADDR_ANY"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gw "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    gw "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip_2_ip4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP4_ADDR_ANY"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ¸…ç©ºç½‘å¡ä¹‹å‰çš„ IP åœ°å€ï¼Œå­ç½‘æŽ©ç ï¼Œé»˜è®¤ç½‘å…³ç­‰å­—æ®µçš„ä¿¡æ¯ */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip_addr_set_zero_ip4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("ip_addr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip_addr_set_zero_ip4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("netmask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip_addr_set_zero_ip4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("gw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("output "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netif_null_output_ip4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV4 */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" LWIP_IPV6_NUM_ADDRESSES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip_addr_set_zero_ip6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("ip6_addr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("ip6_addr_state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" IP6_ADDR_INVALID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6_ADDRESS_LIFETIMES")]),s._v("\n    netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("ip6_addr_valid_life"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" IP6_ADDR_LIFE_STATIC"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("ip6_addr_pref_life"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" IP6_ADDR_LIFE_STATIC"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6_ADDRESS_LIFETIMES */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("output_ip6 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netif_null_output_ip6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6 */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NETIF_SET_CHECKSUM_CTRL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" NETIF_CHECKSUM_ENABLE_ALL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("mtu "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("flags "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("ifdef")]),s._v(" netif_get_client_data")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("memset")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("client_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("client_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_NUM_NETIF_CLIENT_DATA */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6_AUTOCONFIG")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* é»˜è®¤ä¸ä¼šè‡ªåŠ¨é…ç½® IPv6 åœ°å€ */")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("ip6_autoconfig_enabled "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6_AUTOCONFIG */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("nd6_restart_netif")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6 */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_NETIF_STATUS_CALLBACK")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("status_callback "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_NETIF_STATUS_CALLBACK */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_NETIF_LINK_CALLBACK")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("link_callback "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_NETIF_LINK_CALLBACK */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IGMP")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("igmp_mac_filter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IGMP */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6 && LWIP_IPV6_MLD")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("mld_mac_filter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6 && LWIP_IPV6_MLD */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" ENABLE_LOOPBACK")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("loop_first "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("loop_last "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ENABLE_LOOPBACK */")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* è®°å½•ç½‘å¡çš„ä¿¡æ¯ */")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("state "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("num "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netif_num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("input "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NETIF_RESET_HINTS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" ENABLE_LOOPBACK && LWIP_LOOPBACK_MAX_PBUFS")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("loop_cnt_current "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ENABLE_LOOPBACK && LWIP_LOOPBACK_MAX_PBUFS */")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV4")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* è®¾ç½®ç½‘å¡çš„ IP åœ°å€ï¼Œå­ç½‘æŽ©ç ï¼Œé»˜è®¤ç½‘å…³ */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("netif_set_addr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ipaddr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" netmask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" gw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV4 */")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* è°ƒç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„ç½‘å¡åˆå§‹åŒ–å‡½æ•° */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("init")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" ERR_OK"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV6 && LWIP_ND6_ALLOW_RA_UPDATES")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Initialize the MTU for IPv6 to the one set by the netif driver.\n     This can be updated later by RA. */")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("mtu6 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("mtu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV6 && LWIP_ND6_ALLOW_RA_UPDATES */")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ä¸ºå½“å‰ç½‘å¡ç¡®å®šå”¯ä¸€çš„ num */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" !LWIP_SINGLE_NETIF")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("netif")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("netif2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" num_netifs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("num "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("num "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      num_netifs "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netif_list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" netif2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" netif2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netif2"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"netif already added"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" netif2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        num_netifs"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"too many netifs, max. supported number is 255"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" num_netifs "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif2"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("num "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("num"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("num "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("254")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    netif_num "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    netif_num "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("num "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å°†å½“å‰ç½‘å¡æ’å…¥åˆ°å…¨å±€çš„ netif_list é“¾è¡¨ä¸­ï¼Œæ’å…¥æ–¹å¼ï¼šå¤´æ’ */")]),s._v("\n  netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netif_list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  netif_list "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/* "LWIP_SINGLE_NETIF */')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mib2_netif_added")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IGMP")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* IGMP å¼€å§‹å·¥ä½œ */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("flags "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" NETIF_FLAG_IGMP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("igmp_start")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IGMP */")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NETIF_DEBUG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"netif: added interface %c%c IP"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                            netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" netif"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IPV4")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NETIF_DEBUG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" addr "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip4_addr_debug_print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NETIF_DEBUG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ipaddr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NETIF_DEBUG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" netmask "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip4_addr_debug_print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NETIF_DEBUG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" netmask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NETIF_DEBUG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" gw "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip4_addr_debug_print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NETIF_DEBUG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" gw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IPV4 */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NETIF_DEBUG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("netif_invoke_ext_callback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LWIP_NSC_NETIF_ADDED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br"),n("span",{staticClass:"line-number"},[s._v("153")]),n("br"),n("span",{staticClass:"line-number"},[s._v("154")]),n("br"),n("span",{staticClass:"line-number"},[s._v("155")]),n("br"),n("span",{staticClass:"line-number"},[s._v("156")]),n("br"),n("span",{staticClass:"line-number"},[s._v("157")]),n("br"),n("span",{staticClass:"line-number"},[s._v("158")]),n("br"),n("span",{staticClass:"line-number"},[s._v("159")]),n("br"),n("span",{staticClass:"line-number"},[s._v("160")]),n("br"),n("span",{staticClass:"line-number"},[s._v("161")]),n("br"),n("span",{staticClass:"line-number"},[s._v("162")]),n("br"),n("span",{staticClass:"line-number"},[s._v("163")]),n("br"),n("span",{staticClass:"line-number"},[s._v("164")]),n("br"),n("span",{staticClass:"line-number"},[s._v("165")]),n("br"),n("span",{staticClass:"line-number"},[s._v("166")]),n("br"),n("span",{staticClass:"line-number"},[s._v("167")]),n("br"),n("span",{staticClass:"line-number"},[s._v("168")]),n("br"),n("span",{staticClass:"line-number"},[s._v("169")]),n("br"),n("span",{staticClass:"line-number"},[s._v("170")]),n("br"),n("span",{staticClass:"line-number"},[s._v("171")]),n("br")])]),n("h3",{attrs:{id:"åˆå§‹åŒ–-lwip-çš„ä¸€èˆ¬æµç¨‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–-lwip-çš„ä¸€èˆ¬æµç¨‹","aria-hidden":"true"}},[s._v("#")]),s._v(" åˆå§‹åŒ– LwIP çš„ä¸€èˆ¬æµç¨‹")]),s._v(" "),n("p",[n("img",{attrs:{src:a(302),alt:"åˆå§‹åŒ– LwIP"}})]),s._v(" "),n("h2",{attrs:{id:"lwip-çš„å†…å­˜ç®¡ç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lwip-çš„å†…å­˜ç®¡ç†","aria-hidden":"true"}},[s._v("#")]),s._v(" LwIP çš„å†…å­˜ç®¡ç†")]),s._v(" "),n("p",[s._v("LwIP çš„å†…å­˜ç®¡ç†æœºåˆ¶å¤§è‡´ä¸Šå¯ä»¥åˆ†æˆä¸‰ç§ï¼š")]),s._v(" "),n("ol",[n("li",[s._v("C æ ‡å‡†åº“è‡ªå¸¦çš„å†…å­˜åˆ†é…ç­–ç•¥ï¼ˆå³ä½¿ç”¨ mallocã€freeç­‰å‡½æ•°ï¼Œè¿™äº›å‡½æ•°çš„"),n("strong",[s._v("æ‰§è¡Œæ—¶é—´æ˜¯ä¸ç¡®å®šçš„")]),s._v("ï¼‰")]),s._v(" "),n("li",[s._v("LwIP çš„"),n("strong",[s._v("åŠ¨æ€å†…å­˜å †")]),s._v("åˆ†é…ç­–ç•¥")]),s._v(" "),n("li",[s._v("LwIP çš„"),n("strong",[s._v("åŠ¨æ€å†…å­˜æ± ")]),s._v("åˆ†é…ç­–ç•¥")])]),s._v(" "),n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[s._v("LwIP ä½¿ç”¨åŠ¨æ€å†…å­˜æ± çš„åŽŸå› ")]),s._v(" "),n("p",[s._v("LwIP ä¸­æœ‰å¾ˆå¤šå›ºå®šçš„æ•°æ®ç»“æž„ç©ºé—´ï¼Œæ¯”å¦‚ TCP é¦–éƒ¨ï¼ŒUDP é¦–éƒ¨ï¼ŒIP é¦–éƒ¨ï¼ŒEthernet é¦–éƒ¨ç­‰ã€‚é‡‡ç”¨å†…å­˜æ± ç­–ç•¥åˆ†é…è¿™äº›å›ºå®šå¤§å°çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥å¤§å¤§æå‡æ•ˆçŽ‡ï¼Œè¿˜ä¸ä¼šäº§ç”Ÿå†…å­˜ç¢Žç‰‡ã€‚")])]),s._v(" "),n("h3",{attrs:{id:"åŠ¨æ€å†…å­˜æ± "}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åŠ¨æ€å†…å­˜æ± ","aria-hidden":"true"}},[s._v("#")]),s._v(" åŠ¨æ€å†…å­˜æ± ")]),s._v(" "),n("h4",{attrs:{id:"lwip-mempool"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lwip-mempool","aria-hidden":"true"}},[s._v("#")]),s._v(" LWIP_MEMPOOL")]),s._v(" "),n("p",[s._v("åœ¨ LwIP å†…æ ¸åˆå§‹åŒ–æ—¶ï¼Œä¼šæ ¹æ®å…·ä½“é…ç½®åœ¨å†…å­˜ä¸­åˆå§‹åŒ–ç›¸åº”çš„å†…å­˜æ± ï¼Œå¦‚å®šä¹‰äº† "),n("code",[s._v("LWIP_UDP")]),s._v("ï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œ UDP åè®®æŽ§åˆ¶å—éœ€è¦çš„å†…å­˜æ± å°±ä¼šè¢«åˆå§‹åŒ–ã€‚"),n("code",[s._v("lwip/priv/memp_std.h")]),s._v(" ä¸­ä½¿ç”¨ "),n("code",[s._v("LWIP_MEMPOOL")]),s._v(" å®å®šä¹‰äº†è®¸å¤šæ•°æ®ï¼Œä½†æ˜¯è¿™äº›æ•°æ®çš„å…·ä½“å«ä¹‰è¦å–å†³äºŽå…·ä½“çš„ "),n("code",[s._v("LWIP_MEMPOOL")]),s._v(" ã€‚")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\n * A list of internal pools used by LWIP.\n *\n * LWIP_MEMPOOL(pool_name, number_elements, element_size, pool_description)\n *     creates a pool name MEMP_pool_name. description is used in stats.c\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_RAW")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEMPOOL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("RAW_PCB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("        MEMP_NUM_RAW_PCB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("raw_pcb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RAW_PCB"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_RAW */")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_UDP")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEMPOOL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("UDP_PCB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("        MEMP_NUM_UDP_PCB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("udp_pcb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UDP_PCB"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_UDP */")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_TCP")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEMPOOL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TCP_PCB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("        MEMP_NUM_TCP_PCB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("tcp_pcb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TCP_PCB"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEMPOOL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TCP_PCB_LISTEN"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MEMP_NUM_TCP_PCB_LISTEN"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("tcp_pcb_listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TCP_PCB_LISTEN"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEMPOOL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TCP_SEG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("        MEMP_NUM_TCP_SEG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("tcp_seg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TCP_SEG"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_TCP */")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_IGMP")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEMPOOL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IGMP_GROUP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("     MEMP_NUM_IGMP_GROUP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("igmp_group")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IGMP_GROUP"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_IGMP */")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\n * A list of pools of pbuf's used by LWIP.\n *\n * LWIP_PBUF_MEMPOOL(pool_name, number_elements, pbuf_payload_size, pool_description)\n *     creates a pool name MEMP_pool_name. description is used in stats.c\n *     This allocates enough space for the pbuf struct and a payload.\n *     (Example: pbuf_payload_size=0 allocates only size for the struct)\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEMPOOL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PBUF"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("           MEMP_NUM_PBUF"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("pbuf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("           "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PBUF_REF/ROM"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_PBUF_MEMPOOL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PBUF_POOL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" PBUF_POOL_SIZE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("           PBUF_POOL_BUFSIZE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("             "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PBUF_POOL"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\n * Allow for user-defined pools; this must be explicitly set in lwipopts.h\n * since the default is to NOT look for lwippools.h\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" MEMP_USE_CUSTOM_POOLS")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lwippools.h"')])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* MEMP_USE_CUSTOM_POOLS */")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/*\n * REQUIRED CLEANUP: Clear up so we don\'t get "multiply defined" error later\n * (#undef is ignored for something that is not defined)\n */')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("undef")]),s._v(" LWIP_MEMPOOL")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("undef")]),s._v(" LWIP_MALLOC_MEMPOOL")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("undef")]),s._v(" LWIP_MALLOC_MEMPOOL_START")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("undef")]),s._v(" LWIP_MALLOC_MEMPOOL_END")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("undef")]),s._v(" LWIP_PBUF_MEMPOOL")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br")])]),n("h4",{attrs:{id:"å®šä¹‰å†…å­˜æ± ç±»åž‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å®šä¹‰å†…å­˜æ± ç±»åž‹","aria-hidden":"true"}},[s._v("#")]),s._v(" å®šä¹‰å†…å­˜æ± ç±»åž‹")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Create the list of all memory pools managed by memp. MEMP_MAX represents a NULL pool at the end */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typedef")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("enum")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" LWIP_MEMPOOL(name,num,size,desc)  MEMP_##name,")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lwip/priv/memp_std.h"')])]),s._v("\n  MEMP_MAX\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" memp_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h4",{attrs:{id:"å£°æ˜Žå†…å­˜æ± "}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å£°æ˜Žå†…å­˜æ± ","aria-hidden":"true"}},[s._v("#")]),s._v(" å£°æ˜Žå†…å­˜æ± ")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" LWIP_MEMPOOL(name,num,size,desc) LWIP_MEMPOOL_DECLARE(name,num,size,desc)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lwip/priv/memp_std.h"')])]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp_desc")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" memp_pools"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("MEMP_MAX"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" LWIP_MEMPOOL(name,num,size,desc) &memp_ ## name,")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lwip/priv/memp_std.h"')])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("æ¯ç§å†…å­˜æ± ç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªç»“æž„ä½“ï¼Œæ¯”å¦‚"),n("code",[s._v("const struct memp_desc memp_RAW_PCB")]),s._v("ï¼Œé‡Œé¢è®°å½•äº†å†…å­˜å—çš„æ•°é‡ï¼Œå¤§å°ï¼Œèµ·å§‹åœ°å€ç­‰ä¿¡æ¯ã€‚")]),s._v(" "),n("h4",{attrs:{id:"å†…å­˜æ± åˆå§‹åŒ–"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜æ± åˆå§‹åŒ–","aria-hidden":"true"}},[s._v("#")]),s._v(" å†…å­˜æ± åˆå§‹åŒ–")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Initializes lwIP built-in pools.\n * Related functions: memp_malloc, memp_free\n *\n * Carves out memp_memory into linked lists for each pool-type.\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("memp_init")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  u16_t i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* for every pool: */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ARRAYSIZE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("memp_pools"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("memp_init_pool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("memp_pools"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Initialize custom memory pool.\n * Related functions: memp_malloc_pool, memp_free_pool\n *\n * @param desc pool to initialize\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("memp_init_pool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp_desc")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("memp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("tab "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  memp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ALIGN")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("base"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* force memset on pool memory */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("memset")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("memp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("size_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("num "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEMP_SIZE "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* create a linked list of memp elements */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    memp"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("tab"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("tab "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* cast through void* to get rid of alignment warnings */")]),s._v("\n    memp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("memp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" MEMP_SIZE "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br")])]),n("p",[n("img",{attrs:{src:a(303),alt:"å†…å­˜æ± åˆå§‹åŒ–"}})]),s._v(" "),n("h4",{attrs:{id:"å†…å­˜åˆ†é…"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜åˆ†é…","aria-hidden":"true"}},[s._v("#")]),s._v(" å†…å­˜åˆ†é…")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Get an element from a specific pool.\n *\n * @param type the pool to get an element from\n *\n * @return a pointer to the allocated memory or a NULL pointer on error\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("memp_malloc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("memp_t type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("memp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ERROR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"memp_malloc: type < MEMP_MAX"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" MEMP_MAX"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  memp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("do_memp_malloc_pool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("memp_pools"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" memp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Get an element from a custom pool.\n *\n * @param desc the pool to get an element from\n *\n * @return a pointer to the allocated memory or a NULL pointer on error\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("memp_malloc_pool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp_desc")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"invalid pool desc"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" desc "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("desc "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("do_memp_malloc_pool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("do_memp_malloc_pool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp_desc")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("memp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("SYS_ARCH_PROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("old_level"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  memp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("tab"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¾—åˆ°å¯¹åº”å†…å­˜å—ä¸­çš„ç¬¬ä¸€ä¸ªç©ºé—²å†…å­˜å—")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("memp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("tab "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memp"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç§»åŠ¨tabæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²å†…å­˜å—")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"memp_malloc: memp properly aligned"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_ptr_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("memp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" MEM_ALIGNMENT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("SYS_ARCH_UNPROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("old_level"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* cast through u8_t* to get rid of alignment warnings */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("memp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" MEMP_SIZE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("SYS_ARCH_UNPROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("old_level"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEMP_DEBUG "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" LWIP_DBG_LEVEL_SERIOUS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"memp_malloc: out of memory in pool %s\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br")])]),n("h4",{attrs:{id:"å†…å­˜é‡Šæ”¾"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜é‡Šæ”¾","aria-hidden":"true"}},[s._v("#")]),s._v(" å†…å­˜é‡Šæ”¾")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("do_memp_free_pool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp_desc")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("memp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("SYS_ARCH_DECL_PROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("old_level"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"memp_free: mem properly aligned"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n              "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_ptr_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" MEM_ALIGNMENT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* cast through void* to get rid of alignment warnings */")]),s._v("\n  memp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" MEMP_SIZE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("SYS_ARCH_PROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("old_level"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  memp"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("tab"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("tab "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("SYS_ARCH_UNPROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("old_level"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Put a custom pool element back into its pool.\n *\n * @param desc the pool where to put mem\n * @param mem the memp element to free\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("memp_free_pool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("memp_desc")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"invalid pool desc"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" desc "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("desc "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("do_memp_free_pool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("desc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Put an element back into its pool.\n *\n * @param type the pool where to put mem\n * @param mem the memp element to free\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("memp_free")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("memp_t type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ERROR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"memp_free: type < MEMP_MAX"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" MEMP_MAX"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("do_memp_free_pool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("memp_pools"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br")])]),n("h3",{attrs:{id:"åŠ¨æ€å†…å­˜å †"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åŠ¨æ€å†…å­˜å †","aria-hidden":"true"}},[s._v("#")]),s._v(" åŠ¨æ€å†…å­˜å †")]),s._v(" "),n("p",[s._v("LwIP ä¸­çš„åŠ¨æ€å†…å­˜å †ç®¡ç†å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼šä¸€ç§æ˜¯ C æ ‡å‡†åº“è‡ªå¸¦çš„å†…å­˜ç®¡ç†ç­–ç•¥ï¼Œå¦ä¸€ç§æ˜¯ LwIP è‡ªèº«å®žçŽ°çš„å†…å­˜å †ç®¡ç†ç­–ç•¥ã€‚è¿™ä¸¤è€…çš„é€‰æ‹©éœ€è¦é€šè¿‡ "),n("code",[s._v("MEM_LIBC_MALLOC")]),s._v(" å®æ¥é€‰æ‹©ã€‚")]),s._v(" "),n("h4",{attrs:{id:"å†…å­˜å †çš„ç»„ç»‡ç»“æž„"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜å †çš„ç»„ç»‡ç»“æž„","aria-hidden":"true"}},[s._v("#")]),s._v(" å†…å­˜å †çš„ç»„ç»‡ç»“æž„")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * The heap is made up as a list of structs of this type.\n * This does not have to be aligned since for getting its size,\n * we only use the macro SIZEOF_STRUCT_MEM, which automatically aligns.\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("mem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** index (-> ram[next]) of the next struct */")]),s._v("\n  mem_size_t next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** index (-> ram[prev]) of the previous struct */")]),s._v("\n  mem_size_t prev"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** 1: this area is used; 0: this area is unused */")]),s._v("\n  u8_t used"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" MEM_OVERFLOW_CHECK")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** this keeps track of the user allocation size for guard checks */")]),s._v("\n  mem_size_t user_size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** All allocated blocks will be MIN_SIZE bytes big, at least!\n * MIN_SIZE can be overridden to suit your needs. Smaller values save space,\n * larger values could prevent too small blocks to fragment the RAM too much. */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("ifndef")]),s._v(" MIN_SIZE")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" MIN_SIZE             12")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* MIN_SIZE */")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** the heap. we need one struct mem at the end and some room for alignment */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DECLARE_MEMORY_ALIGNED")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ram_heap"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MEM_SIZE_ALIGNED "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2U")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" SIZEOF_STRUCT_MEM"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" LWIP_RAM_HEAP_POINTER ram_heap")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** pointer to the heap (ram_heap): for alignment, ram is now a pointer instead of an array */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("ram"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** the last entry, always unused! */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("mem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("ram_end"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** pointer to the lowest free block, this is used for faster search */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("mem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" LWIP_MEM_LFREE_VOLATILE lfree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br")])]),n("h4",{attrs:{id:"å†…å­˜å †åˆå§‹åŒ–"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜å †åˆå§‹åŒ–","aria-hidden":"true"}},[s._v("#")]),s._v(" å†…å­˜å †åˆå§‹åŒ–")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Zero the heap and initialize start, end and lowest-free\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mem_init")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("mem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sanity check alignment"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n              "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SIZEOF_STRUCT_MEM "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEM_ALIGNMENT "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* align the heap */")]),s._v("\n  ram "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ALIGN")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("LWIP_RAM_HEAP_POINTER"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* initialize the start of the heap */")]),s._v("\n  mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("mem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("ram"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MEM_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("prev "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("used "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* initialize the end of the heap */")]),s._v("\n  ram_end "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ptr_to_mem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEM_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  ram_end"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("used "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  ram_end"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MEM_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  ram_end"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("prev "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MEM_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_SANITY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* initialize the lowest-free pointer to the start of the heap */")]),s._v("\n  lfree "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("mem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("ram"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_STATS_AVAIL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("avail"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MEM_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sys_mutex_new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("mem_mutex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" ERR_OK"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failed to create mem_mutex"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("p",[n("img",{attrs:{src:a(304),alt:"å†…å­˜å †åˆå§‹åŒ–"}})]),s._v(" "),n("h4",{attrs:{id:"å†…å­˜åˆ†é…-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜åˆ†é…-2","aria-hidden":"true"}},[s._v("#")]),s._v(" å†…å­˜åˆ†é…")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Allocate a block of memory with a minimum of 'size' bytes.\n *\n * @param size_in is the minimum size of the requested block in bytes.\n * @return pointer to allocated memory or NULL if no free memory was found.\n *\n * Note that the returned value will always be aligned (as defined by MEM_ALIGNMENT).\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mem_malloc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_size_t size_in"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  mem_size_t ptr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ptr2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("mem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("mem2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ALLOC_DECL_PROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("size_in "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å°†ç”¨æˆ·ç”³è¯·çš„å†…å­˜å¤§å°è¿›è¡Œå¯¹é½æ“ä½œ */")]),s._v("\n  size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_size_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ALIGN_SIZE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("size_in"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" MIN_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* every data block must be at least MIN_SIZE_ALIGNED long */")]),s._v("\n    size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MIN_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" MEM_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" size_in"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* äº’æ–¥è®¿é—® */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sys_mutex_lock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("mem_mutex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ALLOC_PROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* éåŽ†ç©ºé—²å†…å­˜å—é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªåˆé€‚çš„å†…å­˜å— */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ptr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mem_to_ptr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lfree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" ptr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" MEM_SIZE_ALIGNED "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n         ptr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ptr_to_mem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ptr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ptr_to_mem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ptr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("used"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ptr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" SIZEOF_STRUCT_MEM"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å†…å­˜å—å¯èƒ½å¾ˆå¤§ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦åˆ‡å¼€ */")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ptr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" SIZEOF_STRUCT_MEM"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" SIZEOF_STRUCT_MEM "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" MIN_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          ptr2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_size_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ptr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" SIZEOF_STRUCT_MEM "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"invalid next ptr"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("ptr2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" MEM_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* create mem2 struct */")]),s._v("\n          mem2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ptr_to_mem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ptr2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          mem2"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("used "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          mem2"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          mem2"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("prev "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ptr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* and insert it between mem and mem->next */")]),s._v("\n          mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ptr2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("used "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem2"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" MEM_SIZE_ALIGNED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ptr_to_mem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem2"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("prev "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ptr2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_STATS_INC_USED")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("used"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" SIZEOF_STRUCT_MEM"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("used "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_STATS_INC_USED")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("used"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mem_to_ptr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" lfree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("mem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("cur "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" lfree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Find next free block after mem and update lowest free pointer */")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cur"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("used "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" cur "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" ram_end"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            cur "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ptr_to_mem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cur"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          lfree "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cur"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_malloc: !lfree->used"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lfree "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" ram_end"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("lfree"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("used"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ALLOC_UNPROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sys_mutex_unlock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("mem_mutex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_malloc: allocated memory not above ram_end."')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_ptr_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" SIZEOF_STRUCT_MEM "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_ptr_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("ram_end"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_malloc: allocated memory properly aligned."')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_ptr_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" SIZEOF_STRUCT_MEM"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" MEM_ALIGNMENT "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_ASSERT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_malloc: sanity check alignment"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_ptr_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEM_ALIGNMENT "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_SANITY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" SIZEOF_STRUCT_MEM "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" MEM_SANITY_OFFSET"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_STATS_INC")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ALLOC_UNPROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sys_mutex_unlock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("mem_mutex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEM_DEBUG "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" LWIP_DBG_LEVEL_SERIOUS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_malloc: could not allocate %"')]),s._v("S16_F"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" bytes\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s16_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br")])]),n("h4",{attrs:{id:"å†…å­˜é‡Šæ”¾-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜é‡Šæ”¾-2","aria-hidden":"true"}},[s._v("#")]),s._v(" å†…å­˜é‡Šæ”¾")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Put a struct mem back on the heap\n *\n * @param rmem is the data portion of a struct mem as returned by a previous\n *             call to mem_malloc()\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mem_free")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("rmem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("mem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_FREE_DECL_PROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rmem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEM_DEBUG "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" LWIP_DBG_TRACE "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" LWIP_DBG_LEVEL_SERIOUS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_free(p == NULL) was called.\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_ptr_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("rmem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEM_ALIGNMENT "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ILLEGAL_FREE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_free: sanity check alignment"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEM_DEBUG "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" LWIP_DBG_LEVEL_SEVERE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_free: sanity check alignment\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* protect mem stats from concurrent access */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_STATS_INC_LOCKED")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("illegal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Get the corresponding struct mem: */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* cast through void* to get rid of alignment warnings */")]),s._v("\n  mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("mem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("rmem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SIZEOF_STRUCT_MEM "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" MEM_SANITY_OFFSET"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" ram "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("rmem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" MIN_SIZE_ALIGNED "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("ram_end"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ILLEGAL_FREE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_free: illegal memory"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEM_DEBUG "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" LWIP_DBG_LEVEL_SEVERE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_free: illegal memory\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* protect mem stats from concurrent access */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_STATS_INC_LOCKED")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("illegal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* protect the heap from concurrent access */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_FREE_PROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* mem has to be in a used state */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("used"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ILLEGAL_FREE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_free: illegal memory: double free"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_FREE_UNPROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEM_DEBUG "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" LWIP_DBG_LEVEL_SEVERE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_free: illegal memory: double free?\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* protect mem stats from concurrent access */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_STATS_INC_LOCKED")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("illegal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* æ£€æŸ¥å†…å­˜å—åœ¨é“¾è¡¨ä¸­çš„è¿žæŽ¥æ˜¯å¦æ­£å¸¸ */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mem_link_valid")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_ILLEGAL_FREE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_free: illegal memory: non-linked: double free"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_FREE_UNPROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_DEBUGF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MEM_DEBUG "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" LWIP_DBG_LEVEL_SEVERE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mem_free: illegal memory: non-linked: double free?\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* protect mem stats from concurrent access */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_STATS_INC_LOCKED")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("illegal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* mem is now unused. */")]),s._v("\n  mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("used "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" lfree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* the newly freed struct is now the lowest */")]),s._v("\n    lfree "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_STATS_DEC_USED")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("used"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mem"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("next "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem_size_t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u8_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("mem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" ram"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* å°è¯•è¿›è¡Œå†…å­˜å—åˆå¹¶ï¼ˆåªè¦æ–°é‡Šæ”¾çš„å†…å­˜å—ä¸Žä¸Šä¸€ä¸ªæˆ–è€…ä¸‹ä¸€ä¸ªç©ºé—²å†…å­˜å—åœ¨åœ°å€ä¸Šæ˜¯è¿žç»­çš„ï¼Œåˆ™è¿›è¡Œåˆå¹¶ */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("plug_holes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("MEM_SANITY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("LWIP_MEM_FREE_UNPROTECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br")])]),n("h3",{attrs:{id:"lwip-ä¸­å…³äºŽå†…å­˜ç®¡ç†çš„é…ç½®"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lwip-ä¸­å…³äºŽå†…å­˜ç®¡ç†çš„é…ç½®","aria-hidden":"true"}},[s._v("#")]),s._v(" LwIP ä¸­å…³äºŽå†…å­˜ç®¡ç†çš„é…ç½®")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("å®é…ç½®")]),s._v(" "),n("th",[s._v("è¯´æ˜Ž")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("MEM_LIBC_MALLOC")]),s._v(" "),n("td",[s._v("è®¾ç½®ä¸º 1 è¡¨ç¤ºä½¿ç”¨ C æ ‡å‡†åº“è‡ªå¸¦çš„åˆ†é…ç­–ç•¥ï¼›è®¾ç½®ä¸º 0 è¡¨ç¤ºä½¿ç”¨ LwIP è‡ªå·±å®žçŽ°çš„åŠ¨æ€å†…å­˜ç®¡ç†ç­–ç•¥ã€‚LwIP çš„åŠ¨æ€å†…å­˜ç®¡ç†ç­–ç•¥åˆåˆ†ä¸ºä¸¤ç§å®žçŽ°å½¢å¼ï¼šä¸€ç§é€šè¿‡å†…å­˜å †ï¼ˆHEAPï¼‰ç®¡ç†ç­–ç•¥å®žçŽ°å†…å­˜ç®¡ç†ï¼ˆå¤§æ•°ç»„ï¼‰ï¼Œå¦ä¸€ç§é€šè¿‡å†…å­˜æ± ï¼ˆPOOLï¼‰ç®¡ç†ç­–ç•¥å®žçŽ°å†…å­˜ç®¡ç†ï¼ˆäº‹å…ˆå¼€è¾Ÿå¥½çš„å†…å­˜æ± ï¼‰")])]),s._v(" "),n("tr",[n("td",[s._v("MEMP_MEM_MALLOC")]),s._v(" "),n("td",[s._v("æ˜¯å¦ä½¿ç”¨ LwIP å†…å­˜å †åˆ†é…ç­–ç•¥å®žçŽ°å†…å­˜æ± åˆ†é…ï¼ˆä»Žå†…å­˜æ± ä¸­èŽ·å–å†…å­˜æ—¶ï¼Œå®žé™…æ˜¯ä»Žå†…å­˜å †ä¸­åˆ†é…ï¼‰")])]),s._v(" "),n("tr",[n("td",[s._v("MEM_USE_POOLS")]),s._v(" "),n("td",[s._v("æ˜¯å¦ä½¿ç”¨ LwIP å†…å­˜æ± åˆ†é…ç­–ç•¥å®žçŽ°å†…å­˜å †çš„åˆ†é…ï¼ˆä»Žå†…å­˜å †ä¸­èŽ·å–å†…å­˜æ—¶ï¼Œå®žé™…æ˜¯ä»Žå†…å­˜æ± ä¸­åˆ†é…ï¼‰")])])])]),s._v(" "),n("h2",{attrs:{id:"ç½‘ç»œæ•°æ®åŒ…"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç½‘ç»œæ•°æ®åŒ…","aria-hidden":"true"}},[s._v("#")]),s._v(" ç½‘ç»œæ•°æ®åŒ…")]),s._v(" "),n("div",{staticClass:"tip custom-block"},[n("p",[s._v("LwIP æžåŠ›é¿å…åœ¨å±‚ä¸Žå±‚ä¹‹é—´è¿›è¡Œæ•°æ®æ‹·è´ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰é‡‡å–å¾ˆæ˜Žç¡®çš„åˆ†å±‚ç»“æž„ï¼Œå„å±‚ä¹‹é—´çš„éƒ¨åˆ†æ•°æ®åœ¨å…¶å®ƒå±‚æ˜¯å¯è§çš„ï¼Œå„å±‚ä¹‹é—´å­˜åœ¨äº¤å‰å­˜å–æ•°æ®çš„çŽ°è±¡ã€‚")])]),s._v(" "),n("h3",{attrs:{id:"pbuf-ç»“æž„ä½“"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pbuf-ç»“æž„ä½“","aria-hidden":"true"}},[s._v("#")]),s._v(" pbuf ç»“æž„ä½“")]),s._v(" "),n("p",[n("strong",[s._v("pbuf")]),s._v(" æ˜¯ä¸€ä¸ªæè¿°åè®®æ ˆä¸­æ•°æ®åŒ…çš„æ•°æ®ç»“æž„ã€‚")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Main packet buffer struct */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("pbuf")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** ç½‘ç»œä¸­çš„æ•°æ®åŒ…å¯èƒ½å¾ˆå¤§ï¼Œæ‰€ä»¥é‡‡ç”¨é“¾è¡¨çš„å½¢å¼å°†æ‰€æœ‰ pbuf åŒ…è¿žæŽ¥èµ·æ¥ï¼Œæž„æˆä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ… */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("pbuf")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** æŒ‡å‘å®žé™…æ•°æ®åŒºåŸŸ */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("payload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** å½“å‰ pbuf åŠå…¶åŽç»­ pbuf æ‰€æœ‰æ•°æ®çš„é•¿åº¦\n   *  å¦‚æžœå½“å‰æ˜¯é“¾è¡¨ä¸Šçš„ç¬¬ä¸€ä¸ªpbufï¼Œåˆ™è®°å½•ç€æ•´ä¸ª pbuf é“¾è¡¨ä¸­æ‰€æœ‰çš„pbufä¸­çš„æ•°æ®é•¿åº¦\n   */")]),s._v("\n  u16_t tot_len"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** å½“å‰pbufä¸­æœ‰æ•ˆçš„æ•°æ®é•¿åº¦ */")]),s._v("\n  u16_t len"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** a bit field indicating pbuf type and allocation sources\n      (see PBUF_TYPE_FLAG_*, PBUF_ALLOC_FLAG_* and PBUF_TYPE_ALLOC_SRC_MASK)\n    */")]),s._v("\n  u8_t type_internal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** misc flags */")]),s._v("\n  u8_t flags"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n   * å½“å‰ pbuf çš„å¼•ç”¨è®¡æ•°ï¼Œåˆå§‹åŒ–ä¸€ä¸ª pbuf çš„æ—¶å€™ï¼Œä¼šå°†å…¶è®¾ç½®ä¸º1ï¼›å½“æœ‰å…¶å®ƒæŒ‡é’ˆæŒ‡å‘å½“å‰pbufçš„æ—¶å€™ä¼šåŠ 1\n   */")]),s._v("\n  LWIP_PBUF_REF_T ref"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** For incoming packets, this contains the input netif's index */")]),s._v("\n  u8_t if_idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** In case the user needs to store data custom data on a pbuf */")]),s._v("\n  LWIP_PBUF_CUSTOM_DATA\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h3",{attrs:{id:"pbuf-çš„ç±»åž‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pbuf-çš„ç±»åž‹","aria-hidden":"true"}},[s._v("#")]),s._v(" pbuf çš„ç±»åž‹")]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @ingroup pbuf\n * Enumeration of pbuf types\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typedef")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("enum")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** pbuf data is stored in RAM, used for TX mostly, struct pbuf and its payload\n      are allocated in one piece of contiguous memory (so the first payload byte\n      can be calculated from struct pbuf).\n      pbuf_alloc() allocates PBUF_RAM pbufs as unchained pbufs (although that might\n      change in future versions).\n      This should be used for all OUTGOING packets (TX).*/")]),s._v("\n  PBUF_RAM "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PBUF_ALLOC_FLAG_DATA_CONTIGUOUS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" PBUF_TYPE_FLAG_STRUCT_DATA_CONTIGUOUS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" PBUF_TYPE_ALLOC_SRC_MASK_STD_HEAP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** pbuf data is stored in ROM, i.e. struct pbuf and its payload are located in\n      totally different memory areas. Since it points to ROM, payload does not\n      have to be copied when queued for transmission. */")]),s._v("\n  PBUF_ROM "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PBUF_TYPE_ALLOC_SRC_MASK_STD_MEMP_PBUF"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** pbuf comes from the pbuf pool. Much like PBUF_ROM but payload might change\n      so it has to be duplicated when queued before transmitting, depending on\n      who has a 'ref' to it. */")]),s._v("\n  PBUF_REF "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PBUF_TYPE_FLAG_DATA_VOLATILE "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" PBUF_TYPE_ALLOC_SRC_MASK_STD_MEMP_PBUF"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** pbuf payload refers to RAM. This one comes from a pool and should be used\n      for RX. Payload can be chained (scatter-gather RX) but like PBUF_RAM, struct\n      pbuf and its payload are allocated in one piece of contiguous memory (so\n      the first payload byte can be calculated from struct pbuf).\n      Don't use this for TX, if the pool becomes empty e.g. because of TCP queuing,\n      you are unable to receive TCP acks! */")]),s._v("\n  PBUF_POOL "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PBUF_ALLOC_FLAG_RX "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" PBUF_TYPE_FLAG_STRUCT_DATA_CONTIGUOUS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" PBUF_TYPE_ALLOC_SRC_MASK_STD_MEMP_PBUF_POOL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" pbuf_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("ul",[n("li",[s._v("PBUF_RAMç±»åž‹çš„pbufæ˜¯é€šè¿‡å†…å­˜å †åˆ†é…å¾—åˆ°çš„ï¼ŒLwIPåè®®æ ˆå’Œåº”ç”¨ç¨‹åºè¦ä¼ é€’çš„æ•°æ®ä¸€èˆ¬éƒ½ä½¿ç”¨è¯¥ç±»åž‹çš„pbufã€‚")]),s._v(" "),n("li",[s._v("PBUF_POOLç±»åž‹çš„pbufæ˜¯é€šè¿‡å†…å­˜æ± åˆ†é…å¾—åˆ°çš„ï¼Œç”±äºŽåˆ†é…æ­¤ç±»åž‹çš„pbufå¯ä»¥å¿«é€Ÿå®Œæˆï¼Œé€‚åˆä¸­æ–­å¤„ç†ï¼Œå› æ­¤å®ƒæ›´å¤šåœ°åº”ç”¨åœ¨ç½‘ç»œè®¾å¤‡é©±åŠ¨å±‚ã€‚")]),s._v(" "),n("li",[s._v("PBUF_REFå’ŒPBUF_ROMç±»åž‹çš„pbufåŸºæœ¬ç›¸åŒï¼Œä»–ä»¬éƒ½æ˜¯ä»Žå†…å­˜æ± ä¸­ç”³è¯·åˆ†é…pbufç»“æž„é¦–éƒ¨ç©ºé—´ï¼Œè€Œä¸ç”³è¯·æ•°æ®åŒºçš„ç©ºé—´ã€‚ä¸¤è€…çš„åŒºåˆ«åœ¨äºŽï¼Œå‰è€…æŒ‡å‘RAMç©ºé—´å†…çš„æŸæ®µæ•°æ®ï¼ŒåŽè€…æŒ‡å‘ROMç©ºé—´å†…çš„æŸæ®µæ•°æ®ã€‚")])]),s._v(" "),n("h3",{attrs:{id:"pbuf-ç›¸å…³-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pbuf-ç›¸å…³-api","aria-hidden":"true"}},[s._v("#")]),s._v(" pbuf ç›¸å…³ API")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("API")]),s._v(" "),n("th",[s._v("è¯´æ˜Ž")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("pbuf_alloc")]),s._v(" "),n("td",[s._v("åˆ†é…æ–°çš„ pbuf")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_realloc")]),s._v(" "),n("td",[s._v("æ”¹å˜ pbuf å¤§å°ï¼ˆåªèƒ½ç¼©å°ï¼‰")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_ref")]),s._v(" "),n("td",[s._v("å¢žåŠ  pbuf çš„å¼•ç”¨è®¡æ•°")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_free")]),s._v(" "),n("td",[s._v("é‡Šæ”¾ pbuf")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_clen")]),s._v(" "),n("td",[s._v("è¿”å›ž pbuf é“¾ä¸­çš„ pbuf æ•°é‡")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_cat")]),s._v(" "),n("td",[s._v("å°†ä¸¤ä¸ª pbuf é“¾æŽ¥åœ¨ä¸€èµ·ï¼ˆä½†ä¸ä¼šæ”¹å˜æœ«å°¾ pbuf é“¾çš„å¼•ç”¨è®¡æ•°ï¼‰")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_chain")]),s._v(" "),n("td",[s._v("å°†ä¸¤ä¸ª pbuf é“¾æŽ¥åœ¨ä¸€èµ·ï¼ˆå¢žå‡å°¾é“¾çš„å¼•ç”¨è®¡æ•°ï¼‰")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_dechain")]),s._v(" "),n("td",[s._v("ç¼‰æ‹¿ä¸ªç¬¬ä¸€ä¸ª pbuf ä¸Žé“¾ä¸­åŽç»­çš„ pbuf æ–­å¼€è¿žæŽ¥")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_header")]),s._v(" "),n("td",[s._v("è°ƒæ•´è½½è·æŒ‡é’ˆï¼Œéšè—æˆ–æ˜¾ç¤ºè½½è·ä¸­çš„å¤´æ•°æ®")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_copy_partial")]),s._v(" "),n("td",[s._v("å°†éƒ¨åˆ† pbuf ä¸­çš„å†…å®¹å¤åˆ¶åˆ°ç¼“å­˜ä¸­")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_take")]),s._v(" "),n("td",[s._v("å°†ç”¨æˆ·æ•°æ®å¤åˆ¶åˆ° pbuf ä¸­")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_coalesce")]),s._v(" "),n("td",[s._v("ä»Žä¸€ä¸ª pbuf é˜Ÿåˆ—ä¸­åˆ›å»ºå•ä¸ª pbuf")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_memcmp")]),s._v(" "),n("td",[s._v("å°†æŒ‡å®šåç§»åœ°å€å¤„çš„ pbuf å†…å®¹ä¸Žå…¶å®ƒå†…å­˜æ¯”è¾ƒ")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_memfind")]),s._v(" "),n("td",[s._v("ä»ŽæŸä¸ªåç§»åœ°å€å¼€å§‹ï¼Œåœ¨ pbuf ä¸­æŸ¥æ‰¾æŸå†…å­˜")])]),s._v(" "),n("tr",[n("td",[s._v("pbuf_strstr")]),s._v(" "),n("td",[s._v("ä»ŽæŸä¸ªåç§»åœ°å€å¼€å§‹ï¼Œåœ¨ pbuf ä¸­æŸ¥æ‰¾æŸå­—ç¬¦ä¸²")])])])]),s._v(" "),n("div",{staticClass:"warning custom-block"},[n("p",{staticClass:"custom-block-title"},[s._v("HTTP åè®®åœ¨ç‰©è”ç½‘ç³»ç»Ÿä¸­çš„åŠ£åŠ¿")]),s._v(" "),n("ol",[n("li",[s._v("HTTP æ˜¯ä¸€ç§åŒæ­¥åè®®ï¼Œå®¢æˆ·ç«¯éœ€è¦ç­‰å¾…æœåŠ¡å™¨çš„å“åº”æ‰å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥å·¥ä½œï¼ˆåœ¨å®¢æˆ·ç«¯æ•°é‡å¤šã€ç½‘ç»œä¸å¯é çš„åœºæ™¯ä¸‹ï¼Œå®žçŽ°åŒæ­¥é€šä¿¡å¾ˆå›°éš¾ï¼‰")]),s._v(" "),n("li",[s._v("HTTP æ˜¯å•å‘çš„ï¼Œå®¢æˆ·ç«¯åªèƒ½ä¸»åŠ¨å‘æœåŠ¡å™¨å‘å‡ºæ•°æ®ï¼Œæ— æ³•è¢«åŠ¨æŽ¥æ”¶æ¥è‡ªç½‘ç»œçš„æ•°æ®ï¼ˆä¸é€‚ç”¨äºŽå®žæ—¶æŽ§åˆ¶çš„åœºåˆï¼‰")]),s._v(" "),n("li",[s._v("HTTP æœ‰è®¸å¤šå¸§å¤´å’Œè§„åˆ™ï¼Œæ˜¯ä¸€ç§é‡é‡çº§çš„åè®®ï¼ˆå®žçŽ°åœ¨ç‰©è”ç½‘è®¾å¤‡ä¸­éœ€è¦è€—è´¹å¤§é‡çš„ç³»ç»Ÿèµ„æºï¼‰")])])]),s._v(" "),n("h2",{attrs:{id:"lwipæž¶æž„"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lwipæž¶æž„","aria-hidden":"true"}},[s._v("#")]),s._v(" LwIPæž¶æž„")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/09/PyrZkR.png",alt:"LwIPæž¶æž„"}})]),s._v(" "),n("h2",{attrs:{id:"lwip-çš„çº¿ç¨‹æ¨¡åž‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lwip-çš„çº¿ç¨‹æ¨¡åž‹","aria-hidden":"true"}},[s._v("#")]),s._v(" LwIP çš„çº¿ç¨‹æ¨¡åž‹")]),s._v(" "),n("ul",[n("li",[s._v("æ ‡å‡† TCP/IP åè®®æ ˆçš„å„ä¸ªå±‚æ¬¡éƒ½ç‹¬ç«‹æˆä¸ºä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå„ä¸ªå±‚æ¬¡æœ‰ç€ä¸¥æ ¼çš„åˆ†å±‚ç»“æž„ï¼Œå„ä¸ªå±‚æ¬¡çš„ API æŽ¥å£ä¹Ÿæ˜¯åˆ†å±‚æ¸…æ™°çš„ã€‚ä½†æ˜¯æ•°æ®åŒ…åœ¨å‘å…¶å®ƒå±‚é€’äº¤çš„æ—¶å€™ï¼Œéƒ½éœ€è¦è¿›è¡Œæ‹·è´ä»¥åŠåˆ‡æ¢çº¿ç¨‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å¼€é”€ï¼Œä¼šå¯¼è‡´ç³»ç»Ÿæ²¡æ³•å¤„ç†å¤§é‡çš„æ•°æ®ã€‚")]),s._v(" "),n("li",[s._v("åè®®æ ˆå¯ä»¥é©»ç•™åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡ç³»ç»Ÿè°ƒç”¨ä¸Ž TCP/IP åè®®æ ˆé€šä¿¡ã€‚è¿™ç§æƒ…å†µè®©åè®®æ ˆå„å±‚ä¹‹é—´ä¸Žç”¨æˆ·çº¿ç¨‹æ²¡æœ‰å¾ˆä¸¥æ ¼çš„åˆ†å±‚ç»“æž„ï¼Œå„å±‚ä¹‹é—´èƒ½äº¤å‰å­˜å–ï¼Œä»Žè€Œæé«˜æ•ˆçŽ‡ã€‚")]),s._v(" "),n("li",[s._v("LwIP è®©åè®®æ ˆå†…æ ¸ä¸Žæ“ä½œç³»ç»Ÿç›¸äº’éš”ç¦»ï¼Œåè®®æ ˆä»…ä»…ä½œä¸ºæ“ä½œç³»ç»Ÿçš„ä¸€ä¸ªç‹¬ç«‹çº¿ç¨‹å­˜åœ¨ï¼Œç”¨æˆ·ç¨‹åºèƒ½é©»ç•™åœ¨åè®®æ ˆå†…éƒ¨ï¼Œåè®®æ ˆé€šè¿‡å›žè°ƒå‡½æ•°å®žçŽ°ç”¨æˆ·ä¸Žåè®®æ ˆä¹‹é—´çš„æ•°æ®äº¤äº’ï¼›ä¹Ÿå¯ä»¥è®©ç”¨æˆ·ç¨‹åºå•ç‹¬å®žçŽ°ä¸€ä¸ªçº¿ç¨‹ï¼Œé€šè¿‡ä¿¡å·é‡å’Œé‚®ç®±ç­‰æœºåˆ¶ä¸Žåè®®æ ˆçº¿ç¨‹é€šä¿¡ã€‚")])]),s._v(" "),n("h2",{attrs:{id:"arpå¤„ç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#arpå¤„ç†","aria-hidden":"true"}},[s._v("#")]),s._v(" ARPå¤„ç†")]),s._v(" "),n("blockquote",[n("p",[s._v("ARPåè®®æ˜¯TCP/IPåè®®çš„åŸºç¡€ï¼Œæœ¬è´¨æ˜¯å®žçŽ°IPåœ°å€ä¸Žåº•å±‚ç‰©ç†åœ°å€çš„ç›¸äº’è½¬æ¢ã€‚ARPåè®®çš„æ ¸å¿ƒæ˜¯ARPç¼“å­˜è¡¨ï¼Œè€ŒARPåè®®çš„å®žè´¨å°±æ˜¯å¯¹ç¼“å­˜è¡¨çš„å»ºç«‹ã€æ›´æ–°ã€æŸ¥è¯¢ç­‰æ“ä½œã€‚ARPç¼“å­˜è¡¨æ˜¯ç”±è‹¥å¹²ç¼“å­˜è¡¨é¡¹ç»„æˆï¼Œåœ¨LwIPä¸­ï¼Œæè¿°ç¼“å­˜è¡¨é¡¹çš„æ•°æ®ç»“æž„å«etharp_entryã€‚")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/02/P0CQUA.png",alt:"ARPåè®®æ•°æ®åŒ…æ ¼å¼"}})]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("etharp_entry")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" ARP_QUEUEING")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Pointer to queue of pending outgoing packets on this ARP entry. */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("etharp_q_entry")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("q"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("else")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ARP_QUEUEING */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Pointer to a single pending outgoing packet on this ARP entry. */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("pbuf")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("q"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* ARP_QUEUEING */")]),s._v("\n  ip4_addr_t ipaddr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("netif")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("netif"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("eth_addr")]),s._v(" ethaddr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  u16_t ctime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  u8_t state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("ul",[n("li",[s._v("ipaddrå­˜æ”¾IPåœ°å€ï¼Œethaddrå­˜æ”¾ç‰©ç†åœ°å€ï¼Œstateè¡¨ç¤ºç¼“å­˜é¡¹çš„çŠ¶æ€ï¼ˆä¾‹å¦‚æ˜¯å¦ä¸ºç©ºï¼Œæ˜¯å¦ç¨³å®šï¼‰ï¼Œctimeè®°å½•ARPç¼“å­˜é¡¹å¤„äºŽæŸä¸ªçŠ¶æ€çš„æ—¶é—´ï¼Œå½“æŸè¡¨é¡¹çš„ctimeå€¼å¤§äºŽè§„å®šçš„è¡¨é¡¹æœ€å¤§ç”Ÿå­˜å€¼æ—¶ï¼ŒLwIPå†…æ ¸ä¼šåˆ é™¤è¯¥è¡¨é¡¹ã€‚å› æ­¤ä½¿ç”¨ARPåŠŸèƒ½æ—¶ï¼Œå¿…é¡»è®¾ç½®ä¸€ä¸ªARPè¶…æ—¶äº‹ä»¶ï¼Œè¯¥è¶…æ—¶äº‹ä»¶çš„åŸºæœ¬åŠŸèƒ½å°±æ˜¯å¯¹æ¯ä¸ªè¡¨é¡¹çš„ctimeå­—æ®µå€¼åŠ 1ï¼Œç„¶åŽåˆ é™¤é‚£äº›ç”Ÿå­˜æ—¶é—´å¤§äºŽæœ€å¤§ç”Ÿå­˜å€¼çš„è¡¨é¡¹")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/02/P0PcWt.jpg",alt:"ARPå¤„ç†æµç¨‹"}})]),s._v(" "),n("ul",[n("li",[s._v("å‡½æ•°ethernet_inputæ ¹æ®æŠ¥æ–‡é¦–éƒ¨çš„å¸§ç±»åž‹å­—æ®µåˆ¤æ–­æŽ¥æ”¶åˆ°çš„æŠ¥æ–‡ç±»åž‹ï¼Œå¦‚æžœæ˜¯IPåŒ…ï¼Œåˆ™å°†è¯¥åŒ…ä¼ é€’ç»™etharp_ip_inputï¼Œå¦‚æžœæ˜¯ARPåŒ…ï¼Œåˆ™å°†è¯¥åŒ…é€’äº¤ç»™etharp_arp_input")]),s._v(" "),n("li",[s._v("å‡½æ•°etharp_ip_inputè°ƒç”¨å‡½æ•°update_arp_entryï¼Œå®ƒæ˜¯å°†æŠ¥æ–‡é¦–éƒ¨çš„MACåœ°å€å’ŒIPåœ°å€æ›´æ–°åˆ°ARPç¼“å­˜ä¸­")]),s._v(" "),n("li",[s._v("å‡½æ•°etharp_arp_inputé¦–å…ˆåˆ¤æ–­æŽ¥æ”¶åˆ°çš„ARPæ•°æ®åŒ…çš„ç±»åž‹ï¼Œå¦‚æžœæ˜¯ARPè¯·æ±‚åŒ…ï¼Œé‚£ä¹ˆé¦–å…ˆåˆ¤æ–­è¿™ä¸ªåŒ…æ˜¯å¦æ˜¯ç»™è‡ªå·±çš„ï¼Œå¦‚æžœæ˜¯ç»™è‡ªå·±çš„ï¼Œå°±åœ¨åŽŸæœ‰åŒ…çš„åŸºç¡€ä¸Šé‡ç»„ä¸€ä¸ªARPåº”ç­”åŒ…å‘é€å‡ºåŽ»ï¼›å¦‚æžœä¸æ˜¯ç»™è‡ªå·±çš„ï¼Œåˆ™ç›´æŽ¥å¿½ç•¥è€Œå¦‚æžœæŽ¥æ”¶åˆ°çš„æ•°æ®åŒ…æ˜¯ARPåº”ç­”åŒ…ï¼Œé‚£ä¹ˆå°±è°ƒç”¨update_arp_entryæ›´æ–°ARPç¼“å­˜è¡¨")])]),s._v(" "),n("h2",{attrs:{id:"ipå¤„ç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ipå¤„ç†","aria-hidden":"true"}},[s._v("#")]),s._v(" IPå¤„ç†")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/02/P0CUbQ.png",alt:"IPåè®®æ•°æ®åŒ…æ ¼å¼"}})]),s._v(" "),n("h4",{attrs:{id:"lwipè½¯ä»¶å¤§è‡´æ¡†æž¶"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lwipè½¯ä»¶å¤§è‡´æ¡†æž¶","aria-hidden":"true"}},[s._v("#")]),s._v(" LwIPè½¯ä»¶å¤§è‡´æ¡†æž¶")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/02/P0keJA.jpg",alt:"LwIPæ•´ä½“æ¡†æž¶å›¾"}})]),s._v(" "),n("ul",[n("li",[s._v("ip_inputä¼šåšå„é¡¹æ£€æŸ¥ï¼ŒåŒ…æ‹¬åè®®ç‰ˆæœ¬å·ï¼ŒIPé¦–éƒ¨çš„æ ¡éªŒå€¼ï¼ŒæºIPåœ°å€æ˜¯å¦æœ‰æ•ˆç­‰ï¼Œç„¶åŽæ£€æµ‹IPæ•°æ®åŒ…ä¸­çš„ç›®çš„IPåœ°å€æ˜¯å¦ä¸Žæœ¬èŠ‚ç‚¹çš„IPåœ°å€ç›¸ç¬¦ï¼Œå¦‚æžœæ˜¯æœ¬èŠ‚ç‚¹çš„IPåœ°å€ï¼Œåˆ™æ ¹æ®è¯¥IPæ•°æ®åŒ…é¦–éƒ¨çš„åè®®å­—æ®µåˆ¤æ–­è¯¥æ•°æ®åŒ…åº”è¯¥è¢«é€’äº¤åˆ°å“ªä¸ªä¸Šå±‚åè®®ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„å‡½æ•°ã€‚å¦‚æžœæ˜¯UDPåè®®ï¼Œåˆ™è°ƒç”¨udp_inputå‡½æ•°ï¼›å¦‚æžœæ˜¯TCPåè®®ï¼Œåˆ™è°ƒç”¨tcp_inputå‡½æ•°ï¼›å¦‚æžœæ˜¯ICMPåè®®ï¼Œåˆ™è°ƒç”¨icmp_inputå‡½æ•°ï¼›å¦‚æžœæ˜¯IGMPåè®®ï¼Œåˆ™è°ƒç”¨igmp_inputå‡½æ•°ï¼›å¦‚æžœéƒ½ä¸æ˜¯ï¼Œåˆ™è°ƒç”¨å‡½æ•°icmp_dest_unreachè¿”å›žä¸€ä¸ªåè®®ä¸å¯è¾¾ICMPæ•°æ®åŒ…ç»™æºä¸»æœºã€‚å¦‚æžœä¸æ˜¯æœ¬èŠ‚ç‚¹çš„IPåœ°å€ï¼Œåˆ™é€šè¿‡è°ƒç”¨å‡½æ•°ip_forwardå¯¹æ•°æ®åŒ…è¿›è¡Œè½¬å‘ã€‚éœ€è¦æ³¨æ„ï¼Œç”±äºŽä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½å«æœ‰å¤šä¸ªIPåœ°å€ï¼Œå› æ­¤ip_inputå‡½æ•°ä¼šéåŽ†ç½‘ç»œæŽ¥å£é“¾è¡¨netif_listä¸Šçš„netifç»“æž„å˜é‡ï¼Œæ¥æŸ¥æ‰¾ä¸ŽIPæ•°æ®åŒ…ä¸­ç›¸åŒ¹é…çš„IPåœ°å€ã€‚")]),s._v(" "),n("li",[s._v("ip_outputä½¿ç”¨ip_routeå‡½æ•°æŸ¥æ‰¾ç›®æ ‡ç½‘ç»œæŽ¥å£netifæ¥å‘é€IPæ•°æ®åŒ…ã€‚å½“ç½‘ç»œæŽ¥å£netifç¡®å®šåŽï¼ŒIPæ•°æ®åŒ…é€šè¿‡å‡½æ•°ip_output_ifå‘é€å‡ºåŽ»ã€‚è‹¥ip_routeæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ç½‘ç»œæŽ¥å£ï¼Œåˆ™ä¸¢å¼ƒè¯¥æŠ¥æ–‡ï¼Œç»ˆæ­¢æœ¬æ¬¡å‘é€ã€‚å‡½æ•°ip_routeé€šè¿‡éåŽ†ç½‘ç»œæŽ¥å£é“¾è¡¨netif_listï¼ŒæŸ¥æ‰¾ä¸Žç›®çš„IIPåœ°å€åœ¨åŒä¸€ä¸ªå­ç½‘ä¸­çš„ç½‘ç»œæŽ¥å£ï¼Œå¹¶å°†è¯¥ç½‘ç»œæŽ¥å£è¿”å›žç»™å˜é‡netifã€‚")])]),s._v(" "),n("h2",{attrs:{id:"icmpå¤„ç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#icmpå¤„ç†","aria-hidden":"true"}},[s._v("#")]),s._v(" ICMPå¤„ç†")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/02/P0AVmT.jpg",alt:"ICMPåè®®æ•°æ®åŒ…æ ¼å¼"}})]),s._v(" "),n("ul",[n("li",[s._v("icmp_inputåœ¨ip_inputä¸­è¢«è°ƒç”¨ï¼Œå®ƒå¤„ç†æŽ¥æ”¶åˆ°çš„ICMPæ•°æ®åŒ…ï¼Œå¹¶æ ¹æ®åŒ…ç±»åž‹åšç›¸åº”çš„å¤„ç†ã€‚åœ¨LwIPåè®®æ ˆä¸­ï¼Œå®ƒåªå¤„ç†ICMPå›žæ˜¾è¯·æ±‚åŒ…ï¼Œå¯¹å…¶ä»–ç±»åž‹çš„ICMPåŒ…ä¸ä½œå“åº”ã€‚icmp_inputåœ¨å¤„ç†ICMPå›žæ˜¾è¯·æ±‚æ—¶ï¼Œé¦–å…ˆåˆ¤æ–­è¯¥æ•°æ®åŒ…æ˜¯å¦ä¸ºå¹¿æ’­æˆ–è€…ç»„æ’­åŒ…ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™ç›´æŽ¥è¿”å›žï¼Œä¸å†ç»§ç»­å¤„ç†ï¼›å¦‚æžœä¸æ˜¯ï¼Œåˆ™ç»§ç»­åˆ¤æ–­è¯¥æ•°æ®åŒ…é•¿åº¦æ˜¯å¦å°äºŽICMPå›žæ˜¾è¯·æ±‚å¤´éƒ¨é•¿åº¦ï¼Œå¦‚æžœæ˜¯åˆ™ä¸¢å¼ƒæ•°æ®åŒ…ï¼›å¦‚æžœä¸æ˜¯åˆ™å°†è¯¥ICMPæŠ¥æ–‡ç±»åž‹å­—æ®µå˜ä¸º0ï¼Œé‡æ–°è®¡ç®—æ ¡éªŒå’Œï¼Œå¹¶å°†IPæŠ¥æ–‡é¦–éƒ¨çš„æºIPåœ°å€å’Œç›®çš„IPåœ°å€äº¤æ¢ä½ç½®ï¼Œå¹¶é€šè¿‡è°ƒç”¨å‡½æ•°ip_output_ifå°†æ•°æ®åŒ…å‘é€å‡ºåŽ»ã€‚")]),s._v(" "),n("li",[s._v("å‡½æ•°icmp_dest_unreachåœ¨ip_inputã€udp_inputä¸­è¢«è°ƒç”¨ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯é€šè¿‡è°ƒç”¨å‡½æ•°icmp_send_responseå‘é€ä¸€ä¸ªâ€œç›®çš„ä¸å¯åˆ°è¾¾â€ç±»åž‹çš„icmpæŠ¥æ–‡ã€‚åœ¨å‡½æ•°ip_inputä¸­ï¼Œå½“æ‰€æŽ¥æ”¶çš„IPæŠ¥æ–‡åè®®å­—æ®µä¸å¯è¯†åˆ«æ—¶ï¼Œicmp_dest_unreachå°±è¢«è°ƒç”¨ã€‚è€Œåœ¨UDPå¤„ç†å™¨ä¸­ï¼Œè‹¥ä¸èƒ½æ‰¾åˆ°ä¸ŽæŽ¥æ”¶çš„æŠ¥æ–‡ç›¸å¯¹åº”çš„ç«¯å£å·ï¼Œåˆ™icmp_dest_unreachä¹Ÿå°†è¢«è°ƒç”¨ã€‚")]),s._v(" "),n("li",[s._v("å‡½æ•°icmp_time_exceededåœ¨ip_forwardä¸­è¢«è°ƒç”¨ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯é€šè¿‡è°ƒç”¨å‡½æ•°icmp_send_responseå‘é€ä¸€ä¸ªâ€œè¶…æ—¶â€ç±»åž‹çš„ICMPæŠ¥æ–‡ã€‚åœ¨å‡½æ•°ip_forwardä¸­ï¼Œå½“TTLå‡å°ä¸º0æ—¶ï¼Œè°ƒç”¨è¯¥å‡½æ•°ã€‚")])]),s._v(" "),n("h2",{attrs:{id:"udpå¤„ç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#udpå¤„ç†","aria-hidden":"true"}},[s._v("#")]),s._v(" UDPå¤„ç†")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/02/P0JfdH.png",alt:"UDPåè®®æ•°æ®åŒ…"}})]),s._v(" "),n("ul",[n("li",[s._v("å‡½æ•°udp_inputå°†æ£€æŸ¥æŠ¥æ–‡çš„UDPæ ¡éªŒï¼Œæœ€ç»ˆè°ƒç”¨å‡½æ•°recvï¼Œå°†æ”¶åˆ°çš„æŠ¥æ–‡ä¼ é€’ç»™åº”ç”¨å±‚ç¨‹åº")]),s._v(" "),n("li",[s._v("å½“åº”ç”¨å±‚ç¨‹åºè¦é€šè¿‡UDPåè®®å‘å¤–å‘é€IPæŠ¥æ–‡æ—¶ï¼Œå°†é€šè¿‡è°ƒç”¨å‡½æ•°udp_sendå®žçŽ°ï¼Œå‡½æ•°udp_sendé€šè¿‡è°ƒç”¨IPå±‚çš„å‡½æ•°ip_output_ifå®žçŽ°æŠ¥æ–‡çš„å‘é€")]),s._v(" "),n("li",[s._v("LwIPä½¿ç”¨é“¾è¡¨ç»“æž„ä½“udp_pcbæ¥ä¿å­˜æ¯ä¸€ä¸ªUDPä¼šè¯çš„çŠ¶æ€")])]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("udp_pcb")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Common members of all PCB types */")]),s._v("\n  IP_PCB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Protocol specific PCB members */")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("udp_pcb")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  u8_t flags"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** ports are in host byte order */")]),s._v("\n  u16_t local_port"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" remote_port"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_MULTICAST_TX_OPTIONS")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** outgoing network interface for multicast packets */")]),s._v("\n  ip_addr_t multicast_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** TTL for outgoing multicast packets */")]),s._v("\n  u8_t mcast_ttl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_MULTICAST_TX_OPTIONS */")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_UDPLITE")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** used for UDP_LITE only */")]),s._v("\n  u16_t chksum_len_rx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" chksum_len_tx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_UDPLITE */")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** receive callback function */")]),s._v("\n  udp_recv_fn recv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** user-supplied argument for the recv callback */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("recv_arg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("h2",{attrs:{id:"tcpå¤„ç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tcpå¤„ç†","aria-hidden":"true"}},[s._v("#")]),s._v(" TCPå¤„ç†")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/02/P0JULF.png",alt:"TCPåè®®æ•°æ®åŒ…"}})]),s._v(" "),n("ul",[n("li",[s._v("TCPçš„æ»‘åŠ¨çª—å£åè®®æ˜¯ç”¨äºŽå®žçŽ°æµé‡æŽ§åˆ¶çš„")]),s._v(" "),n("li",[s._v("TCPçš„è¶…æ—¶å’Œé‡ä¼ æœºåˆ¶æé«˜äº†æ•°æ®ä¼ è¾“çš„å¯é æ€§")]),s._v(" "),n("li",[s._v("æ‹¥å¡žæŽ§åˆ¶æ˜¯é€šè¿‡æ…¢å¯åŠ¨ç®—æ³•å’Œæ‹¥å¡žé¿å…ç®—æ³•æ¥å®žçŽ°çš„")]),s._v(" "),n("li",[s._v("LwIPä¸­å«æœ‰ä¸¤ä¸ªå®šæ—¶å™¨å‡½æ•°ï¼štcp_fasttmrå’Œtcp_slowtmrï¼Œtcp_fasttmræ¯250msè°ƒç”¨ä¸€æ¬¡ï¼Œtcp_slowtmræ¯500msè°ƒç”¨ä¸€æ¬¡ã€‚å¿«é€Ÿå®šæ—¶å™¨ä¸»è¦åšä¸¤ä¸ªæ–¹é¢çš„äº‹æƒ…ï¼šå‘ä¸Šå±‚é€’äº¤ä¸Šå±‚ä¸€ç›´æœªæŽ¥æ”¶çš„æ•°æ®ï¼ŒäºŒæ˜¯å‘é€è¯¥è¿žæŽ¥ä¸Šçš„å»¶è¿ŸACKè¯·æ±‚æ•°æ®æ®µã€‚æ…¢é€Ÿå®šæ—¶å™¨å‚ä¸Žäº†è¾ƒå¤šåŠŸèƒ½ï¼Œå¦‚è¶…æ—¶ä¸Žé‡ä¼ ã€æ‹¥å¡žæŽ§åˆ¶ç­‰ã€‚")])]),s._v(" "),n("h2",{attrs:{id:"lwip-çš„ä¸‰ç§ç¼–ç¨‹æŽ¥å£"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lwip-çš„ä¸‰ç§ç¼–ç¨‹æŽ¥å£","aria-hidden":"true"}},[s._v("#")]),s._v(" LwIP çš„ä¸‰ç§ç¼–ç¨‹æŽ¥å£")]),s._v(" "),n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[s._v("RAW/Callback API")]),s._v(" "),n("p",[s._v("ç›´æŽ¥è°ƒç”¨åè®®æ ˆå„æ¨¡å—çš„å‡½æ•°ï¼ˆå®ƒä»¬æ˜¯ä½¿ç”¨"),n("strong",[s._v("å›žè°ƒå‡½æ•°")]),s._v("çš„ API æŽ¥å£ï¼Œä¹Ÿç§°ä¸º RAW APIï¼‰ã€‚")]),s._v(" "),n("p",[s._v("ä¼˜ç‚¹ï¼š")]),s._v(" "),n("ul",[n("li",[s._v("æ— éœ€æ“ä½œç³»ç»Ÿæ”¯æŒã€‚")]),s._v(" "),n("li",[s._v("LwIP å†…æ ¸æŠŠæ•°æ®äº¤ç»™åº”ç”¨ç¨‹åºçš„è¿‡ç¨‹åªæ˜¯ä¸€æ¬¡ç®€å•çš„ API è°ƒç”¨ï¼Œéžå¸¸èŠ‚çœæ—¶é—´å’Œç©ºé—´ã€‚")]),s._v(" "),n("li",[s._v("åº”ç”¨ç¨‹åºå’Œå†…æ ¸ç¨‹åºå¤„äºŽåŒä¸€çº¿ç¨‹ä¹‹ä¸­ï¼ŒèŠ‚çœäº†ä»»åŠ¡é—´é€šä¿¡å’Œä»»åŠ¡åˆ‡æ¢çš„å¼€é”€ã€‚")])]),s._v(" "),n("p",[s._v("ç¼ºç‚¹ï¼š")]),s._v(" "),n("ul",[n("li",[s._v("åº”ç”¨ç¨‹åºçš„æ‰§è¡Œä¼šåˆ¶çº¦å†…æ ¸ç¨‹åºçš„æ‰§è¡Œï¼Œä¸åŒçš„åº”ç”¨ç¨‹åºä¹‹é—´ä¹Ÿä¼šäº’ç›¸åˆ¶çº¦ã€‚åœ¨åº”ç”¨ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå†…æ ¸ç¨‹åºå°†ä¸èƒ½å¾—åˆ°è¿è¡Œï¼Œè¿™ä¼šå½±å“ç½‘ç»œæ•°æ®åŒ…çš„å¤„ç†æ•ˆçŽ‡ï¼Œä¸¥é‡åœ°è¿˜ä¼šé€ æˆæ•°æ®åŒ…å µå¡žè€Œå‘ç”Ÿä¸¢åŒ…çŽ°è±¡ã€‚")])])]),s._v(" "),n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[s._v("Netconn API")]),s._v(" "),n("p",[s._v("ä½¿ç”¨ LwIP æä¾›çš„ä¸“ç”¨ APIï¼Œä¹Ÿç§°ä¸º Sequential APIï¼Œç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹åŸºäºŽ "),n("strong",[s._v("open-read-write-close")]),s._v(" æ¨¡åž‹ã€‚Netconn API æ˜¯åŸºäºŽæ“ä½œç³»ç»Ÿçš„ IPC æœºåˆ¶å®žçŽ°çš„ï¼Œå®ƒå°† LwIP å†…æ ¸ä»£ç å’Œç½‘ç»œåº”ç”¨ç¨‹åºåˆ†ç¦»æˆç‹¬ç«‹çš„çº¿ç¨‹ã€‚")]),s._v(" "),n("p",[s._v("ä¼˜ç‚¹ï¼š")]),s._v(" "),n("ul",[n("li",[s._v("LwIP çº¿ç¨‹åªè´Ÿè´£æ•°æ®åŒ…çš„ TCP/IP å°è£…å’Œæ‹†å°ï¼Œä¸ç”¨è¿›è¡Œæ•°æ®çš„åº”ç”¨å±‚å¤„ç†ï¼Œæé«˜äº†ç³»ç»Ÿå¯¹ç½‘ç»œæ•°æ®åŒ…çš„å¤„ç†æ•ˆçŽ‡ã€‚")]),s._v(" "),n("li",[s._v("ç›¸è¾ƒäºŽ Socket APIï¼ŒNetconn API é¿å…äº†å†…æ ¸ç¨‹åºå’Œç½‘ç»œåº”ç”¨ç¨‹åºä¹‹é—´çš„æ•°æ®æ‹·è´ï¼Œæé«˜äº†æ•°æ®ä¼ é€’çš„æ•ˆçŽ‡ã€‚")])]),s._v(" "),n("p",[s._v("ç¼ºç‚¹ï¼š")]),s._v(" "),n("ul",[n("li",[s._v("ä¾èµ–æ“ä½œç³»ç»Ÿã€‚")]),s._v(" "),n("li",[s._v("å†…æ ¸ç¨‹åºå’Œç½‘ç»œåº”ç”¨ç¨‹åºä¹‹é—´çš„æ•°æ®åŒ…ä¼ é€’éœ€è¦ä¾é æ“ä½œç³»ç»Ÿçš„ä¿¡å·é‡å’Œé‚®ç®±æœºåˆ¶å®Œæˆï¼Œè€—è´¹äº†æ›´å¤šçš„æ—¶é—´å’Œå†…å­˜ã€‚")])])]),s._v(" "),n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[s._v("BSD Socket API")]),s._v(" "),n("p",[s._v("Socket å¯¹ç½‘ç»œè¿žæŽ¥è¿›è¡Œäº†é«˜çº§çš„æŠ½è±¡ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥åƒæ“ä½œæ–‡ä»¶ä¸€æ ·æ“ä½œç½‘ç»œè¿žæŽ¥ã€‚LwIP çš„ Socket API æ˜¯åŸºäºŽ Netconn API å®žçŽ°çš„ã€‚")]),s._v(" "),n("p",[s._v("ä¼˜ç‚¹ï¼š")]),s._v(" "),n("ul",[n("li",[s._v("ä½¿ç”¨ Socket ç¼–å†™çš„ç½‘ç»œåº”ç”¨ç¨‹åºå…·æœ‰å¾ˆå¥½çš„å¯ç§»æ¤æ€§ã€‚")])]),s._v(" "),n("p",[s._v("ç¼ºç‚¹ï¼š")]),s._v(" "),n("ul",[n("li",[s._v("Socket API åœ¨å†…æ ¸ç¨‹åºå’Œåº”ç”¨ç¨‹åºä¹‹é—´å­˜åœ¨æ•°æ®æ‹·è´ï¼Œé™ä½Žäº†æ•°æ®ä¼ é€’çš„æ•ˆçŽ‡ã€‚")])])]),s._v(" "),n("div",{staticClass:"warning custom-block"},[n("p",[s._v("LwIP å¹¶æ²¡æœ‰å®žçŽ°å…¨éƒ¨çš„ BSD Socket APIã€‚")])]),s._v(" "),n("h3",{attrs:{id:"tcp-raw-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tcp-raw-api","aria-hidden":"true"}},[s._v("#")]),s._v(" TCP RAW API")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/10/P6l7j0.png",alt:"TCP RAW API"}})]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("å‡½æ•°")]),s._v(" "),n("th",[s._v("è¯´æ˜Ž")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("struct tcp_pcb* tcp_new()")]),s._v(" "),n("td",[s._v("æ–°å»ºtcpåè®®æŽ§åˆ¶å—")])]),s._v(" "),n("tr",[n("td",[s._v("ert_t tcp_bind(struct tcp_pcb* pcb,struct ip_addr* ipaddr,u16_t port)")]),s._v(" "),n("td",[s._v("ç»‘å®šæœ¬åœ°IPåœ°å€å’Œç«¯å£å·ï¼Œå¦‚æžœipaddrä¸ºIP_ADDR_ANYï¼Œåˆ™å°†è¿žæŽ¥ç»‘å®šåˆ°æ‰€æœ‰çš„æœ¬åœ°IPåœ°å€ä¸Š")])]),s._v(" "),n("tr",[n("td",[s._v("struct tcp_pcb* tcp_listen(struct tcp_pcb* pcb)")]),s._v(" "),n("td",[s._v("ä½¿æŒ‡å®šçš„è¿žæŽ¥å¼€å§‹è¿›å…¥ç›‘å¬çŠ¶æ€ï¼Œå¦‚æžœç›‘å¬æˆåŠŸï¼Œå°±è¿”å›žä¸€ä¸ªæ–°çš„è¿žæŽ¥æŽ§åˆ¶å—pcb")])]),s._v(" "),n("tr",[n("td",[s._v("void tcp_accepted(struct tcp_pcb* pcb)")]),s._v(" "),n("td",[s._v("é€šçŸ¥LwIPä¸€ä¸ªæ–°æ¥çš„è¿žæŽ¥å·²ç»è¢«æŽ¥æ”¶ï¼Œè¿™ä¸ªå‡½æ•°é€šå¸¸åœ¨ç”±tcp_acceptæŒ‡å®šçš„å›žè°ƒå‡½æ•°ä¸­è¢«è°ƒç”¨")])]),s._v(" "),n("tr",[n("td",[s._v("void tcp_accept(struct tcp_pcb* pcb,err_t (*accept)(void* arg,struct tcp_pcb* newpcb,err_t err))")]),s._v(" "),n("td",[s._v("æŒ‡å®šå¤„äºŽç›‘å¬çŠ¶æ€çš„è¿žæŽ¥ï¼Œåœ¨æˆåŠŸå»ºç«‹è¿žæŽ¥åŽè¦è°ƒç”¨çš„å›žè°ƒæ–¹æ³•")])]),s._v(" "),n("tr",[n("td",[s._v("err_t tcp_connect(struct tcp_pcb* pcb,struct ip_addr* ipaddr,u16_t port,err_t (* connected)(void* arg,struct tcp_pcb* tpcb,err_t err))")]),s._v(" "),n("td",[s._v("è¯·æ±‚è¿žæŽ¥åˆ°æ‰§è¡Œçš„è¿œç¨‹ä¸»æœº")])]),s._v(" "),n("tr",[n("td",[s._v("err_t tcp_write(struct tcp_pcb* pcb,void* dataptr,u16_t len,u8_t copy)")]),s._v(" "),n("td",[s._v("å‘é€TCPæ•°æ®ï¼Œå°†è¦å‘é€çš„æ•°æ®æ”¾å…¥å‘é€é˜Ÿåˆ—ä¸­ï¼Œç”±åè®®æ ˆå†…æ ¸å‘é€ï¼Œcopyä¸º0åˆ™ä¸ä¼šä¸ºå‘é€çš„æ•°æ®åˆ†é…æ–°çš„å†…å­˜ç©ºé—´")])]),s._v(" "),n("tr",[n("td",[s._v("void tcp_sent(struct tcp_pcb* pcb,err_t (*sent)(void* arg,struct tcp_pcb* tpcb,u16_t len))")]),s._v(" "),n("td",[s._v("æŒ‡å®šå½“è¿œç¨‹ä¸»æœºæˆåŠŸæŽ¥æ”¶æ•°æ®åŽï¼Œåº”ç”¨ç¨‹åºè°ƒç”¨çš„å›žè°ƒå‡½æ•°")])]),s._v(" "),n("tr",[n("td",[s._v("void tcp_recv(struct tcp_pcb* pcb,err_t (* recv)(void* arg,struct tcp_pcb* tpcb,struct pbuf* p,err_t err))")]),s._v(" "),n("td",[s._v("æŒ‡å®šæŽ¥æ”¶æ•°æ®æ—¶è°ƒç”¨çš„å›žè°ƒå‡½æ•°")])]),s._v(" "),n("tr",[n("td",[s._v("void tcp_recved(struct tcp_pcb* pcb,u16_t len)")]),s._v(" "),n("td",[s._v("ç”¨äºŽèŽ·å–æŽ¥æ”¶åˆ°çš„æ•°æ®çš„é•¿åº¦ï¼Œå¿…é¡»åœ¨tcp_recvæŒ‡å®šçš„å›žè°ƒå‡½æ•°ä¸­è¢«è°ƒç”¨")])]),s._v(" "),n("tr",[n("td",[s._v("err_t tcp_close(struct tcp_pcb* pcb)")]),s._v(" "),n("td",[s._v("å…³é—­ä¸€ä¸ªæŒ‡å®šçš„TCPè¿žæŽ¥ï¼Œè°ƒç”¨è¯¥å‡½æ•°åŽå°†ä¼šé‡Šæ”¾pcbæŽ§åˆ¶å—æ‰€å ç”¨çš„å†…å­˜ç©ºé—´")])]),s._v(" "),n("tr",[n("td",[s._v("void tcp_abort(struct tcp_pcb* pcb)")]),s._v(" "),n("td",[s._v("ç»ˆæ­¢ä¸€ä¸ªæŒ‡å®šçš„è¿žæŽ¥ï¼Œè°ƒç”¨è¯¥å‡½æ•°åŽï¼ŒpcbæŽ§åˆ¶å—æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å°†è¢«é‡Šæ”¾")])]),s._v(" "),n("tr",[n("td",[s._v("void tcp_err(struct tcp_pcb* pcb,void (*err)(void* arg,err_t err))")]),s._v(" "),n("td",[s._v("æŒ‡å®šå¤„ç†é”™è¯¯çš„å›žè°ƒå‡½æ•°")])])])]),s._v(" "),n("h3",{attrs:{id:"tcp-raw-api-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tcp-raw-api-2","aria-hidden":"true"}},[s._v("#")]),s._v(" TCP RAW API")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/10/P6lLHU.png",alt:"UDP RAW API"}})]),s._v(" "),n("h3",{attrs:{id:"netconn-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#netconn-api","aria-hidden":"true"}},[s._v("#")]),s._v(" Netconn API")]),s._v(" "),n("ul",[n("li",[s._v("æ•°æ®ç»“æž„netconnæè¿°äº†åº”ç”¨ç¨‹åºè¦ä½¿ç”¨APIå‡½æ•°æœºé‚£é‡Œä¸€ä¸ªè¿žæŽ¥çš„å„ç§å±žæ€§ï¼ŒåŒ…æ‹¬äº†è¿žæŽ¥çš„ç±»åž‹ã€æœ€è¿‘çš„æ•…éšœä»£ç ã€å›žè°ƒå‡½æ•°ç­‰ã€‚")])]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** A netconn descriptor */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("netconn")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** type of the netconn (TCP, UDP or RAW) */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("enum")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("netconn_type")]),s._v(" type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** current state of the netconn */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("enum")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("netconn_state")]),s._v(" state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** the lwIP internal protocol control block */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("union")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ip_pcb")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("tcp_pcb")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("tcp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("udp_pcb")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("udp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("raw_pcb")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("raw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" pcb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** the last error this netconn had */")]),s._v("\n  err_t last_err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  \n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" !LWIP_NETCONN_SEM_PER_THREAD")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** sem that is used to synchronously execute functions in the core context */")]),s._v("\n  sys_sem_t op_completed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** mbox where received packets are stored until they are fetched\n      by the netconn application thread (can grow quite big) */")]),s._v("\n  sys_mbox_t recvmbox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_TCP")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** mbox where new connections are stored until processed\n      by the application thread */")]),s._v("\n  sys_mbox_t acceptmbox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_TCP */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** only used for socket layer */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_SOCKET")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" socket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_SOCKET */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_SO_SNDTIMEO")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** timeout to wait for sending data (which means enqueueing data for sending\n      in internal buffers) in milliseconds */")]),s._v("\n  s32_t send_timeout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_SO_RCVTIMEO */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_SO_RCVTIMEO")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** timeout in milliseconds to wait for new data to be received\n      (or connections to arrive for listening netconns) */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" recv_timeout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_SO_RCVTIMEO */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_SO_RCVBUF")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** maximum amount of bytes queued in recvmbox\n      not used for TCP: adjust TCP_WND instead! */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" recv_bufsize"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** number of bytes currently in recvmbox to be received,\n      tested against recv_bufsize to limit bytes on recvmbox\n      for UDP and RAW, used for FIONREAD */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" recv_avail"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_SO_RCVBUF */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_SO_LINGER")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** values <0 mean linger is disabled, values > 0 are seconds to linger */")]),s._v("\n  s16_t linger"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_SO_LINGER */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** flags holding more netconn-internal state, see NETCONN_FLAG_* defines */")]),s._v("\n  u8_t flags"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" LWIP_TCP")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** TCP: when data passed to netconn_write doesn't fit into the send buffer,\n      this temporarily stores how much is already sent. */")]),s._v("\n  size_t write_offset"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** TCP: when data passed to netconn_write doesn't fit into the send buffer,\n      this temporarily stores the message.\n      Also used during connect and close. */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("api_msg_msg")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("current_msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")]),s._v(" ")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* LWIP_TCP */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** A callback function that is informed about events for this netconn */")]),s._v("\n  netconn_callback callback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/10/P61AED.png",alt:"Netconn API"}})]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("å‡½æ•°")]),s._v(" "),n("th",[s._v("è¯´æ˜Ž")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("struct netconn* netconn_new_with_proto_and_callback(enum netconn_type t,u8_t proto,netconn_callback callback)")]),s._v(" "),n("td",[s._v("å»ºç«‹ä¸€ä¸ªæ–°çš„netconnè¿žæŽ¥")])]),s._v(" "),n("tr",[n("td",[s._v("err_t netconn_delete(struct netconn* conn)")]),s._v(" "),n("td",[s._v("åˆ é™¤netconnæ‰€æŒ‡å‘çš„è¿žæŽ¥")])]),s._v(" "),n("tr",[n("td",[s._v("err_t netconn_getaddr(struct netconn* conn,struct ip_addr* addr,u16_t* port,u8_t local)")]),s._v(" "),n("td",[s._v("èŽ·å–connè¿žæŽ¥çš„ä¸»æœºIPåœ°å€å’Œç«¯å£å·")])]),s._v(" "),n("tr",[n("td",[s._v("err_t netconn_bind(struct netconn* conn,struct ip_addr* addr,u16_t port)")]),s._v(" "),n("td",[s._v("å°†ä¸€ä¸ªIPåœ°å€åŠç«¯å£å·ä¸ŽconnæŒ‡å‘çš„è€Œè¿žæŽ¥ç»‘å®š")])]),s._v(" "),n("tr",[n("td",[s._v("err_t netconn_connect(struct netconn* conn,struct ip_addr* addr,u16_t port)")]),s._v(" "),n("td",[s._v("å°†æœåŠ¡å™¨ç«¯çš„IPåœ°å€å’Œç«¯å£å·ä¸ŽconnæŒ‡å‘çš„è¿žæŽ¥ç»‘å®š")])]),s._v(" "),n("tr",[n("td",[s._v("err_t netconn_disconnect(struct netconn* conn)")]),s._v(" "),n("td",[s._v("æ–­å¼€connæŒ‡å‘çš„è¿žæŽ¥")])]),s._v(" "),n("tr",[n("td",[s._v("err_t netconn_listen_with_backlog(struct netconn* connï¼Œu8_t backlog)")]),s._v(" "),n("td",[s._v("å°†connæŒ‡å‘çš„è¿žæŽ¥è®¾å®šä¸ºç›‘å¬çŠ¶æ€")])]),s._v(" "),n("tr",[n("td",[s._v("struct netconn* netconn_accept(struct netconn* conn)")]),s._v(" "),n("td",[s._v("æŽ¥æ”¶å®¢æˆ·ç«¯çš„è¿žæŽ¥ï¼Œè¯¥å‡½æ•°ä¼šé˜»å¡žåœ¨acceptmboxé‚®ç®±ä¸Š")])]),s._v(" "),n("tr",[n("td",[s._v("struct netbuf* netconn_recv(struct netconn* conn)")]),s._v(" "),n("td",[s._v("æŽ¥æ”¶æ•°æ®ï¼ŒæŽ¥æ”¶åˆ°çš„æ•°æ®è¢«å°è£…ä¸ºnetbufç»“æž„")])]),s._v(" "),n("tr",[n("td",[s._v("err_t netconn_sendto(struct netconn* conn,struct netbuf* buf,struct ip_addr* addr,u16_t port)")]),s._v(" "),n("td",[s._v("å‘ä¸€ä¸ªæŒ‡å®šçš„IPåœ°å€å’Œç«¯å£å·å‘é€æ•°æ®ï¼Œè¿™ä¸ªå‡½æ•°åªèƒ½ç”¨åœ¨connç±»åž‹ä¸ºUDPæˆ–è€…RAWçš„è¿žæŽ¥ä¸­")])]),s._v(" "),n("tr",[n("td",[s._v("err_t netconn_write(struct netconn* conn,const void* dataptr,size_t size,u8_t apiflag)")]),s._v(" "),n("td",[s._v("å‘ç›¸åº”çš„TCPè¿žæŽ¥ä¸Šå‘é€æ•°æ®ï¼Œè¿™ä¸ªå‡½æ•°åªèƒ½ç”¨äºŽå‘é€TCPçš„æŠ¥æ–‡")])]),s._v(" "),n("tr",[n("td",[s._v("err_t nnetconn_close(struct netconn* conn)")]),s._v(" "),n("td",[s._v("å…³é—­connæŒ‡å‘çš„è¿žæŽ¥")])])])]),s._v(" "),n("ul",[n("li",[s._v("netconn_new_with_proto_and_callbacké¦–å…ˆè°ƒç”¨netconn_allocå‡½æ•°åˆ†é…å¹¶åˆå§‹åŒ–ä¸€ä¸ªnetconnç»“æž„ï¼ŒæŽ¥ä¸‹æ¥è¯¥å‡½æ•°ä¼šæž„å»ºä¸€ä¸ªapi_msgæ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯è¦æ±‚å†…æ ¸æ‰§è¡Œå‡½æ•°do_newconnï¼Œæœ€åŽè°ƒç”¨å‡½æ•°tcpip_apimsgæ¥å°†æ¶ˆæ¯åŒ…è£…æˆtcpip_msgç»“æž„å¹¶å‘é€å‡ºåŽ»ã€‚tcpip_threadå‡½æ•°è§£æžè¯¥æ¶ˆæ¯å¹¶è°ƒç”¨å‡½æ•°do_newconnï¼Œdo_newconnæ ¹æ®å‚æ•°çš„ç±»åž‹è°ƒç”¨å‡½æ•°tcp_newåˆ›å»ºä¸€ä¸ªTCPæŽ§åˆ¶å—")]),s._v(" "),n("li",[s._v("tcpip_threadæ˜¯å¤„ç†TCP/IPçš„å†…æ ¸åè®®æ ˆè¿›ç¨‹ï¼Œå®ƒåªæŽ¥æ”¶tcpip_msgç»“æž„å°è£…çš„æ¶ˆæ¯ï¼Œå¹¶æ ¹æ®æ¶ˆæ¯çš„ç±»åž‹æ¥åˆ¤å®šè¯¥æ¶ˆæ¯æ¥è‡ªç‰©ç†ç½‘å¡æˆ–åº”ç”¨å±‚ç¨‹åºã€‚å¦‚æžœæŽ¥æ”¶åˆ°ç½‘å¡çš„IPæŠ¥æ–‡ï¼Œåˆ™å°†è¯¥æŠ¥æ–‡é€’äº¤ç»™ip_inputå‡½æ•°ï¼›å¦‚æžœæ˜¯åº”ç”¨å±‚ç¨‹åºå‘é€çš„æ¶ˆæ¯ï¼Œåˆ™é€šè¿‡è°ƒç”¨æ¶ˆæ¯æŒ‡å®šçš„å†…æ ¸å¤„ç†å‡½æ•°æ¥å®Œæˆç›¸åº”çš„åŠŸèƒ½")])]),s._v(" "),n("h3",{attrs:{id:"socket-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#socket-api","aria-hidden":"true"}},[s._v("#")]),s._v(" Socket API")]),s._v(" "),n("blockquote",[n("p",[s._v("LwIPæä¾›äº†æ ‡å‡†BSDå¥—æŽ¥å­—APIï¼Œå®ƒä¹Ÿæ˜¯æœ‰åºAPIï¼Œåœ¨å†…å­˜æž„å»ºäºŽNetconn APIä¹‹ä¸Šã€‚æ‰€è°“â€œæœ‰åºâ€æ˜¯æŒ‡å…¶æ‰§è¡Œæ¨¡åž‹åŸºäºŽå…¸åž‹çš„é˜»å¡žå¼æ‰“å¼€-è¯»-å†™-å…³é—­æœºåˆ¶ã€‚")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/10/P61V4H.png",alt:"Socket API"}})]),s._v(" "),n("h2",{attrs:{id:"lwipç§»æ¤"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lwipç§»æ¤","aria-hidden":"true"}},[s._v("#")]),s._v(" LwIPç§»æ¤")]),s._v(" "),n("blockquote",[n("ol",[n("li",[s._v("ä»¥å¤ªç½‘æŽ¥å£ä»»åŠ¡ç”¨äºŽæŽ¥æ”¶æ¥è‡ªç‰©ç†ç½‘å¡çš„æ•°æ®æŠ¥æ–‡ï¼ŒåŒæ—¶å°†æ”¶åˆ°çš„æŠ¥æ–‡é€šè¿‡FreeRTOSæä¾›çš„é‚®ç®±ä¼ é€’ç»™TCP/IPåè®®æ ˆä»»åŠ¡ã€‚ä»¥å¤ªç½‘æŽ¥å£ä»»åŠ¡å¹³æ—¶å¤„äºŽæŒ‚èµ·çŠ¶æ€ï¼Œå½“ç¡¬ä»¶æ”¶åˆ°æŠ¥æ–‡æ—¶ï¼Œå°†äº§ç”ŸæŽ¥æ”¶æŠ¥æ–‡ä¸­æ–­ï¼Œè¯¥ç»ˆç«¯ä»¥ä¿¡å·é‡çš„æ–¹å¼å°†ä»¥å¤ªç½‘æŽ¥å£ä»»åŠ¡æ¿€æ´»")]),s._v(" "),n("li",[s._v("åº”ç”¨ç¨‹åºä½¿ç”¨TCP/IPåè®®æ ˆæä¾›çš„Sequential APIæŽ¥å£è®¿é—®LwIPï¼ŒåŒæ—¶è¿™ä¸¤ä¸ªç‹¬ç«‹çš„ä»»åŠ¡éœ€è¦ä½¿ç”¨FreeRTOSæä¾›çš„é‚®ç®±æœºåˆ¶å®žçŽ°å½¼æ­¤ä¹‹é—´ä¿¡æ¯çš„äº¤äº’ã€‚Sequential APIæŽ¥å£å‡½æ•°åœ¨FreeRTOSæ“ä½œç³»ç»Ÿè¿è¡ŒçŽ¯å¢ƒä¸‹æ˜¯â€œé˜»å¡žâ€å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´åº”ç”¨ç¨‹åºä»»åŠ¡åœ¨è°ƒç”¨Sequential APIæŽ¥å£å‡½æ•°æ—¶ï¼Œå°†ä¼šè¢«é˜»å¡žï¼Œç›´åˆ°æ”¶åˆ°æ¥è‡ªTCP/IPåè®®æ ˆè¿”å›žçš„æ¶ˆæ¯åº”ç­”")]),s._v(" "),n("li",[s._v("åŸºäºŽLwIPçš„TCP/IPåè®®æ ˆä¸Žåº”ç”¨ç¨‹åºè¿è¡Œåœ¨ä¸¤ä¸ªç‹¬ç«‹çš„ä»»åŠ¡ä¸­")])])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/09/PyyVRx.jpg",alt:"ç½‘å¡é©±åŠ¨ç§»æ¤"}})]),s._v(" "),n("ol",[n("li",[s._v("ä»¥å¤ªç½‘æŽ¥å£æ–‡ä»¶ethernetif.cçš„ç§»æ¤ï¼Œä¸»è¦åŒ…å«"),n("code",[s._v("ethernet_low_level_init")]),s._v("ï¼Œ"),n("code",[s._v("ethernet_low_level_output")]),s._v("ï¼Œ"),n("code",[s._v("ethernetif_input")]),s._v("ï¼Œ"),n("code",[s._v("ethernetif_init")]),s._v("è¿™å‡ ä¸ªå‡½æ•°çš„åŠŸèƒ½\n"),n("ul",[n("li",[n("code",[s._v("ethernetif_input")]),s._v("å‡½æ•°ç”¨äºŽä»Žåº•å±‚ç‰©ç†ç½‘å¡è¯»å–æŠ¥æ–‡ï¼Œå¹¶å°†è¯¥æŠ¥æ–‡å‘ä¸Šä¼ é€’ç»™LwIPåè®®æ ˆå‡½æ•°ethernet_inputè¿›è¡Œå¤„ç†")]),s._v(" "),n("li",[n("code",[s._v("ethernetif_init")]),s._v("å‡½æ•°æŒ‡å®šäº†ç½‘ç»œæŽ¥å£netifå¯¹åº”çš„ä¸»æœºååŠç½‘å¡æè¿°ï¼Œå¹¶æŒ‡å®šäº†è¯¥ç½‘å¡çš„MACåœ°å€ï¼ŒåŒäº‹è¿˜æŒ‡å®šäº†netifçš„å‘é€æ•°æ®æŠ¥æ–‡å‡½æ•°")])])]),s._v(" "),n("li",[s._v("æ“ä½œç³»ç»Ÿæ¨¡æ‹Ÿå±‚æ–‡ä»¶sys_arch.cçš„ç§»æ¤ï¼Œæ€»çš„æ¥æ—¶æ“ä½œç³»ç»Ÿæ¨¡æ‹Ÿå±‚ä¸»è¦å®Œæˆäº†ä¸Žä¿¡å·é‡ã€æ¶ˆæ¯é‚®ç®±æœºåˆ¶ã€çº¿ç¨‹ç›¸å…³çš„åŠŸèƒ½\n"),n("ul",[n("li",[s._v("åœ¨sys_arch.hæ–‡ä»¶ä¸­å¯¹ä¿¡å·é‡ã€é‚®ç®±ã€çº¿ç¨‹å¯¹è±¡è¿›è¡Œé‡å®šä¹‰")]),s._v(" "),n("li",[s._v("sys_mbox_newå‡½æ•°ï¼Œä½¿ç”¨FreeRTOSæä¾›çš„æ¶ˆæ¯é˜Ÿåˆ—æœºåˆ¶åˆ›å»ºä¸€ä¸ªç©ºçš„æ¶ˆæ¯é˜Ÿåˆ—")]),s._v(" "),n("li",[s._v("sys_mbox_freeå‡½æ•°ï¼Œåˆ é™¤ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå½“è¯¥é˜Ÿåˆ—ä¸­è¿˜æœ‰æœªè¢«å–å‡ºçš„æ¶ˆæ¯æ—¶ï¼Œè¯¥å‡½æ•°åº”å½“æŠ¥é”™ï¼Œå¹¶é€šçŸ¥åº”ç”¨ç¨‹åº")]),s._v(" "),n("li",[s._v("sys_mbox_postå‡½æ•°ï¼Œå°†æ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œè¯¥å‡½æ•°æ˜¯ä¸€ä¸ªé˜»å¡žå‡½æ•°ï¼Œå½“æ¶ˆæ¯è¢«å‘é€è‡³é˜Ÿåˆ—åŽï¼Œè¯¥å‡½æ•°æ‰ä¼šé€€å‡ºé˜»å¡žçŠ¶æ€")]),s._v(" "),n("li",[s._v("sys_mbox_trypostå‡½æ•°ï¼Œç”¨äºŽå°è¯•å°†æŸä¸ªæ¶ˆæ¯å‘é€è‡³æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå½“æ¶ˆæ¯è¢«æˆåŠŸæŠ•é€’åŽï¼Œåˆ™è¿”å›žæˆåŠŸï¼Œå¦åˆ™è¿”å›žå¤±è´¥")]),s._v(" "),n("li",[s._v("sys_arch_mbox_fetchå‡½æ•°ï¼Œç”¨äºŽä»Žæ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºä¸€æ¡æ¶ˆæ¯ï¼Œè¯¥å‡½æ•°æ˜¯ä¸€ä¸ªé˜»å¡žå‡½æ•°ï¼Œè°ƒç”¨è¯¥å‡½æ•°çš„çº¿ç¨‹è‹¥æœªå–åˆ°æ¶ˆæ¯ï¼Œåˆ™åœ¨å½¢å‚timeoutæ‰€æŒ‡å®šçš„æ—¶é—´å†…ï¼Œè¯¥çº¿ç¨‹è¢«é˜»å¡žã€‚å½“è¶…è¿‡timeoutæ‰€æŒ‡å®šçš„æ—¶é—´åŽï¼Œè¯¥çº¿ç¨‹æ¢å¤è‡³å°±ç»ªçŠ¶æ€ã€‚è‹¥timeoutä¸º0ï¼Œåˆ™è°ƒç”¨è¯¥å‡½æ•°çš„çº¿ç¨‹ä¸€ç›´è¢«é˜»å¡žï¼Œç›´åˆ°æ”¶åˆ°æ¶ˆæ¯")]),s._v(" "),n("li",[s._v("sys_arch_mbox_tryfetchå‡½æ•°å°è¯•ä»Žæ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºæ¶ˆæ¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªéžé˜»å¡žå‡½æ•°ï¼Œå½“å–åˆ°æ¶ˆæ¯æ—¶ï¼Œåˆ™è¿”å›žæˆåŠŸï¼Œå¦åˆ™ç«‹å³é€€å‡ºï¼Œè¿”å›žé˜Ÿåˆ—ç©º")]),s._v(" "),n("li",[s._v("sys_sem_newå‡½æ•°åˆ›å»ºä¸€ä¸ªä¿¡å·é‡ï¼Œå¹¶æ ¹æ®å½¢å‚çš„å€¼æŒ‡å®šå¥½å½“å‰ä¿¡å·é‡çš„çŠ¶æ€")]),s._v(" "),n("li",[s._v("sys_arch_sem_waitå‡½æ•°åœ¨å½¢å‚timeoutæŒ‡å®šçš„æ—¶é—´è¢«é˜»å¡žï¼Œè‹¥timeoutä¸º0ï¼Œåˆ™è°ƒç”¨è¯¥å‡½æ•°çš„çº¿ç¨‹å°†ä¸€ç›´è¢«é˜»å¡žï¼Œç›´åˆ°ç­‰å¾…çš„ä¿¡å·é‡è¢«é‡Šæ”¾ã€‚ä½†è¯¥å‡½æ•°å–åˆ°ä¿¡å·é‡æ—¶ï¼Œå®ƒå°†è¿”å›žå–åˆ°çš„è¯¥ä¿¡å·é‡æ‰€å çš„æ—¶é—´")]),s._v(" "),n("li",[s._v("sys_sem_signalå‡½æ•°ç”¨äºŽé‡Šæ”¾ä¸€ä¸ªä¿¡å·é‡")]),s._v(" "),n("li",[s._v("sys_sem_freeå‡½æ•°ç”¨äºŽåˆ é™¤ä¸€ä¸ªä¿¡å·é‡")]),s._v(" "),n("li",[s._v("sys_thread_newå‡½æ•°ç”¨äºŽåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹")]),s._v(" "),n("li",[s._v("sys_initå‡½æ•°æ˜¯æ“ä½œç³»ç»Ÿæ¨¡æ‹Ÿå±‚çš„åˆå§‹åŒ–å‡½æ•°ï¼Œä¸»è¦å¯¹å®šæ—¶å™¨ç®¡ç†æ•°ç»„è¿›è¡Œäº†åˆå§‹åŒ–")]),s._v(" "),n("li",[s._v("sys_zrch_timeoutså‡½æ•°ç”¨äºŽè¿”å›žå½“å‰ä»»åŠ¡çš„å®šæ—¶å™¨ç®¡ç†é“¾è¡¨é¦–åœ°å€")]),s._v(" "),n("li",[s._v("sys_arch_protectå‡½æ•°å’Œsys_arch_unprotectå‡½æ•°åœ¨è®¿é—®ä¸´ç•ŒåŒºèµ„æºæ—¶æˆå¯¹ä½¿ç”¨")])])]),s._v(" "),n("li",[s._v("ethernet_inputå‡½æ•°çš„å®žçŽ°åœ¨ç‹¬ç«‹æ¨¡å¼å’ŒRTOSæ¨¡å¼æ—¶æ˜¯ä¸åŒçš„ï¼š\n"),n("ul",[n("li",[s._v("åœ¨ç‹¬ç«‹åº”ç”¨ä¸­ï¼Œæ­¤å‡½æ•°å¿…é¡»è¢«æ’å…¥åˆ°åº”ç”¨çš„ä¸»å¾ªçŽ¯ä¸­ï¼Œä»¥ä¾¿è½®è¯¢ä»»ä½•æ”¶åˆ°çš„åŒ…")]),s._v(" "),n("li",[s._v("åœ¨RTOSåº”ç”¨ä¸­ï¼Œæ­¤å‡½æ•°ä¸ºä¸€ä¸ªé˜»å¡žçº¿ç¨‹ï¼Œåªæœ‰å½“å¾—åˆ°æ‰€ç­‰å¾…çš„ä¿¡å·é‡æ—¶æ‰å¤„ç†æŽ¥æ”¶åˆ°çš„æ•°æ®åŒ…ã€‚å½“ä»¥å¤ªç½‘å¤–è®¾æ”¶åˆ°æ•°æ®å¹¶äº§ç”Ÿä¸­æ–­æ—¶ï¼Œä¼šåœ¨ä¸­æ–­å¤„ç†å‡½æ•°ä¸­é‡Šæ”¾æ­¤ä¿¡å·é‡")])])])]),s._v(" "),n("h2",{attrs:{id:"lwipé…ç½®"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lwipé…ç½®","aria-hidden":"true"}},[s._v("#")]),s._v(" LwIPé…ç½®")]),s._v(" "),n("blockquote",[n("p",[s._v("LwIPæä¾›äº†åä¸ºlwipopts.hçš„æ–‡ä»¶ï¼Œå®ƒå…è®¸ç”¨æˆ·å……åˆ†é…ç½®æ ˆåŠå…¶æ‰€æœ‰æ¨¡å—ã€‚ç”¨æˆ·ä¸éœ€è¦å®šä¹‰æ‰€æœ‰LwIPé€‰é¡¹ï¼šå¦‚æžœæœªå®šä¹‰æŸé€‰é¡¹ï¼Œåˆ™ä½¿ç”¨opt.hæ–‡ä»¶ä¸­å®šä¹‰çš„é»˜è®¤å€¼")])]),s._v(" "),n("ul",[n("li",[s._v("å†…å­˜é…ç½®")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s1.ax1x.com/2018/08/10/P6GG5D.png",alt:"LwIPå†…å­˜é…ç½®"}})])])},[],!1,null,null,null);t.default=e.exports}}]);
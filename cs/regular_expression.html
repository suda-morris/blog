<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>正则表达式 | suda-morris 个人博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/blog/favicon.png">
    <link rel="manifest" href="/blog/manifest.json">
    <meta name="description" content="记录学习生活，探索未知领域">
    
    <link rel="preload" href="/blog/assets/css/0.styles.6d8afabb.css" as="style"><link rel="preload" href="/blog/assets/js/app.f7371fc1.js" as="script"><link rel="preload" href="/blog/assets/js/4.86db7451.js" as="script"><link rel="preload" href="/blog/assets/js/5.cc2c00ae.js" as="script"><link rel="preload" href="/blog/assets/js/13.4f481eb8.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.d57735f5.js"><link rel="prefetch" href="/blog/assets/js/11.32df3512.js"><link rel="prefetch" href="/blog/assets/js/12.4034ef2f.js"><link rel="prefetch" href="/blog/assets/js/14.59cf0e7f.js"><link rel="prefetch" href="/blog/assets/js/15.c8959e95.js"><link rel="prefetch" href="/blog/assets/js/16.ffd1339b.js"><link rel="prefetch" href="/blog/assets/js/17.7b5dae56.js"><link rel="prefetch" href="/blog/assets/js/18.8697be37.js"><link rel="prefetch" href="/blog/assets/js/19.7515aa84.js"><link rel="prefetch" href="/blog/assets/js/2.f785d2c1.js"><link rel="prefetch" href="/blog/assets/js/20.675d2d6b.js"><link rel="prefetch" href="/blog/assets/js/21.5b1ed3ba.js"><link rel="prefetch" href="/blog/assets/js/22.b0f3c0c2.js"><link rel="prefetch" href="/blog/assets/js/23.e85250c5.js"><link rel="prefetch" href="/blog/assets/js/24.e25d5894.js"><link rel="prefetch" href="/blog/assets/js/25.ab70bdf8.js"><link rel="prefetch" href="/blog/assets/js/26.30c40f25.js"><link rel="prefetch" href="/blog/assets/js/27.98475093.js"><link rel="prefetch" href="/blog/assets/js/28.a550e4dc.js"><link rel="prefetch" href="/blog/assets/js/29.046f7e94.js"><link rel="prefetch" href="/blog/assets/js/3.0f1a8f79.js"><link rel="prefetch" href="/blog/assets/js/30.fced83cb.js"><link rel="prefetch" href="/blog/assets/js/31.6928eb70.js"><link rel="prefetch" href="/blog/assets/js/32.b6a3f81d.js"><link rel="prefetch" href="/blog/assets/js/33.bf2721b1.js"><link rel="prefetch" href="/blog/assets/js/34.56c51ffd.js"><link rel="prefetch" href="/blog/assets/js/35.6c1d065e.js"><link rel="prefetch" href="/blog/assets/js/36.c1e95b2c.js"><link rel="prefetch" href="/blog/assets/js/37.2f057b97.js"><link rel="prefetch" href="/blog/assets/js/38.2506f779.js"><link rel="prefetch" href="/blog/assets/js/39.ae17cd2e.js"><link rel="prefetch" href="/blog/assets/js/40.7af103e2.js"><link rel="prefetch" href="/blog/assets/js/41.7e0c4fd2.js"><link rel="prefetch" href="/blog/assets/js/42.b7df5389.js"><link rel="prefetch" href="/blog/assets/js/43.ce0c76ac.js"><link rel="prefetch" href="/blog/assets/js/44.74acb7f6.js"><link rel="prefetch" href="/blog/assets/js/45.209d70ba.js"><link rel="prefetch" href="/blog/assets/js/46.446b24cf.js"><link rel="prefetch" href="/blog/assets/js/47.cc7c15cb.js"><link rel="prefetch" href="/blog/assets/js/48.d8003d98.js"><link rel="prefetch" href="/blog/assets/js/49.d8a0e817.js"><link rel="prefetch" href="/blog/assets/js/50.28bf0451.js"><link rel="prefetch" href="/blog/assets/js/51.29f7f8e6.js"><link rel="prefetch" href="/blog/assets/js/52.2663a05a.js"><link rel="prefetch" href="/blog/assets/js/53.9ce47afe.js"><link rel="prefetch" href="/blog/assets/js/54.e187ec7a.js"><link rel="prefetch" href="/blog/assets/js/55.2eda951a.js"><link rel="prefetch" href="/blog/assets/js/56.49fca5f7.js"><link rel="prefetch" href="/blog/assets/js/57.57168edc.js"><link rel="prefetch" href="/blog/assets/js/58.aa2bd46e.js"><link rel="prefetch" href="/blog/assets/js/59.cbfa961c.js"><link rel="prefetch" href="/blog/assets/js/6.cc76698f.js"><link rel="prefetch" href="/blog/assets/js/60.56cb85bf.js"><link rel="prefetch" href="/blog/assets/js/61.3b05db21.js"><link rel="prefetch" href="/blog/assets/js/62.a253c43f.js"><link rel="prefetch" href="/blog/assets/js/63.665b3419.js"><link rel="prefetch" href="/blog/assets/js/64.81d19861.js"><link rel="prefetch" href="/blog/assets/js/65.4a6980eb.js"><link rel="prefetch" href="/blog/assets/js/66.1d662c87.js"><link rel="prefetch" href="/blog/assets/js/67.2fa6ac31.js"><link rel="prefetch" href="/blog/assets/js/68.755cdf7f.js"><link rel="prefetch" href="/blog/assets/js/69.3035c303.js"><link rel="prefetch" href="/blog/assets/js/7.3616dd49.js"><link rel="prefetch" href="/blog/assets/js/70.d9d4a8ee.js"><link rel="prefetch" href="/blog/assets/js/71.73cc51c4.js"><link rel="prefetch" href="/blog/assets/js/72.efd94039.js"><link rel="prefetch" href="/blog/assets/js/73.059d55ba.js"><link rel="prefetch" href="/blog/assets/js/74.4ad46ecd.js"><link rel="prefetch" href="/blog/assets/js/75.34c15c92.js"><link rel="prefetch" href="/blog/assets/js/76.1b725aa4.js"><link rel="prefetch" href="/blog/assets/js/77.50e92786.js"><link rel="prefetch" href="/blog/assets/js/78.e8947189.js"><link rel="prefetch" href="/blog/assets/js/79.0f0918b7.js"><link rel="prefetch" href="/blog/assets/js/8.25f08ec4.js"><link rel="prefetch" href="/blog/assets/js/80.66771e2f.js"><link rel="prefetch" href="/blog/assets/js/81.9de4e215.js"><link rel="prefetch" href="/blog/assets/js/82.7d56175f.js"><link rel="prefetch" href="/blog/assets/js/83.fa751f46.js"><link rel="prefetch" href="/blog/assets/js/84.5039ce08.js"><link rel="prefetch" href="/blog/assets/js/85.29f3100c.js"><link rel="prefetch" href="/blog/assets/js/86.f2989267.js"><link rel="prefetch" href="/blog/assets/js/87.d8d55a52.js"><link rel="prefetch" href="/blog/assets/js/88.151d8cdc.js"><link rel="prefetch" href="/blog/assets/js/89.7bd0925d.js"><link rel="prefetch" href="/blog/assets/js/9.51fef0b5.js"><link rel="prefetch" href="/blog/assets/js/90.af7f69c8.js"><link rel="prefetch" href="/blog/assets/js/91.22eec426.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.6d8afabb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">suda-morris 个人博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/cs/" class="nav-link router-link-active">
  CS
</a></div><div class="nav-item"><a href="/blog/ee/" class="nav-link">
  EE
</a></div><div class="nav-item"><a href="/blog/others/" class="nav-link">
  Others
</a></div> <a href="https://github.com/suda-morris/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/cs/" class="nav-link router-link-active">
  CS
</a></div><div class="nav-item"><a href="/blog/ee/" class="nav-link">
  EE
</a></div><div class="nav-item"><a href="/blog/others/" class="nav-link">
  Others
</a></div> <a href="https://github.com/suda-morris/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/blog/cs/about.html" class="sidebar-link">关于本栏目</a></li><li><a href="/blog/cs/bash.html" class="sidebar-link">𝙗𝙖𝙨𝙝 基础</a></li><li><a href="/blog/cs/bit_ops.html" class="sidebar-link">位运算技巧</a></li><li><a href="/blog/cs/cheat_sheet.html" class="sidebar-link">小抄</a></li><li><a href="/blog/cs/cmake.html" class="sidebar-link">𝘾𝙈𝙖𝙠𝙚 基础</a></li><li><a href="/blog/cs/computer_composition.html" class="sidebar-link">计算机组成原理</a></li><li><a href="/blog/cs/concurrent_programming.html" class="sidebar-link">并发编程</a></li><li><a href="/blog/cs/design_pattern.html" class="sidebar-link">设计模式 𝘾 语言描述</a></li><li><a href="/blog/cs/gcc_toolchains.html" class="sidebar-link">𝙂𝘾𝘾 工具链基础</a></li><li><a href="/blog/cs/git.html" class="sidebar-link">𝙂𝙞𝙩 基础</a></li><li><a href="/blog/cs/iptables.html" class="sidebar-link">防火墙 𝙞𝙥𝙩𝙖𝙗𝙡𝙚𝙨 基础</a></li><li><a href="/blog/cs/keras.html" class="sidebar-link">𝙆𝙚𝙧𝙖𝙨 基础</a></li><li><a href="/blog/cs/knowledge_map.html" class="sidebar-link">知识图谱</a></li><li><a href="/blog/cs/logistic_regression.html" class="sidebar-link">逻辑回归</a></li><li><a href="/blog/cs/lwip.html" class="sidebar-link">𝙇𝙬𝙄𝙋 基础</a></li><li><a href="/blog/cs/mbedtls.html" class="sidebar-link">𝙢𝙗𝙚𝙙𝙏𝙇𝙎 基础</a></li><li><a href="/blog/cs/python.html" class="sidebar-link">𝙋𝙮𝙩𝙝𝙤𝙣 基础</a></li><li><a href="/blog/cs/regular_expression.html" aria-current="page" class="active sidebar-link">正则表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/cs/regular_expression.html#元字符" class="sidebar-link">元字符</a></li><li class="sidebar-sub-header"><a href="/blog/cs/regular_expression.html#量词与贪婪" class="sidebar-link">量词与贪婪</a></li><li class="sidebar-sub-header"><a href="/blog/cs/regular_expression.html#分组与引用" class="sidebar-link">分组与引用</a></li><li class="sidebar-sub-header"><a href="/blog/cs/regular_expression.html#匹配模式" class="sidebar-link">匹配模式</a></li><li class="sidebar-sub-header"><a href="/blog/cs/regular_expression.html#断言" class="sidebar-link">断言</a></li><li class="sidebar-sub-header"><a href="/blog/cs/regular_expression.html#转义" class="sidebar-link">转义</a></li><li class="sidebar-sub-header"><a href="/blog/cs/regular_expression.html#流派" class="sidebar-link">流派</a></li><li class="sidebar-sub-header"><a href="/blog/cs/regular_expression.html#处理-unicode" class="sidebar-link">处理 Unicode</a></li><li class="sidebar-sub-header"><a href="/blog/cs/regular_expression.html#常见-ide-对正则表达式的支持" class="sidebar-link">常见 IDE 对正则表达式的支持</a></li></ul></li><li><a href="/blog/cs/risc-v.html" class="sidebar-link">𝑹𝑰𝑺𝑪-𝑽 基础</a></li><li><a href="/blog/cs/scala.html" class="sidebar-link">𝙎𝙘𝙖𝙡𝙖 基础</a></li><li><a href="/blog/cs/think_in_code.html" class="sidebar-link">软件设计思想</a></li><li><a href="/blog/cs/xtensa.html" class="sidebar-link">𝙓𝙩𝙚𝙣𝙨𝙖 基础</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="正则表达式"><a href="#正则表达式" class="header-anchor">#</a> 正则表达式</h1> <p><img src="/blog/assets/img/regular_expression_functioning.54a18454.png" alt="正则表达式的功能"></p> <h2 id="元字符"><a href="#元字符" class="header-anchor">#</a> 元字符</h2> <p><img src="/blog/assets/img/regex_meta_char.115b1f6c.png" alt="元字符"></p> <h2 id="量词与贪婪"><a href="#量词与贪婪" class="header-anchor">#</a> 量词与贪婪</h2> <p><img src="/blog/assets/img/regex_modes.ee5d9a37.png" alt="各种匹配模式"></p> <h3 id="贪婪模式-greedy"><a href="#贪婪模式-greedy" class="header-anchor">#</a> 贪婪模式（Greedy）</h3> <p>正则中，表示次数的量词默认是贪婪的，在贪婪模式下，会尝试尽可能最大长度去匹配。</p> <p>在字符串<code>aaabb</code>中使用正则<code>a*</code>的匹配过程：</p> <p><img src="/blog/assets/img/regex_greedy_example_result.b0c582cb.png" alt="贪婪模式示例"></p> <p><img src="/blog/assets/img/regex_greedy_example.63e5c750.jpg" alt="贪婪模式解析"></p> <h3 id="非贪婪模式-lazy"><a href="#非贪婪模式-lazy" class="header-anchor">#</a> 非贪婪模式（Lazy）</h3> <p>非贪婪模式下，正则会找出长度最小且满足要求的结果。将贪婪模式变成非贪婪模式的方法是：<strong>在量词后面加上<code>?</code></strong></p> <p><img src="/blog/assets/img/regex_lazy_example_result.10e40baa.png" alt="非贪婪模式示例"></p> <h3 id="贪婪和非贪婪的对比"><a href="#贪婪和非贪婪的对比" class="header-anchor">#</a> 贪婪和非贪婪的对比</h3> <p><img src="/blog/assets/img/regex_greedy_lazy_compare.40c03d7a.png" alt="贪婪模式与非贪婪模式的对比"></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> re
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'a*'</span><span class="token punctuation">,</span> <span class="token string">'aaabb'</span><span class="token punctuation">)</span>  <span class="token comment"># 贪婪模式</span>
<span class="token punctuation">[</span><span class="token string">'aaa'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'a*?'</span><span class="token punctuation">,</span> <span class="token string">'aaabb'</span><span class="token punctuation">)</span> <span class="token comment"># 非贪婪模式</span>
<span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="分组与引用"><a href="#分组与引用" class="header-anchor">#</a> 分组与引用</h2> <p><img src="/blog/assets/img/regex_group.43e12b6a.png" alt="正则分组"></p> <p>括号在正则中可以用于分组，被括号括起来的部分“子表达式”会被保存成一个子组，简单来说，第几个括号就是第几个分组。</p> <p>如果正则中出现了括号，那么就会认为，这个子表达式在后续可能会再次被引用，如果我们不打算去引用，建议将其声明为<strong>不保存</strong>子组，以提高正则的性能。实现方法是，在括号里面使用<code>?:</code>进行声明。</p> <table><thead><tr><th></th> <th>正则</th> <th>示例</th></tr></thead> <tbody><tr><td>保存子组</td> <td>(正则)</td> <td>\d{15}(\d{3})?</td></tr> <tr><td>不保存子组</td> <td>(?:正则)</td> <td>\d{15}(?:\d{3})?</td></tr></tbody></table> <p><img src="/blog/assets/img/regex_subgroup.4b14f91e.png" alt="分组"></p> <h3 id="分组的编号"><a href="#分组的编号" class="header-anchor">#</a> 分组的编号</h3> <p>如果要看某个括号里面的内容是第一个分组，该怎么办？我们只需要数左括号（开括号）是第几个，就可以确定是第几个子组。</p> <p><img src="/blog/assets/img/regex_subgroup_index.083b6a8a.png" alt="分组编号"></p> <h3 id="命名分组"><a href="#命名分组" class="header-anchor">#</a> 命名分组</h3> <p>有些语言提供了命名分组，这比数字更有辨识度，不容易出错。格式为：<code>(?P&lt;group-name&gt;regular-expression)</code></p> <h3 id="分组引用"><a href="#分组引用" class="header-anchor">#</a> 分组引用</h3> <table><thead><tr><th>编程语言</th> <th>查找时引用方式</th> <th>替换时引用方式</th></tr></thead> <tbody><tr><td>Python</td> <td>\number</td> <td>\number</td></tr> <tr><td>Java</td> <td>\number</td> <td>$number</td></tr> <tr><td>JavaScript</td> <td>\number</td> <td>$number</td></tr></tbody></table> <p><img src="/blog/assets/img/regex_search_double_word.3951b939.png" alt="正则表达式查找重复单词"></p> <h2 id="匹配模式"><a href="#匹配模式" class="header-anchor">#</a> 匹配模式</h2> <p>匹配模式，指的是正则中一些<strong>改变元字符匹配行为</strong>的方式。常见的匹配模式有 4 种：不区分大小写模式、点号通配模式、多行模式和注释模式。</p> <p>具体做法是，将**模式修饰符 (? 模式标识)**放在整个正则前面。</p> <p><img src="/blog/assets/img/regex_match_mode.e53ccf35.png" alt="匹配模式"></p> <h3 id="不区分大小写模式-case-insensitive"><a href="#不区分大小写模式-case-insensitive" class="header-anchor">#</a> 不区分大小写模式（Case-Insensitive）</h3> <p><img src="/blog/assets/img/regex_case_insensitive_01.eeb074ed.png" alt="正则表达式不区分大小写模式"></p> <p><img src="/blog/assets/img/regex_case_insensitive_02.b630d137.png" alt="正则表达式不区分大小写模式"></p> <p>Python 代码中如何使用不区分大小写的匹配模式</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> re
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r&quot;cat&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CAT Cat cat&quot;</span><span class="token punctuation">,</span> re<span class="token punctuation">.</span>IGNORECASE<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'CAT'</span><span class="token punctuation">,</span> <span class="token string">'Cat'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="点号通配模式-dot-all"><a href="#点号通配模式-dot-all" class="header-anchor">#</a> 点号通配模式（Dot All）</h3> <p>正则中提供了一种模式，让英文的点（.）可以匹配上包括换行的任何字符。</p> <p><img src="/blog/assets/img/regex_dot_all.59b4b56c.png" alt="正则表达式点号通配模式"></p> <h3 id="多行匹配模式-multiline"><a href="#多行匹配模式-multiline" class="header-anchor">#</a> 多行匹配模式（Multiline）</h3> <p>通常情况下，^匹配整个字符串的开头，$ 匹配整个字符串的结尾。</p> <p><img src="/blog/assets/img/regex_start_end.09cbdacb.png" alt="正则表达式开始和结尾"></p> <p>多行模式的作用在于，使  ^ 和 $ 能匹配上每行的开头或结尾。</p> <p><img src="/blog/assets/img/regex_multiline.e3bf8bd8.png" alt="正则表达式多行模式"></p> <p>正则中还有 <code>\A</code> 和 <code>\z</code>（Python 中是 <code>\Z</code>） 这两个元字符容易混淆，<code>\A</code> 仅匹配整个字符串的开始，<code>\z</code> 仅匹配整个字符串的结束，在多行匹配模式下，它们的匹配行为不会改变，如果只想匹配整个字符串，而不是匹配每一行，用这个更严谨一些。</p> <h3 id="注释模式-comment"><a href="#注释模式-comment" class="header-anchor">#</a> 注释模式（Comment）</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">(</span><span class="token punctuation">\</span>w+<span class="token punctuation">)</span><span class="token punctuation">(</span>?<span class="token comment">#word) \1(?#word repeat again)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> re

regex <span class="token operator">=</span> <span class="token triple-quoted-string string">r'''(?mx)  # 使用多行模式和x模式
^          # 开头
(\d{4})    # 年
(\d{2})    # 月
$          # 结尾
'''</span>

re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>regex<span class="token punctuation">,</span> <span class="token string">'202006\n202007'</span><span class="token punctuation">)</span>
<span class="token comment"># 输出结果 [('2020', '06'), ('2020', '07')]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="断言"><a href="#断言" class="header-anchor">#</a> 断言</h2> <p>断言是指对匹配到的文本位置有要求，常见的断言有三种：单词边界、行的开始或结束以及环视。</p> <p><img src="/blog/assets/img/regex_assertion.a1961b74.png" alt="断言"></p> <h3 id="单词边界-word-boundary"><a href="#单词边界-word-boundary" class="header-anchor">#</a> 单词边界（Word Boundary）</h3> <p>正则中使用 <code>\b</code> 来表示单词的边界。</p> <table><thead><tr><th></th> <th>tom<br>单词包含tom</th> <th>\btom<br>以tom开头的单词</th> <th>tom\b<br>以tom结尾的单词</th> <th>\btom\b<br>只能是tom</th></tr></thead> <tbody><tr><td>tom</td> <td>✔️</td> <td>✔️</td> <td>✔️</td> <td>✔️</td></tr> <tr><td>tomorrow</td> <td>✔️</td> <td>✔️</td> <td>✖️</td> <td>✖️</td></tr> <tr><td>atom</td> <td>✔️</td> <td>✖️</td> <td>✔️</td> <td>✖️</td></tr> <tr><td>atomic</td> <td>✔️</td> <td>✖️</td> <td>✖️</td> <td>✖️</td></tr></tbody></table> <h3 id="行的开始或结束"><a href="#行的开始或结束" class="header-anchor">#</a> 行的开始或结束</h3> <p>在多行模式下，<code>^</code> 和 <code>$</code> 符号可以匹配每一行的开头或结尾。大部分实现默认不是多行匹配模式，但也有例外，比如 Ruby 中默认是多行模式。所以对于校验输入数据来说，一种更严谨的做法是，使用 <code>\A</code> 和 <code>\z</code> （Python 中使用 <code>\Z</code>）  来匹配整个文本的开头或结尾。</p> <h3 id="环视-look-around"><a href="#环视-look-around" class="header-anchor">#</a> 环视（Look Around）</h3> <p>环视就是要求匹配部分的前面或后面要满足（或不满足）某种规则，有些地方也称环视为<strong>零宽断言</strong>。</p> <p>环视中虽然也有括号，但不会保存成子组。</p> <table><thead><tr><th>正则</th> <th>名称</th> <th>含义</th> <th>示例</th></tr></thead> <tbody><tr><td>(?&lt;=Y)</td> <td>肯定逆序环视<br>positive-lookbehind</td> <td>左边是Y</td> <td>(?&lt;=\d)th 左边是数字的 th,能匹配 9th</td></tr> <tr><td>(?&lt;!Y)</td> <td>否定逆序环视<br>negative-lookbehind</td> <td>左边不是Y</td> <td>(?&lt;!\d)th 左边不是数字的 th,能匹配 health</td></tr> <tr><td>(?=Y)</td> <td>肯定顺序环视<br>positive-lookahead</td> <td>右边是Y</td> <td>six(?=\d) 右边是数字的 six,能匹配 six6</td></tr> <tr><td>(?!Y)</td> <td>否定顺序环视<br>negative-lookahead</td> <td>右边不是Y</td> <td>hi(?!\d) 右边不是数字的 hi,能匹配 high</td></tr></tbody></table> <p><img src="/blog/assets/img/regex_look_around.3cc80c66.png" alt="环视"></p> <h2 id="转义"><a href="#转义" class="header-anchor">#</a> 转义</h2> <p><img src="/blog/assets/img/regex_escape.da9fb39c.png" alt="转义"></p> <p>正则中转义有些情况下会比较复杂，从录入的字符串文本，到最终的正则表达式，经过了<strong>字符串转义</strong>和<strong>正则转义</strong>两个步骤。</p> <p>一般来说如果我们要想将元字符（.*+?() 之类）表示成它字面上本来的意思，是需要对其进行转义的，但如果它们出现在字符组中括号里，可以不转义。但如果在中括号中出现 \d 或 \w 等符号时，他们还是元字符本身的含义。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> re
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'[.*+?()]'</span><span class="token punctuation">,</span> <span class="token string">'[.*+?()]'</span><span class="token punctuation">)</span>  <span class="token comment"># 单个长度的元字符</span>
<span class="token punctuation">[</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">'+'</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'[\d]'</span><span class="token punctuation">,</span> <span class="token string">'d12\\'</span><span class="token punctuation">)</span>  <span class="token comment"># \w，\d等在中括号中还是元字符的功能</span>
<span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">]</span>  <span class="token comment"># 匹配上了数字，而不是反斜杠\和字母d</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> re
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">'\\n\n\\'</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'\n'</span><span class="token punctuation">]</span>  <span class="token comment"># 找到了换行符</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\\n'</span><span class="token punctuation">,</span> <span class="token string">'\\n\n\\'</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'\n'</span><span class="token punctuation">]</span>  <span class="token comment"># 找到了换行符</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\\\n'</span><span class="token punctuation">,</span> <span class="token string">'\\n\n\\'</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'\n'</span><span class="token punctuation">]</span>  <span class="token comment"># 找到了换行符</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\\\\n'</span><span class="token punctuation">,</span> <span class="token string">'\\n\n\\'</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'\\n'</span><span class="token punctuation">]</span> <span class="token comment"># 找到了反斜杠和字母n</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="流派"><a href="#流派" class="header-anchor">#</a> 流派</h2> <p><img src="/blog/assets/img/regex_flavour.47bced97.png" alt="流派"></p> <h3 id="posix-字符组"><a href="#posix-字符组" class="header-anchor">#</a> POSIX 字符组</h3> <p><img src="/blog/assets/img/regex_posix_charset.c3202495.png" alt="字符组"></p> <h3 id="posix-和-pcre-的主要用法区别"><a href="#posix-和-pcre-的主要用法区别" class="header-anchor">#</a> POSIX 和 PCRE 的主要用法区别</h3> <p><img src="/blog/assets/img/regex_posix_vs_pcre.ebfd6525.png" alt="posix_vs_pcre"></p> <h3 id="linux-工具中选择不同的正则流派"><a href="#linux-工具中选择不同的正则流派" class="header-anchor">#</a> Linux 工具中选择不同的正则流派</h3> <p><img src="/blog/assets/img/regex_linux_grep.a3bbeb6a.png" alt="posix_vs_pcre"></p> <h2 id="处理-unicode"><a href="#处理-unicode" class="header-anchor">#</a> 处理 Unicode</h2> <p><img src="/blog/assets/img/regex_unicode.c2e209e0.png" alt="unicode"></p> <p>Unicode  规定了字符对应的码值，这个码值得编码成字节的形式去传输和存储。最常见的编码方式是 <code>UTF-8</code>，另外还有 <code>UTF-16</code>，<code>UTF-32</code>  等。<code>UTF-8</code> 之所以能够流行起来，是因为其编码比较巧妙，采用的是变长的方法。也就是一个 Unicode 字符，在使用 UTF-8  编码表示时占用 <code>1</code> 到 <code>4</code> 个字节不等。最重要的是 Unicode 兼容 ASCII 编码，在表示纯英文时，并不会占用更多存储空间。而汉字，在 UTF-8 中，通常是用<code>3</code>个字节来表示。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token string">u'正'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token string">b'\xe6\xad\xa3'</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token string">u'则'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token string">b'\xe5\x88\x99'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="unicode-属性"><a href="#unicode-属性" class="header-anchor">#</a> Unicode 属性</h3> <p>Unicode 属性把 Unicode 字符集划分成不同的字符小集合。</p> <p><img src="/blog/assets/img/regex_unicode_property.2ad1c343.jpg" alt="属性"></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>➤ <span class="token builtin class-name">echo</span> <span class="token string">&quot;汉字123&quot;</span> <span class="token operator">|</span> <span class="token function">grep</span> -P <span class="token string">&quot;\p{Han}&quot;</span>                                                                                   00:05:59
汉字123
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="常见-ide-对正则表达式的支持"><a href="#常见-ide-对正则表达式的支持" class="header-anchor">#</a> 常见 IDE 对正则表达式的支持</h2> <p><img src="/blog/assets/img/regex_ide_support.91329d89.jpg" alt="IDE支持情况"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/suda-morris/blog/edit/master/docs/cs/regular_expression.md" target="_blank" rel="noopener noreferrer">编辑此页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/7/13 15:19:54</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/cs/python.html" class="prev">
        𝙋𝙮𝙩𝙝𝙤𝙣 基础
      </a></span> <span class="next"><a href="/blog/cs/risc-v.html">
        𝑹𝑰𝑺𝑪-𝑽 基础
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/blog/assets/js/app.f7371fc1.js" defer></script><script src="/blog/assets/js/4.86db7451.js" defer></script><script src="/blog/assets/js/5.cc2c00ae.js" defer></script><script src="/blog/assets/js/13.4f481eb8.js" defer></script>
  </body>
</html>

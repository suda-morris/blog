<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>RISC-V - ğŸ suda-morris ä¸ªäººåšå®¢ ğŸ‡</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Personal Blog">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../resume.html">å…³äºæˆ‘</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">ä½“ç³»ç»“æ„</li><li class="chapter-item expanded "><a href="../cs/risc-v.html" class="active"><strong aria-hidden="true">1.</strong> RISC-V</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">æ“ä½œç³»ç»Ÿ</li><li class="chapter-item expanded "><a href="../cs/openwrt.html"><strong aria-hidden="true">2.</strong> OpenWRT</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">æ§åˆ¶ç³»ç»Ÿ</li><li class="chapter-item expanded "><a href="../ee/control-system.html"><strong aria-hidden="true">3.</strong> æ§åˆ¶ç³»ç»ŸåŸºç¡€</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">å¤šåª’ä½“</li><li class="chapter-item expanded "><a href="../cs/video-process.html"><strong aria-hidden="true">4.</strong> è§†é¢‘å¤„ç†</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">é€šä¿¡åè®®</li><li class="chapter-item expanded "><a href="../ee/usb.html"><strong aria-hidden="true">5.</strong> USB åè®®åŸºç¡€</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">ç®¡ç†</li><li class="chapter-item expanded "><a href="../cs/git.html"><strong aria-hidden="true">6.</strong> git</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">æ¼”ç¤º</li><li class="chapter-item expanded "><a href="../ux/slides-tool.html"><strong aria-hidden="true">7.</strong> slides å·¥å…·</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ğŸ suda-morris ä¸ªäººåšå®¢ ğŸ‡</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/suda-morris/blog" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/suda-morris/blog/edit/master/src/cs/risc-v.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="risc-v-åŸºç¡€"><a class="header" href="#risc-v-åŸºç¡€">RISC-V åŸºç¡€</a></h1>
<h2 id="å•æ ¸-cpu-ç»„æˆç»“æ„"><a class="header" href="#å•æ ¸-cpu-ç»„æˆç»“æ„">å•æ ¸ CPU ç»„æˆç»“æ„</a></h2>
<p><img src="../images/risc-v/riscv_alu.png" alt="ALU" /></p>
<p><strong>æ•°æ®é€šè·¯</strong>æ˜¯å¤„ç†å™¨ä¸­æ‰§è¡Œå¤„ç†å™¨æ‰€éœ€æ“ä½œçš„ç¡¬ä»¶éƒ¨åˆ†ï¼Œå°±åƒæ˜¯å¤„ç†å™¨çš„å››è‚¢ã€‚</p>
<p><strong>æ§åˆ¶å™¨</strong>æ˜¯å¯¹æ•°æ®é€šè·¯è¦åšä»€ä¹ˆæ“ä½œè¿›è¡Œè¡Œä¸ºè°ƒåº¦çš„ç¡¬ä»¶ç»“æ„ï¼Œå°±åƒæ˜¯å¤„ç†å™¨çš„å¤§è„‘ã€‚</p>
<p><img src="../images/risc-v/riscv_data_path.png" alt="ALU" /></p>
<h2 id="æŒ‡ä»¤é›†åˆ’åˆ†"><a class="header" href="#æŒ‡ä»¤é›†åˆ’åˆ†">æŒ‡ä»¤é›†åˆ’åˆ†</a></h2>
<div class="table-wrapper"><table><thead><tr><th>åŸºæœ¬æŒ‡ä»¤é›†</th><th>æŒ‡ä»¤æ•°</th><th>æè¿°</th></tr></thead><tbody>
<tr><td>RV32I</td><td>47</td><td>32ä½åœ°å€ç©ºé—´ä¸æ•´æ•°æŒ‡ä»¤,æ”¯æŒ32ä¸ªé€šç”¨æ•´æ•°å¯„å­˜å™¨</td></tr>
<tr><td>RV32E</td><td>47</td><td>ä»…æ”¯æŒ16ä¸ªé€šç”¨æ•´æ•°å¯„å­˜å™¨</td></tr>
<tr><td>RV64I</td><td>59</td><td>64ä½åœ°å€ç©ºé—´ä¸æ•´æ•°æŒ‡ä»¤,ä»¥åŠä¸€éƒ¨åˆ†64ä½å’Œ32ä½çš„æŒ‡ä»¤</td></tr>
<tr><td>RV128I</td><td>71</td><td>128ä½åœ°å€ç©ºé—´ä¸æ•´æ•°æŒ‡ä»¤,ä»¥åŠä¸€éƒ¨åˆ†64ä½å’Œ32ä½çš„æŒ‡ä»¤</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>æ‰©å±•æŒ‡ä»¤é›†</th><th>æŒ‡ä»¤æ•°</th><th>æè¿°</th></tr></thead><tbody>
<tr><td>M</td><td>8</td><td>æ•´æ•°ä¹˜æ³•ä¸é™¤æ³•æŒ‡ä»¤</td></tr>
<tr><td>A</td><td>11</td><td>å­˜å‚¨å™¨åŸå­æ“ä½œå’ŒLoad-Reserved/Store-ConditionalæŒ‡ä»¤</td></tr>
<tr><td>F</td><td>26</td><td>å•ç²¾åº¦(32bit)æµ®ç‚¹æŒ‡ä»¤</td></tr>
<tr><td>D</td><td>26</td><td>åŒç²¾åº¦(32bit)æµ®ç‚¹æŒ‡ä»¤,å¿…é¡»æ”¯æŒFæ‰©å±•æŒ‡ä»¤</td></tr>
<tr><td>C</td><td>46</td><td>å‹ç¼©æŒ‡ä»¤,æŒ‡ä»¤é•¿åº¦ä¸º16ä½</td></tr>
</tbody></table>
</div>
<h2 id="åŸºæœ¬æŒ‡ä»¤é›†ç±»å‹"><a class="header" href="#åŸºæœ¬æŒ‡ä»¤é›†ç±»å‹">åŸºæœ¬æŒ‡ä»¤é›†ç±»å‹</a></h2>
<p><img src="../images/risc-v/riscv_instruction_type.png" alt="æŒ‡ä»¤ç¼–ç æ ¼å¼" /></p>
<h3 id="rregisterå‹æŒ‡ä»¤"><a class="header" href="#rregisterå‹æŒ‡ä»¤">R(Register)å‹æŒ‡ä»¤</a></h3>
<p><img src="../images/risc-v/riscv_R_instruction.png" alt="Rå‹æŒ‡ä»¤" /></p>
<h4 id="æŒ‡ä»¤æ±‡ç¼–æ ¼å¼"><a class="header" href="#æŒ‡ä»¤æ±‡ç¼–æ ¼å¼">æŒ‡ä»¤æ±‡ç¼–æ ¼å¼</a></h4>
<h5 id="åŠ æ³•"><a class="header" href="#åŠ æ³•">åŠ æ³•</a></h5>
<pre><code class="language-assembly">add rd, rs1, rs2
</code></pre>
<h5 id="å‡æ³•"><a class="header" href="#å‡æ³•">å‡æ³•</a></h5>
<pre><code class="language-assembly">sub rd, rs1, rs2
</code></pre>
<h5 id="é€»è¾‘ä¸"><a class="header" href="#é€»è¾‘ä¸">é€»è¾‘ä¸</a></h5>
<pre><code class="language-assembly">and rd, rs1, rs2
</code></pre>
<h5 id="é€»è¾‘æˆ–"><a class="header" href="#é€»è¾‘æˆ–">é€»è¾‘æˆ–</a></h5>
<pre><code class="language-assembly">or rd, rs1, rs2
</code></pre>
<h5 id="é€»è¾‘å¼‚æˆ–"><a class="header" href="#é€»è¾‘å¼‚æˆ–">é€»è¾‘å¼‚æˆ–</a></h5>
<pre><code class="language-assembly">xor rd, rs1, rs2
</code></pre>
<h5 id="æœ‰ç¬¦å·å°äºæ¯”è¾ƒ"><a class="header" href="#æœ‰ç¬¦å·å°äºæ¯”è¾ƒ">æœ‰ç¬¦å·å°äºæ¯”è¾ƒ</a></h5>
<pre><code class="language-assembly">slt rd, rs1, rs2
</code></pre>
<h5 id="æ— ç¬¦å·å°äºæ¯”è¾ƒ"><a class="header" href="#æ— ç¬¦å·å°äºæ¯”è¾ƒ">æ— ç¬¦å·å°äºæ¯”è¾ƒ</a></h5>
<pre><code class="language-assembly">sltu rd, rs1, rs2
</code></pre>
<h5 id="é€»è¾‘å·¦ç§»"><a class="header" href="#é€»è¾‘å·¦ç§»">é€»è¾‘å·¦ç§»</a></h5>
<pre><code class="language-assembly">sll rd, rs1, rs2
</code></pre>
<h5 id="é€»è¾‘å³ç§»"><a class="header" href="#é€»è¾‘å³ç§»">é€»è¾‘å³ç§»</a></h5>
<pre><code class="language-assembly">srl rd, rs1, rs2
</code></pre>
<h5 id="ç®—æ•°å³ç§»"><a class="header" href="#ç®—æ•°å³ç§»">ç®—æ•°å³ç§»</a></h5>
<pre><code class="language-assembly">sra rd, rs1, rs2
</code></pre>
<h3 id="iimmediateå‹æŒ‡ä»¤"><a class="header" href="#iimmediateå‹æŒ‡ä»¤">I(Immediate)å‹æŒ‡ä»¤</a></h3>
<p><img src="../images/risc-v/riscv_I_instruction.png" alt="Iå‹æŒ‡ä»¤" /></p>
<h4 id="æŒ‡ä»¤æ±‡ç¼–æ ¼å¼-1"><a class="header" href="#æŒ‡ä»¤æ±‡ç¼–æ ¼å¼-1">æŒ‡ä»¤æ±‡ç¼–æ ¼å¼</a></h4>
<h5 id="ç«‹å³æ•°åŠ æ³•"><a class="header" href="#ç«‹å³æ•°åŠ æ³•">ç«‹å³æ•°åŠ æ³•</a></h5>
<pre><code class="language-assembly">addi rd, rs1, imm[11:0]
</code></pre>
<h5 id="ç«‹å³æ•°é€»è¾‘ä¸"><a class="header" href="#ç«‹å³æ•°é€»è¾‘ä¸">ç«‹å³æ•°é€»è¾‘ä¸</a></h5>
<pre><code class="language-assembly">andi rd, rs1, imm[11:0]
</code></pre>
<h5 id="ç«‹å³æ•°é€»è¾‘æˆ–"><a class="header" href="#ç«‹å³æ•°é€»è¾‘æˆ–">ç«‹å³æ•°é€»è¾‘æˆ–</a></h5>
<pre><code class="language-assembly">ori rd, rs1, imm[11:0]
</code></pre>
<h5 id="ç«‹å³æ•°é€»è¾‘å¼‚æˆ–"><a class="header" href="#ç«‹å³æ•°é€»è¾‘å¼‚æˆ–">ç«‹å³æ•°é€»è¾‘å¼‚æˆ–</a></h5>
<pre><code class="language-assembly">xori rd, rs1, imm[11:0]
</code></pre>
<h5 id="ç«‹å³æ•°æœ‰ç¬¦å·å°äºæ¯”è¾ƒ"><a class="header" href="#ç«‹å³æ•°æœ‰ç¬¦å·å°äºæ¯”è¾ƒ">ç«‹å³æ•°æœ‰ç¬¦å·å°äºæ¯”è¾ƒ</a></h5>
<pre><code class="language-assembly">slti rd, rs1, imm[11:0]
</code></pre>
<h5 id="ç«‹å³æ•°æ— ç¬¦å·å°äºæ¯”è¾ƒ"><a class="header" href="#ç«‹å³æ•°æ— ç¬¦å·å°äºæ¯”è¾ƒ">ç«‹å³æ•°æ— ç¬¦å·å°äºæ¯”è¾ƒ</a></h5>
<pre><code class="language-assembly">sltui rd, rs1, imm[11:0]
</code></pre>
<h5 id="ç«‹å³æ•°é€»è¾‘å·¦ç§»"><a class="header" href="#ç«‹å³æ•°é€»è¾‘å·¦ç§»">ç«‹å³æ•°é€»è¾‘å·¦ç§»</a></h5>
<pre><code class="language-assembly">slli rd, rs1, shamt[4:0]
</code></pre>
<h5 id="ç«‹å³æ•°é€»è¾‘å³ç§»"><a class="header" href="#ç«‹å³æ•°é€»è¾‘å³ç§»">ç«‹å³æ•°é€»è¾‘å³ç§»</a></h5>
<pre><code class="language-assembly">srli rd, rs1, shamt[4:0]
</code></pre>
<h5 id="ç«‹å³æ•°ç®—æ•°å³ç§»"><a class="header" href="#ç«‹å³æ•°ç®—æ•°å³ç§»">ç«‹å³æ•°ç®—æ•°å³ç§»</a></h5>
<pre><code class="language-assembly">srai rd, rs1, shamt[4:0]
</code></pre>
<h3 id="loadstore-æŒ‡ä»¤"><a class="header" href="#loadstore-æŒ‡ä»¤">Load/Store æŒ‡ä»¤</a></h3>
<p><img src="../images/risc-v/riscv_load_store_instruction.png" alt="Load/Store æŒ‡ä»¤" /></p>
<h4 id="æŒ‡ä»¤æ±‡ç¼–æ ¼å¼-2"><a class="header" href="#æŒ‡ä»¤æ±‡ç¼–æ ¼å¼-2">æŒ‡ä»¤æ±‡ç¼–æ ¼å¼</a></h4>
<h5 id="å­—åŠ è½½"><a class="header" href="#å­—åŠ è½½">å­—åŠ è½½</a></h5>
<pre><code class="language-assembly">lw rd, offset[11:0](rs1)
</code></pre>
<h5 id="åŠå­—åŠ è½½"><a class="header" href="#åŠå­—åŠ è½½">åŠå­—åŠ è½½</a></h5>
<pre><code class="language-assembly">lh rd, offset[11:0](rs1)
</code></pre>
<h5 id="æ— ç¬¦å·åŠå­—åŠ è½½"><a class="header" href="#æ— ç¬¦å·åŠå­—åŠ è½½">æ— ç¬¦å·åŠå­—åŠ è½½</a></h5>
<pre><code class="language-assembly">lhu rd, offset[11:0](rs1)
</code></pre>
<h5 id="å­—èŠ‚åŠ è½½"><a class="header" href="#å­—èŠ‚åŠ è½½">å­—èŠ‚åŠ è½½</a></h5>
<pre><code class="language-assembly">lb rd, offset[11:0](rs1)
</code></pre>
<h5 id="æ— ç¬¦å·å­—èŠ‚åŠ è½½"><a class="header" href="#æ— ç¬¦å·å­—èŠ‚åŠ è½½">æ— ç¬¦å·å­—èŠ‚åŠ è½½</a></h5>
<pre><code class="language-assembly">lbu rd, offset[11:0](rs1)
</code></pre>
<h5 id="å­—å­˜å‚¨"><a class="header" href="#å­—å­˜å‚¨">å­—å­˜å‚¨</a></h5>
<pre><code class="language-assembly">sw rs2, offset[11:0](rs1)
</code></pre>
<h5 id="åŠå­—å­˜å‚¨"><a class="header" href="#åŠå­—å­˜å‚¨">åŠå­—å­˜å‚¨</a></h5>
<pre><code class="language-assembly">sh rs2, offset[11:0](rs1)
</code></pre>
<h5 id="å­—èŠ‚å­˜å‚¨"><a class="header" href="#å­—èŠ‚å­˜å‚¨">å­—èŠ‚å­˜å‚¨</a></h5>
<pre><code class="language-assembly">sb rs2, offset[11:0](rs1)
</code></pre>
<h3 id="bbranchå‹æŒ‡ä»¤"><a class="header" href="#bbranchå‹æŒ‡ä»¤">B(Branch)å‹æŒ‡ä»¤</a></h3>
<p><img src="../images/risc-v/riscv_B_instruction.png" alt="Bå‹æŒ‡ä»¤" /></p>
<h4 id="æŒ‡ä»¤æ±‡ç¼–æ ¼å¼-3"><a class="header" href="#æŒ‡ä»¤æ±‡ç¼–æ ¼å¼-3">æŒ‡ä»¤æ±‡ç¼–æ ¼å¼</a></h4>
<h5 id="ç›¸ç­‰è·³è½¬"><a class="header" href="#ç›¸ç­‰è·³è½¬">ç›¸ç­‰è·³è½¬</a></h5>
<pre><code class="language-assembly">beq rs1, rs2, label
</code></pre>
<h5 id="ä¸ç­‰è·³è½¬"><a class="header" href="#ä¸ç­‰è·³è½¬">ä¸ç­‰è·³è½¬</a></h5>
<pre><code class="language-assembly">bne rs1, rs2, label
</code></pre>
<h5 id="å°äºè·³è½¬"><a class="header" href="#å°äºè·³è½¬">å°äºè·³è½¬</a></h5>
<pre><code class="language-assembly">blt rs1, rs2, label
</code></pre>
<h5 id="æ— ç¬¦å·å°äºè·³è½¬"><a class="header" href="#æ— ç¬¦å·å°äºè·³è½¬">æ— ç¬¦å·å°äºè·³è½¬</a></h5>
<pre><code class="language-assembly">bltu rs1, rs2, label
</code></pre>
<h5 id="å¤§äºç­‰äºè·³è½¬"><a class="header" href="#å¤§äºç­‰äºè·³è½¬">å¤§äºç­‰äºè·³è½¬</a></h5>
<pre><code class="language-assembly">bge rs1, rs2, label
</code></pre>
<h5 id="æ— ç¬¦å·å¤§äºç­‰äºè·³è½¬"><a class="header" href="#æ— ç¬¦å·å¤§äºç­‰äºè·³è½¬">æ— ç¬¦å·å¤§äºç­‰äºè·³è½¬</a></h5>
<pre><code class="language-assembly">bgeu rs1, rs2, label
</code></pre>
<h3 id="jjumpå‹æŒ‡ä»¤"><a class="header" href="#jjumpå‹æŒ‡ä»¤">J(Jump)å‹æŒ‡ä»¤</a></h3>
<p><img src="../images/risc-v/riscv_jump_instruction.png" alt="Jå‹æŒ‡ä»¤" /></p>
<h4 id="æŒ‡ä»¤æ±‡ç¼–æ ¼å¼-4"><a class="header" href="#æŒ‡ä»¤æ±‡ç¼–æ ¼å¼-4">æŒ‡ä»¤æ±‡ç¼–æ ¼å¼</a></h4>
<h5 id="æ— æ¡ä»¶è·³è½¬"><a class="header" href="#æ— æ¡ä»¶è·³è½¬">æ— æ¡ä»¶è·³è½¬</a></h5>
<pre><code class="language-assembly">jal rd, label # å°† PC+4 çš„å€¼ä¿å­˜åˆ° rd å¯„å­˜å™¨ä¸­ï¼Œç„¶åè®¾ç½® PC = PC + offset
</code></pre>
<p>ä¼ªæŒ‡ä»¤ <code>j</code> å®é™…ä¸Šå°±æ˜¯jalæŒ‡ä»¤çš„å˜ä½“ï¼Œæ­¤æ—¶ rd ä¼šè¢«è®¾ç½®ä¸º x0,è¡¨ç¤ºä¸¢å¼ƒè¿”å›åœ°å€</p>
<h5 id="æ— æ¡ä»¶ç›¸å¯¹è·³è½¬-i-ç±»å‹æŒ‡ä»¤"><a class="header" href="#æ— æ¡ä»¶ç›¸å¯¹è·³è½¬-i-ç±»å‹æŒ‡ä»¤">æ— æ¡ä»¶ç›¸å¯¹è·³è½¬ (I ç±»å‹æŒ‡ä»¤)</a></h5>
<pre><code class="language-assembly">jalr rd, rs1, imm # å°† PC+4 ä¿å­˜åˆ° rd å¯„å­˜å™¨ä¸­ï¼Œç„¶åè®¾ç½® PC = rs1  + imm
</code></pre>
<p>è·³è½¬åˆ°ä»»æ„ 32 ä½ç»å¯¹åœ°å€å¤„</p>
<pre><code class="language-assembly">lui x1, &lt;hi20bits&gt;
jalr ra, x1, &lt;lo12bits&gt;
</code></pre>
<p>ç›¸å¯¹PCåœ°å€32ä½åç§»é‡çš„ç›¸å¯¹è·³è½¬</p>
<pre><code class="language-assembly">auipc x1, &lt;hi20bits&gt;
jalr x0, x1, &lt;lo12bits&gt;
</code></pre>
<h3 id="uupper-immediateå‹æŒ‡ä»¤"><a class="header" href="#uupper-immediateå‹æŒ‡ä»¤">U(Upper immediate)å‹æŒ‡ä»¤</a></h3>
<p><img src="../images/risc-v/riscv_U_instruction.png" alt="Uå‹æŒ‡ä»¤" /></p>
<h4 id="æŒ‡ä»¤æ±‡ç¼–æ ¼å¼-5"><a class="header" href="#æŒ‡ä»¤æ±‡ç¼–æ ¼å¼-5">æŒ‡ä»¤æ±‡ç¼–æ ¼å¼</a></h4>
<h5 id="lui-æŒ‡ä»¤-load-upper-immediate"><a class="header" href="#lui-æŒ‡ä»¤-load-upper-immediate">lui æŒ‡ä»¤ (Load Upper Immediate)</a></h5>
<pre><code class="language-assembly">lui rs, imm # å°† 20 ä½çš„ç«‹å³æ•°å·¦ç§»12ä½ï¼Œä½ 12 ä½è¡¥é›¶ï¼Œå¹¶å†™å›å¯„å­˜å™¨ rd ä¸­
</code></pre>
<p>é…åˆ addi æŒ‡ä»¤ï¼ˆè®¾ç½®ä½ 12 æ¯”ç‰¹ï¼‰å¯å®ç°è®²å¯„å­˜å™¨è®¾ç½®ä¸ºä»»æ„ 32 æ¯”ç‰¹çš„ç«‹å³æ•°ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="language-assembly">lui x10, 0x87654     # x10 = 0x87654000
addi x10, x10, 0x321 # x10 = 0x87654321
</code></pre>
<p>ä½†æ˜¯ï¼Œå½“è¿™ä¸ª 12 ä½çš„ç«‹å³æ•°ä¸ºè´Ÿæ•°ï¼ˆå³æœ€é«˜æ¯”ç‰¹ä½æ˜¯1ï¼‰æ—¶ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯é«˜ 20 ä½å‡ 1 å†å’Œä½ 12 ä½æ‹¼æ¥ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="language-assembly">lui x10, 0xDEADB     # x10 = 0xDEADB000
addi x10, x10, 0xEEF # x10 = 0xDEADBEEF
</code></pre>
<p>è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯ï¼Œå¦‚æœä½ 12 ä½çš„ç«‹å³æ•°çš„ç¬¦å·ä½æ˜¯ 1 ,é‚£å°±é¢„å…ˆç»™é«˜ 20 ä½çš„æ•°åŠ  1ã€‚<code>li</code> ä¼ªæŒ‡ä»¤å¯ä»¥æ›¿æˆ‘ä»¬å¤„ç†å¥½è¿™ä¸­ç‰¹æ®Šæƒ…å†µã€‚</p>
<h5 id="auipc-æŒ‡ä»¤-add-upper-immediate-to-pc"><a class="header" href="#auipc-æŒ‡ä»¤-add-upper-immediate-to-pc">auipc æŒ‡ä»¤ (Add Upper Immediate to PC)</a></h5>
<pre><code class="language-assembly">auipc rd, imm # å°† 20 ä½çš„ç«‹å³æ•°å·¦ç§»12ä½ï¼Œä½ 12 ä½è¡¥é›¶ï¼Œå°†å¾—åˆ°çš„ 32 ä½æ•°ä¸ pc çš„å€¼ç›¸åŠ ï¼Œæœ€åå†™å›å¯„å­˜å™¨ rd ä¸­
</code></pre>
<p>å…·ä½“åº”ç”¨æœ‰ï¼š</p>
<pre><code class="language-assembly">Label: auipc x10, 0 # å°† Label çš„åœ°å€ä¿å­˜åœ¨ x10 å¯„å­˜å™¨ä¸­
</code></pre>
<h2 id="alu-çš„è®¾è®¡"><a class="header" href="#alu-çš„è®¾è®¡">ALU çš„è®¾è®¡</a></h2>
<p><img src="../images/risc-v/riscv_alu_design.png" alt="ALUè®¾è®¡æ¡†å›¾" /></p>
<h3 id="åŠ æ³•è¿ç®—çš„å®ç°"><a class="header" href="#åŠ æ³•è¿ç®—çš„å®ç°">åŠ æ³•è¿ç®—çš„å®ç°</a></h3>
<pre><code class="language-verilog">module adder #(
parameter N = 8
) (
	input [N - 1 : 0] a,
	input [N - 1 : 0] b,
	input			  cin,

	output [N - 1 : 0] sum,
	output 			   cout
);
	assign {cout, sum} = a + b + cin;
endmodule
</code></pre>
<h3 id="å‡æ³•è¿ç®—çš„å®ç°"><a class="header" href="#å‡æ³•è¿ç®—çš„å®ç°">å‡æ³•è¿ç®—çš„å®ç°</a></h3>
<pre><code class="language-verilog">module subtractor #(
parameter N = 8
) (
    input [N - 1 : 0] a,
    input [N - 1 : 0] b,

    output [N - 1 : 0] y
);
    assign y = a - b;
endmodule
</code></pre>
<h3 id="æ¯”è¾ƒè¿ç®—çš„å®ç°"><a class="header" href="#æ¯”è¾ƒè¿ç®—çš„å®ç°">æ¯”è¾ƒè¿ç®—çš„å®ç°</a></h3>
<h4 id="ç›¸ç­‰æ¯”è¾ƒ"><a class="header" href="#ç›¸ç­‰æ¯”è¾ƒ">ç›¸ç­‰æ¯”è¾ƒ</a></h4>
<p>ç”¨å¼‚æˆ–é—¨æ£€æŸ¥ A å’Œ B ä¸­å¯¹åº”çš„ä½æ˜¯å¦ç›¸ç­‰</p>
<h4 id="é‡å€¼æ¯”è¾ƒå‡æ³•"><a class="header" href="#é‡å€¼æ¯”è¾ƒå‡æ³•">é‡å€¼æ¯”è¾ƒï¼ˆå‡æ³•ï¼‰</a></h4>
<p>é¦–å…ˆè®¡ç®—A-Bçš„å€¼ï¼Œç„¶åæ£€æŸ¥ç»“æœçš„ç¬¦å·ä½</p>
<pre><code class="language-verilog">module comparator #(
parameter N = 8
) (
    input [N - 1 : 0] a,
    input [N - 1 : 0] b

    output eq,
    output neq,
    output lt,
    output lte,
    output gt,
    output gte
);
    assign eq = (a == b);
    assign neq = (a != b);
    assign lt = (a &lt; b);
    assign lte = (a &lt;= b);
    assign gt = (a &gt; b);
    assign gte = (a &gt;= b);
endmodule
</code></pre>
<h2 id="å•æŒ‡ä»¤å‘¨æœŸ-cpu"><a class="header" href="#å•æŒ‡ä»¤å‘¨æœŸ-cpu">å•æŒ‡ä»¤å‘¨æœŸ CPU</a></h2>
<ul>
<li>æŒ‡ä»¤å‘¨æœŸï¼šCPU å–å‡ºå¹¶æ‰§è¡Œä¸€æ¡æŒ‡ä»¤æ‰€éœ€çš„å…¨éƒ¨æ—¶é—´</li>
<li>æŒ‡ä»¤æ‰§è¡Œçš„çš„äº”ä¸ªæ­¥éª¤
<ol>
<li>å–æŒ‡ï¼ˆInstruction Fetchï¼‰</li>
<li>è¯‘ç ï¼ˆInstruction Decodeï¼‰</li>
<li>æ‰§è¡Œï¼ˆExecuteï¼‰</li>
<li>è®¿å­˜ï¼ˆMemory Accessï¼‰</li>
<li>å†™å›ï¼ˆWrite Back)</li>
</ol>
</li>
<li>CPUå‘¨æœŸï¼šä¹Ÿç§°ä¸ºæœºå™¨å‘¨æœŸï¼Œä¸€ä¸ªæœºå™¨å‘¨æœŸç”±è‹¥å¹²ä¸ªæ—¶é’Ÿå‘¨æœŸç»„æˆ</li>
<li>CPI (Clock Cycle Per Instruction)ï¼šæ‰§è¡Œæ¯æ¡æŒ‡ä»¤æ‰€éœ€çš„æ—¶é’Ÿå‘¨æœŸæ•°çš„å¹³å‡å€¼</li>
<li>å•æŒ‡ä»¤å‘¨æœŸCPUï¼šå…¨éƒ¨æŒ‡ä»¤é€‰ç”¨ä¸€ä¸ª CPU å‘¨æœŸå®Œæˆçš„ç³»ç»Ÿ</li>
</ul>
<p><img src="../images/risc-v/single_instruction_CPU.png" alt="å•æŒ‡ä»¤å‘¨æœŸ CPU" /></p>
<h3 id="å¯„å­˜å™¨å †çš„å®ç°"><a class="header" href="#å¯„å­˜å™¨å †çš„å®ç°">å¯„å­˜å™¨å †çš„å®ç°</a></h3>
<p><img src="../images/risc-v/register_file.png" alt="å¯„å­˜å™¨å †" /></p>
<pre><code class="language-verilog">module regfile(rna, rnb, d, wn, we, clk, clrn, qa, qb);
    input [4:0] rna, rnb, wn; // è¯»åœ°å€ï¼Œå†™åœ°å€
    input [31:0] d; // å†™æ•°æ®
    input we, clk, clrn; // å†™ä½¿èƒ½ï¼Œæ—¶é’Ÿï¼Œæ¸…é™¤ä¿¡å·
    output [31:0] qa, qb; // è¯»æ•°æ®

    reg [31:0] register [1:31]; // 31x32-bit regs

    // 2 read ports
    assign qa = (rna == 0) ? 0 : register[rna];
    assign qb = (rnb == 0) ? 0 : register[rnb];

    // 1 write port
    always @(posedge clk or negedge clrn)
        if(clrn == 0) begin
            integer i;
            for(i=1;i&lt;32;i=i+1)
                register[i] &lt;= 0;
        end else if ((wn != 0) &amp;&amp; we)
            register[wn] &lt;= d;
endmodule
</code></pre>
<h3 id="å®Œæ•´çš„æ•°æ®é€šè·¯"><a class="header" href="#å®Œæ•´çš„æ•°æ®é€šè·¯">å®Œæ•´çš„æ•°æ®é€šè·¯</a></h3>
<p><img src="../images/risc-v/riscv_full_data_path.png" alt="å®Œæ•´çš„æ•°æ®é€šè·¯" /></p>
<ul>
<li>è¯‘ç é˜¶æ®µï¼Œä¼šå°†æŒ‡ä»¤çš„åŠŸèƒ½ç å’Œæ“ä½œç å‘é€ç»™<strong>æ§åˆ¶å™¨</strong>ï¼Œæ¥äº§ç”Ÿç›¸åº”çš„æ§åˆ¶ä¿¡å·</li>
<li>ç«‹å³æ•°æ‰©å±•ä¿¡å·ï¼šImmSel</li>
<li>ALU åŠŸèƒ½é€‰æ‹©ä¿¡å·ï¼šALUSel</li>
</ul>
<h3 id="æ§åˆ¶å™¨çš„è®¾è®¡"><a class="header" href="#æ§åˆ¶å™¨çš„è®¾è®¡">æ§åˆ¶å™¨çš„è®¾è®¡</a></h3>
<p><img src="../images/risc-v/riscv_cpu_controller_truth_table.png" alt="æ§åˆ¶å™¨çš„è®¾è®¡" /></p>
<h3 id="r-å‹æŒ‡ä»¤æ•°æ®é€šè·¯"><a class="header" href="#r-å‹æŒ‡ä»¤æ•°æ®é€šè·¯">R å‹æŒ‡ä»¤æ•°æ®é€šè·¯</a></h3>
<p><img src="../images/risc-v/riscv_R_instruction_data_path.png" alt="Rå‹æŒ‡ä»¤æ•°æ®é€šè·¯" /></p>
<ul>
<li><code>ALUSel</code> ä¼šæ ¹æ®æŒ‡ä»¤çš„ <code>funct3</code>æ¥å–ä¸åŒçš„å€¼</li>
</ul>
<h3 id="i-å‹æŒ‡ä»¤æ•°æ®é€šè·¯"><a class="header" href="#i-å‹æŒ‡ä»¤æ•°æ®é€šè·¯">I å‹æŒ‡ä»¤æ•°æ®é€šè·¯</a></h3>
<p><img src="../images/risc-v/riscv_I_instruction_data_path.png" alt="Iå‹æŒ‡ä»¤æ•°æ®é€šè·¯" /></p>
<h3 id="load-æŒ‡ä»¤æ•°æ®é€šè·¯"><a class="header" href="#load-æŒ‡ä»¤æ•°æ®é€šè·¯">Load æŒ‡ä»¤æ•°æ®é€šè·¯</a></h3>
<p><img src="../images/risc-v/riscv_load_instruction_data_path.png" alt="LoadæŒ‡ä»¤æ•°æ®é€šè·¯" /></p>
<h3 id="store-æŒ‡ä»¤æ•°æ®é€šè·¯"><a class="header" href="#store-æŒ‡ä»¤æ•°æ®é€šè·¯">Store æŒ‡ä»¤æ•°æ®é€šè·¯</a></h3>
<p><img src="../images/risc-v/riscv_store_instruction_data_path.png" alt="StoreæŒ‡ä»¤æ•°æ®é€šè·¯" /></p>
<ul>
<li>ç«‹å³æ•°æ¥è‡ª<code>inst[31:25][11:7]</code>ï¼Œè¿™ä¸ªå’ŒLoadä¸åŒ</li>
<li>StoreæŒ‡ä»¤æ²¡æœ‰<strong>å†™å›</strong>é˜¶æ®µ</li>
</ul>
<h3 id="b-å‹æŒ‡ä»¤æ•°æ®é€šè·¯"><a class="header" href="#b-å‹æŒ‡ä»¤æ•°æ®é€šè·¯">B å‹æŒ‡ä»¤æ•°æ®é€šè·¯</a></h3>
<p><img src="../images/risc-v/riscv_B_instruction_data_path.png" alt="BæŒ‡ä»¤æ•°æ®é€šè·¯" /></p>
<ul>
<li>æ— <strong>è®¿å­˜</strong>å’Œ<strong>å†™å›</strong>é˜¶æ®µ</li>
</ul>
<h3 id="jalr-æŒ‡ä»¤æ•°æ®é€šè·¯"><a class="header" href="#jalr-æŒ‡ä»¤æ•°æ®é€šè·¯">jalr æŒ‡ä»¤æ•°æ®é€šè·¯</a></h3>
<p><img src="../images/risc-v/riscv_jalr_instruction_data_path.png" alt="jalræŒ‡ä»¤æ•°æ®é€šè·¯" /></p>
<ul>
<li>PC+4 çš„å€¼ä¼šä¿å­˜åˆ°<code>rd</code> ä¸­</li>
</ul>
<h3 id="jal-æŒ‡ä»¤æ•°æ®é€šè·¯"><a class="header" href="#jal-æŒ‡ä»¤æ•°æ®é€šè·¯">jal æŒ‡ä»¤æ•°æ®é€šè·¯</a></h3>
<p><img src="../images/risc-v/riscv_jal_instruction_data_path.png" alt="jalæŒ‡ä»¤æ•°æ®é€šè·¯" /></p>
<h2 id="æµæ°´çº¿æŠ€æœ¯"><a class="header" href="#æµæ°´çº¿æŠ€æœ¯">æµæ°´çº¿æŠ€æœ¯</a></h2>
<p><img src="../images/risc-v/riscv_pipeline.png" alt="æµæ°´çº¿æŠ€æœ¯" /></p>
<h3 id="å¤„ç†å™¨æ€§èƒ½å…¬å¼"><a class="header" href="#å¤„ç†å™¨æ€§èƒ½å…¬å¼">å¤„ç†å™¨æ€§èƒ½å…¬å¼</a></h3>
<p>$$
ProgramTime = \frac{Instructions}{Program} * \frac{Cycle s}{Instruction} * \frac{Time}{Cycle}
$$</p>
<h3 id="æµæ°´çº¿é˜¶æ®µå¯„å­˜å™¨"><a class="header" href="#æµæ°´çº¿é˜¶æ®µå¯„å­˜å™¨">æµæ°´çº¿é˜¶æ®µå¯„å­˜å™¨</a></h3>
<p>ä¸ºäº†ç¡®ä¿ç¡¬ä»¶å…±äº«çš„æ—¶å€™ï¼Œå‰ä¸€é˜¶æ®µçš„æ•°æ®ä¸è¢«ä¸¢å¤±ï¼Œéœ€è¦åœ¨æµæ°´çº¿ä¹‹é—´æ’å…¥â€œé˜¶æ®µå¯„å­˜å™¨â€æ¥ä¿å­˜ä¸­é—´å€¼å’Œæ§åˆ¶ä¿¡å·ã€‚</p>
<p><img src="../images/risc-v/riscv_pipeline_registers.png" alt="æµæ°´çº¿å¯„å­˜å™¨" /></p>
<h2 id="cache"><a class="header" href="#cache">Cache</a></h2>
<p><img src="../images/risc-v/riscv_cache.png" alt="Cache" /></p>
<h3 id="cache-çš„ç»“æ„"><a class="header" href="#cache-çš„ç»“æ„">Cache çš„ç»“æ„</a></h3>
<p><img src="../images/risc-v/riscv_cache_structure.png" alt="Cacheçš„ç»“æ„" /></p>
<ul>
<li>å—ï¼ˆblockï¼‰ï¼šä¸¤çº§å­˜å‚¨å™¨å±‚æ¬¡ç»“æ„ä¸­å­˜å‚¨å™¨ä¿¡æ¯äº¤æ¢çš„æœ€å°å•å…ƒ</li>
<li>å‘½ä¸­ï¼ˆhitï¼‰ï¼šå¦‚æœå¤„ç†å™¨éœ€è¦çš„æ•°æ®å­˜æ”¾åœ¨é«˜å±‚å­˜å‚¨å™¨ä¸­çš„æŸä¸ªå—ä¸­ï¼Œç§°ä¸ºä¸€æ¬¡å‘½ä¸­</li>
<li>ç¼ºå¤±ï¼ˆmissï¼‰ï¼šå¦‚æœåœ¨é«˜å±‚å­˜å‚¨å™¨ä¸­æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€çš„æ•°æ®ï¼Œè¿™æ¬¡æ•°æ®è¯·æ±‚ç§°ä¸ºä¸€æ¬¡ç¼ºå¤±
<ul>
<li>ç¼ºå¤±ä»£ä»·ï¼ˆmiss penaltyï¼‰ï¼šå°†ç›¸åº”çš„å—ä»åº•å±‚å­˜å‚¨å™¨æ›¿æ¢åˆ°é«˜å±‚å­˜å‚¨å™¨çš„æ—¶é—´+å°†è¯¥ä¿¡æ¯å—ä¼ é€ç»™å¤„ç†å™¨çš„æ—¶é—´</li>
</ul>
</li>
</ul>
<h3 id="cache-ç›´æ¥æ˜ å°„"><a class="header" href="#cache-ç›´æ¥æ˜ å°„">Cache ç›´æ¥æ˜ å°„</a></h3>
<p>ç›´æ¥æ˜ å°„ï¼šä¸€ç§ cache ç»“æ„ï¼Œå…¶ä¸­æ¯ä¸ªå­˜å‚¨å™¨åœ°å€ä»…ä»…å¯¹åº”åˆ° cache ä¸­çš„ä¸€ä¸ªä½ç½®</p>
<p>æ˜ å°„æ–¹æ³•ï¼šï¼ˆå—åœ°å€ï¼‰modï¼ˆcache ä¸­çš„å—æ•°ï¼‰</p>
<p>æ ‡è®°ï¼šè¡¨ä¸­çš„ä¸€ä¸ªå­—æ®µï¼ŒåŒ…å«äº†åœ°å€ä¿¡æ¯ï¼Œè¿™äº›åœ°å€ä¿¡æ¯å¯ä»¥ç”¨æ¥åˆ¤æ–­cacheä¸­çš„å­—æ˜¯å¦å°±æ˜¯æ‰€è¯·æ±‚çš„å­—</p>
<p>æœ‰æ•ˆä½ï¼šè¡¨ä¸­çš„ä¸€ä¸ªå­—æ®µï¼Œç”¨æ¥æ ‡è¯†ä¸€ä¸ªå—æ˜¯å¦åŒ…å«æœ‰ä¸€ä¸ªæœ‰æ•ˆæ•°æ®</p>
<p><img src="../images/risc-v/riscv_cache_direct_mapping.png" alt="Cacheç›´æ¥æ˜ å°„" /></p>
<p><img src="../images/risc-v/riscv_cache_direct_mapping_example.png" alt="Cacheç›´æ¥æ˜ å°„ç¤ºä¾‹" /></p>
<p>ç¼ºç‚¹ï¼šåˆ©ç”¨ç‡ä½ï¼Œå‘½ä¸­ç‡ä½</p>
<h3 id="cache-å…¨ç›¸è”æ˜ å°„"><a class="header" href="#cache-å…¨ç›¸è”æ˜ å°„">Cache å…¨ç›¸è”æ˜ å°„</a></h3>
<p>å…¨ç›¸è”æ˜ å°„ï¼šä¸€ä¸ªå—å¯ä»¥è¢«æ”¾ç½®åœ¨ cache ä¸­çš„ä»»ä½•ä½ç½®</p>
<p><img src="../images/risc-v/riscv_cache_full_association_mapping.png" alt="Cacheå…¨ç›¸è”æ˜ å°„" /></p>
<p><img src="../images/risc-v/riscv_cache_full_association_mapping_example.png" alt="Cacheå…¨ç›¸è”æ˜ å°„ç¤ºä¾‹" /></p>
<p>ç¼ºç‚¹ï¼šç¡¬ä»¶å¼€é”€å¤§ï¼ˆæœ‰å¤šå°‘cacheå—å°±é…æœ‰ç›¸ç­‰æ•°é‡çš„æ¯”è¾ƒå™¨ï¼‰</p>
<h3 id="cache-ç»„ç›¸è”æ˜ å°„"><a class="header" href="#cache-ç»„ç›¸è”æ˜ å°„">Cache ç»„ç›¸è”æ˜ å°„</a></h3>
<p>åœ¨ç»„ç›¸è”æ˜ å°„ä¸­ï¼Œæ¯ä¸ªå—å¯è¢«æ”¾ç½®çš„ä½ç½®æ•°æ˜¯å›ºå®šçš„ï¼Œæ¯ä¸ªå—æœ‰ n ä¸ªä½ç½®å¯æ”¾çš„ cache è¢«ç§°ä¸º n è·¯ç»„ç›¸è” Cache</p>
<p><img src="../images/risc-v/riscv_set_associative_cache.png" alt="Cacheç»„ç›¸è”æ˜ å°„" /></p>
<p><img src="../images/risc-v/riscv_set_associative_cache_example.png" alt="Cacheç»„ç›¸è”æ˜ å°„ç¤ºä¾‹" /></p>
<p>å››è·¯ç»„ç›¸è” Cacheï¼š</p>
<ul>
<li>4 ä¸ªæ¯”è¾ƒå™¨</li>
<li>1 ä¸ªå››é€‰ä¸€å¤šè·¯é€‰æ‹©å™¨</li>
</ul>
<h3 id="cache-çš„è®¾è®¡"><a class="header" href="#cache-çš„è®¾è®¡">Cache çš„è®¾è®¡</a></h3>
<ul>
<li>è¦è€ƒè™‘çš„ç»´åº¦
<ul>
<li>Cache çš„å®¹é‡</li>
<li>å—å¤§å°</li>
<li>ç»„ç»‡æ–¹å¼ï¼ˆDirectï¼ŒFully Associativeï¼ŒSet Associativeï¼‰</li>
<li>æ›¿æ¢ç®—æ³•ï¼ˆFIFOï¼ŒLRUï¼‰</li>
<li>å†™ç­–ç•¥ï¼ˆwrite-through, write-backï¼‰</li>
</ul>
</li>
</ul>
<h2 id="è™šæ‹Ÿåœ°å€"><a class="header" href="#è™šæ‹Ÿåœ°å€">è™šæ‹Ÿåœ°å€</a></h2>
<p><img src="../images/risc-v/riscv_mmu.png" alt="è™šæ‹Ÿå­˜å‚¨å™¨ç®¡ç†" /></p>
<h3 id="åˆ†æ®µç®¡ç†"><a class="header" href="#åˆ†æ®µç®¡ç†">åˆ†æ®µç®¡ç†</a></h3>
<p><img src="../images/risc-v/riscv_mmu_segment_manage.png" alt="åˆ†æ®µç®¡ç†" /></p>
<p>åˆ†æ®µç®¡ç†ï¼šå°†ä¸€ä¸ªç¨‹åºæŒ‰ç…§é€»è¾‘å•å…ƒåˆ†æˆå¤šä¸ªç¨‹åºæ®µï¼Œæ¯ä¸€ä¸ªæ®µä½¿ç”¨è‡ªå·±å•ç‹¬çš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚</p>
<ul>
<li>é€»è¾‘ä¸Šç›¸äº’ç‹¬ç«‹</li>
<li>å®¹æ˜“å®ç°å…±äº«å’Œä¿æŠ¤</li>
<li>éå¸¸å®¹æ˜“äº§ç”Ÿç¢ç‰‡ï¼ˆæ®µé•¿æ˜¯ä¸ç¡®å®šçš„ï¼‰</li>
</ul>
<h3 id="åˆ†é¡µç®¡ç†"><a class="header" href="#åˆ†é¡µç®¡ç†">åˆ†é¡µç®¡ç†</a></h3>
<p><img src="../images/risc-v/riscv_mmu_page_manage.png" alt="åˆ†é¡µç®¡ç†" /></p>
<ul>
<li>å¦‚æœé¡µè¡¨é¡¹ä¸º4å­—èŠ‚ï¼Œé‚£ä¹ˆæ•´å¼ é¡µè¡¨ä¼šå æ®4MBå¤§å°çš„å†…å­˜ç©ºé—´</li>
</ul>
<h3 id="ä¸¤çº§åˆ†é¡µç®¡ç†"><a class="header" href="#ä¸¤çº§åˆ†é¡µç®¡ç†">ä¸¤çº§åˆ†é¡µç®¡ç†</a></h3>
<p><img src="../images/risc-v/riscv_mmu_two_level_page_manage.png" alt="ä¸¤çº§åˆ†é¡µç®¡ç†" /></p>
<ul>
<li>4KBçš„é¡µç›®å½•+4KBçš„é¡µè¡¨</li>
</ul>
<h3 id="å¿«é€Ÿåœ°å€è½¬æ¢-tlb"><a class="header" href="#å¿«é€Ÿåœ°å€è½¬æ¢-tlb">å¿«é€Ÿåœ°å€è½¬æ¢ TLB</a></h3>
<p><img src="../images/risc-v/riscv_tlb.png" alt="å—è¡¨" /></p>
<p>å—è¡¨ï¼ˆTranslation-Lookaside Bufferï¼‰ï¼šç”¨äºè®°å½•æœ€è¿‘ä½¿ç”¨åœ°å€çš„æ˜ å°„ä¿¡æ¯çš„é«˜é€Ÿç¼“å­˜ï¼Œä»è€Œå¯ä»¥é¿å…æ¯æ¬¡éƒ½è¦è®¿é—®é¡µè¡¨</p>
<h3 id="ä½¿ç”¨-tlb-è¿›è¡Œåœ°å€è½¬æ¢"><a class="header" href="#ä½¿ç”¨-tlb-è¿›è¡Œåœ°å€è½¬æ¢">ä½¿ç”¨ TLB è¿›è¡Œåœ°å€è½¬æ¢</a></h3>
<p><img src="../images/risc-v/riscv_tlb_location.png" alt="TLBçš„ä½ç½®" /></p>
<p><img src="../images/risc-v/riscv_tlb_translation.png" alt="TLBå®ç°åœ°å€è½¬æ¢çš„åŸç†" /></p>
<p><img src="../images/risc-v/riscv_vma_pma_translation.png" alt="TLBè™šå®åœ°å€è½¬æ¢" /></p>
<h2 id="é€šç”¨å¯„å­˜å™¨ç»„"><a class="header" href="#é€šç”¨å¯„å­˜å™¨ç»„">é€šç”¨å¯„å­˜å™¨ç»„</a></h2>
<div class="table-wrapper"><table><thead><tr><th>å¯„å­˜å™¨</th><th>ABI åå­—</th><th>æè¿°</th><th>Saver</th></tr></thead><tbody>
<tr><td>x0</td><td>zero</td><td>ç¡¬ä»¶è¿çº¿0</td><td>-</td></tr>
<tr><td>x1</td><td>ra</td><td>è¿”å›åœ°å€</td><td>Caller</td></tr>
<tr><td>x2</td><td>sp</td><td>æ ˆæŒ‡é’ˆ</td><td>Callee</td></tr>
<tr><td>x3</td><td>gp</td><td>å…¨å±€æŒ‡é’ˆ</td><td>-</td></tr>
<tr><td>x4</td><td>tp</td><td>çº¿ç¨‹æŒ‡é’ˆ</td><td>-</td></tr>
<tr><td>x5-x7</td><td>t0-t2</td><td>ä¸´æ—¶å¯„å­˜å™¨</td><td>Caller</td></tr>
<tr><td>x8</td><td>s0/fp</td><td>ä¿å­˜çš„å¯„å­˜å™¨/å¸§æŒ‡é’ˆ</td><td>Callee</td></tr>
<tr><td>x9</td><td>s1</td><td>ä¿å­˜å¯„å­˜å™¨<br />ä¿å­˜åŸè¿›ç¨‹ä¸­çš„å…³é”®æ•°æ®ï¼Œ<br />é¿å…åœ¨å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­è¢«ç ´å</td><td>Callee</td></tr>
<tr><td>x10-x11</td><td>a0-a1</td><td>å‡½æ•°å‚æ•°/è¿”å›å€¼</td><td>Caller</td></tr>
<tr><td>x12-x17</td><td>a2-a7</td><td>å‡½æ•°å‚æ•°</td><td>Caller</td></tr>
<tr><td>x18-x27</td><td>s2-s11</td><td>ä¿å­˜å¯„å­˜å™¨</td><td>Callee</td></tr>
<tr><td>x28-x31</td><td>t3-t6</td><td>ä¸´æ—¶å¯„å­˜å™¨</td><td>Caller</td></tr>
</tbody></table>
</div>
<h3 id="å‡½æ•°è°ƒç”¨æ—¶ä¿ç•™çš„å¯„å­˜å™¨"><a class="header" href="#å‡½æ•°è°ƒç”¨æ—¶ä¿ç•™çš„å¯„å­˜å™¨">å‡½æ•°è°ƒç”¨æ—¶ä¿ç•™çš„å¯„å­˜å™¨</a></h3>
<p>è¢«è°ƒç”¨å‡½æ•°ä¸€èˆ¬ä¸ä¼šä½¿ç”¨è¿™äº›å¯„å­˜å™¨ï¼Œå³ä¾¿ä½¿ç”¨ä¹Ÿä¼šæå‰ä¿å­˜å¥½åŸå€¼ï¼Œå¯ä»¥ä¿¡ä»»ã€‚è¿™äº›å¯„å­˜å™¨æœ‰ï¼šsp, gp, tp å’Œ s0-s11 å¯„å­˜å™¨ã€‚</p>
<h3 id="å‡½æ•°è°ƒç”¨æ—¶ä¸ä¿å­˜çš„å¯„å­˜å™¨"><a class="header" href="#å‡½æ•°è°ƒç”¨æ—¶ä¸ä¿å­˜çš„å¯„å­˜å™¨">å‡½æ•°è°ƒç”¨æ—¶ä¸ä¿å­˜çš„å¯„å­˜å™¨</a></h3>
<p>æœ‰å¯èƒ½è¢«è°ƒç”¨å‡½æ•°ä½¿ç”¨æ›´æ”¹ï¼Œéœ€è¦calleråœ¨è°ƒç”¨å‰å¯¹è‡ªå·±ç”¨åˆ°çš„å¯„å­˜å™¨è¿›è¡Œä¿å­˜ã€‚è¿™äº›å¯„å­˜å™¨æœ‰ï¼šå‚æ•°ä¸è¿”å›åœ°å€å¯„å­˜å™¨ a0-a7ï¼Œè¿”å›åœ°å€å¯„å­˜å™¨ raï¼Œä¸´æ—¶å¯„å­˜å™¨ t0-t6</p>
<h2 id="csr-å¯„å­˜å™¨ç»„"><a class="header" href="#csr-å¯„å­˜å™¨ç»„">CSR å¯„å­˜å™¨ç»„</a></h2>
<h3 id="ç‹¬ç«‹çš„12ä½åœ°å€ç¼–ç ç©ºé—´"><a class="header" href="#ç‹¬ç«‹çš„12ä½åœ°å€ç¼–ç ç©ºé—´">ç‹¬ç«‹çš„12ä½åœ°å€ç¼–ç ç©ºé—´</a></h3>
<p><img src="../images/risc-v/csr_register_encoding.png" alt="CSRå¯„å­˜å™¨è®¿é—®æŒ‡ä»¤çš„ç¼–ç " /></p>
<h3 id="ä¸“ç”¨çš„-csr-æŒ‡ä»¤è¯»å†™-csr-å¯„å­˜å™¨"><a class="header" href="#ä¸“ç”¨çš„-csr-æŒ‡ä»¤è¯»å†™-csr-å¯„å­˜å™¨">ä¸“ç”¨çš„ CSR æŒ‡ä»¤è¯»å†™ CSR å¯„å­˜å™¨</a></h3>
<p><img src="../images/risc-v/riscv_csr_register_access_instruction.png" alt="CSRå¯„å­˜å™¨è®¿é—®æŒ‡ä»¤" /></p>
<h3 id="æ ‡å‡†å¯„å­˜å™¨åˆ—è¡¨"><a class="header" href="#æ ‡å‡†å¯„å­˜å™¨åˆ—è¡¨">æ ‡å‡†å¯„å­˜å™¨åˆ—è¡¨</a></h3>
<h4 id="machine-mode"><a class="header" href="#machine-mode">Machine Mode</a></h4>
<div class="table-wrapper"><table><thead><tr><th>åç§°</th><th>åœ°å€</th><th>å±æ€§</th><th>å¤‡æ³¨</th></tr></thead><tbody>
<tr><td>mvendorid</td><td>0xF11</td><td>RO</td><td>å•†ä¸šä¾›åº”å•†ç¼–å·å¯„å­˜å™¨</td></tr>
<tr><td>marchid</td><td>0xF12</td><td>RO</td><td>æ¶æ„ç¼–å·å¯„å­˜å™¨</td></tr>
<tr><td>mimpid</td><td>0xF13</td><td>RO</td><td>ç¡¬ä»¶å®ç°ç¼–å·å¯„å­˜å™¨</td></tr>
<tr><td>mhartid</td><td>0xF14</td><td>RO</td><td>Hartç¼–å·å¯„å­˜å™¨ (Hart: Hardware Thread)</td></tr>
<tr><td>mstatus</td><td>0x300</td><td>RW</td><td>å¼‚å¸¸å¤„ç†çŠ¶æ€å¯„å­˜å™¨</td></tr>
<tr><td>misa</td><td>0x301</td><td>RO</td><td>æŒ‡ä»¤é›†æ¶æ„å¯„å­˜å™¨</td></tr>
<tr><td>mie</td><td>0x304</td><td>RW</td><td>å±€éƒ¨ä¸­æ–­å±è”½æ§åˆ¶å¯„å­˜å™¨</td></tr>
<tr><td>mtvec</td><td>0x305</td><td>RW</td><td>å¼‚å¸¸å…¥å£åŸºåœ°å€å¯„å­˜å™¨</td></tr>
<tr><td>mtvt</td><td>0x307</td><td>RW</td><td>ä¸­æ–­å‘é‡è¡¨çš„åŸºåœ°å€ï¼Œè‡³å°‘ä¸º <strong>64byte</strong> å¯¹é½</td></tr>
<tr><td>mscratch</td><td>0x340</td><td>RW</td><td>æš‚å­˜å¯„å­˜å™¨ï¼Œæ¯”å¦‚è¿›å…¥å¼‚å¸¸å¤„ç†æ¨¡å¼åï¼Œå°†åº”ç”¨ç¨‹åºçš„ç”¨æˆ·çš„ sp å¯„å­˜å™¨ä¸´æ—¶ä¿å­˜åˆ°è¿™ä¸ªå¯„å­˜å™¨ä¸­</td></tr>
<tr><td>mepc</td><td>0x341</td><td>RW</td><td>å¼‚å¸¸PCå¯„å­˜å™¨</td></tr>
<tr><td>mcause</td><td>0x342</td><td>RW</td><td>å¼‚å¸¸åŸå› å¯„å­˜å™¨</td></tr>
<tr><td>mtval</td><td>0x343</td><td>RW</td><td>å¼‚å¸¸å€¼å¯„å­˜å™¨ï¼Œä¿å­˜è¿›å…¥å¼‚å¸¸ä¹‹å‰å‡ºé”™æŒ‡ä»¤çš„ç¼–ç å€¼æˆ–è€…å­˜å‚¨å™¨è®¿é—®çš„åœ°å€å€¼</td></tr>
<tr><td>mip</td><td>0x344</td><td>RW</td><td>ä¸­æ–­ç­‰å¾…å¯„å­˜å™¨</td></tr>
<tr><td>mnxti</td><td>0x345</td><td>RW</td><td>è¯»æ“ä½œè¿”å›å€¼æ˜¯ä¸‹ä¸€ä¸ªä¸­æ–­çš„handleråœ°å€ï¼Œå†™å›æ“ä½œä¼šæ›´æ–°ä¸­æ–­ä½¿èƒ½çš„çŠ¶æ€</td></tr>
<tr><td>mintstatus</td><td>0x346</td><td>RO</td><td>ç”¨äºä¿å­˜å½“å‰ä¸­æ–­ Level</td></tr>
<tr><td>mscratchcsw</td><td>0x348</td><td>RW</td><td>ç”¨äºåœ¨ç‰¹æƒæ¨¡å¼å˜åŒ–æ—¶äº¤æ¢mscratchä¸ç›®çš„å¯„å­˜å™¨çš„å€¼</td></tr>
<tr><td>mscratchcswl</td><td>0x349</td><td>RW</td><td>ç”¨äºåœ¨ä¸­æ–­Levelå˜åŒ–æ—¶äº¤æ¢mscratchä¸ç›®çš„å¯„å­˜å™¨çš„å€¼</td></tr>
<tr><td>mcycle</td><td>0xB00</td><td>RW</td><td>å‘¨æœŸè®¡æ•°å™¨çš„ä½32ä½</td></tr>
<tr><td>mcycleh</td><td>0xB80</td><td>RW</td><td>å‘¨æœŸè®¡æ•°å™¨çš„é«˜32ä½</td></tr>
<tr><td>minstret</td><td>0xB02</td><td>RW</td><td>å®ŒæˆæŒ‡ä»¤è®¡æ•°å™¨çš„ä½32ä½ï¼Œè¯¥å¯„å­˜å™¨ç”¨äºè¡¡é‡å¤„ç†å™¨çš„æ€§èƒ½</td></tr>
<tr><td>minstrech</td><td>0xB82</td><td>RW</td><td>å®ŒæˆæŒ‡ä»¤è®¡æ•°å™¨çš„é«˜32ä½</td></tr>
</tbody></table>
</div>
<h4 id="user-mode"><a class="header" href="#user-mode">User Mode</a></h4>
<div class="table-wrapper"><table><thead><tr><th>åç§°</th><th>åœ°å€</th><th>å±æ€§</th><th>å¤‡æ³¨</th></tr></thead><tbody>
<tr><td>cycle</td><td>0xC00</td><td>RO</td><td>mcycleå¯„å­˜å™¨çš„åªè¯»å‰¯æœ¬</td></tr>
<tr><td>time</td><td>0xC01</td><td>RO</td><td>mtimeå¯„å­˜å™¨çš„åªè¯»å‰¯æœ¬</td></tr>
<tr><td>instret</td><td>0xC02</td><td>RO</td><td>minstretå¯„å­˜å™¨çš„åªè¯»å‰¯æœ¬</td></tr>
<tr><td>cycleh</td><td>0xC80</td><td>RO</td><td>mcyclehå¯„å­˜å™¨çš„åªè¯»å‰¯æœ¬</td></tr>
<tr><td>timeh</td><td>0xC81</td><td>RO</td><td>mtimehå¯„å­˜å™¨çš„åªè¯»å‰¯æœ¬</td></tr>
<tr><td>instreth</td><td>0xC82</td><td>RO</td><td>minstrethå¯„å­˜å™¨çš„åªè¯»å‰¯æœ¬</td></tr>
</tbody></table>
</div>
<h2 id="risc-v-çš„ä¸­æ–­"><a class="header" href="#risc-v-çš„ä¸­æ–­">RISC-V çš„ä¸­æ–­</a></h2>
<p><img src="../images/risc-v/riscv_interrupt_enter.png" alt="è¿›å…¥ä¸­æ–­" /></p>
<p><img src="../images/risc-v/riscv_interrupt_exit.png" alt="é€€å‡ºä¸­æ–­" /></p>
<h3 id="ä¸­æ–­å’Œå¼‚å¸¸ç›¸å…³çš„å¯„å­˜å™¨"><a class="header" href="#ä¸­æ–­å’Œå¼‚å¸¸ç›¸å…³çš„å¯„å­˜å™¨">ä¸­æ–­å’Œå¼‚å¸¸ç›¸å…³çš„å¯„å­˜å™¨</a></h3>
<p><img src="../images/risc-v/riscv_exception_csr_registers.png" alt="å¼‚å¸¸ç›¸å…³çš„CSRå¯„å­˜å™¨" /></p>
<p><img src="../images/risc-v/riscv_exception_csr_register_definitions.png" alt="å¼‚å¸¸ç›¸å…³çš„CSRå¯„å­˜å™¨å…·ä½“å®šä¹‰" /></p>
<h3 id="mstatus"><a class="header" href="#mstatus">mstatus</a></h3>
<ul>
<li>MIEï¼šä¸º1è¡¨ç¤ºä¸­æ–­çš„å…¨å±€å¼€å…³æ‰“å¼€ï¼Œä¸­æ–­èƒ½å¤Ÿè¢«æ­£å¸¸å“åº”</li>
<li>FSï¼šç»´æŠ¤æµ®ç‚¹å•å…ƒçš„çŠ¶æ€ã€‚ä¸Šç”µé»˜è®¤ä¸º0,è¡¨ç¤ºOffï¼Œä¸ºäº†èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨æµ®ç‚¹å•å…ƒï¼Œè½¯ä»¶éœ€è¦ä½¿ç”¨ CSR å†™æŒ‡ä»¤å°† FS çš„å€¼æ”¹å†™ä¸ºé 0 å€¼ä»¥æ‰“å¼€æµ®ç‚¹å•å…ƒçš„åŠŸèƒ½ã€‚æ“ä½œç³»ç»Ÿåœ¨è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ—¶å€™ï¼Œéœ€è¦é€šè¿‡è¯¥å€¼æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦å¯¹æµ®ç‚¹å•å…ƒè¿›è¡Œä¸Šä¸‹æ–‡çš„ä¿å­˜</li>
<li>XSï¼šç»´æŠ¤ç”¨æˆ·è‡ªå®šä¹‰çš„æ‰©å±•æŒ‡ä»¤å•å…ƒçŠ¶æ€ï¼Œç±»ä¼¼ä¸ FS</li>
</ul>
<h3 id="mtvec"><a class="header" href="#mtvec">mtvec</a></h3>
<p><img src="../images/risc-v/riscv_exception_mtvec_register.png" alt="mtvecå¯„å­˜å™¨" /></p>
<h3 id="å¼‚å¸¸ä»£ç "><a class="header" href="#å¼‚å¸¸ä»£ç ">å¼‚å¸¸ä»£ç </a></h3>
<p><img src="../images/risc-v/riscv_machine_exception_codes.png" alt="å¼‚å¸¸ä»£ç " /></p>
<h3 id="ä¸­æ–­è¿”å›"><a class="header" href="#ä¸­æ–­è¿”å›">ä¸­æ–­è¿”å›</a></h3>
<p><img src="../images/risc-v/riscv_exception_return.png" alt="ä¸­æ–­è¿”å›" /></p>
<h3 id="ä¸­æ–­å±è”½ä¸ä¸­æ–­ç­‰å¾…"><a class="header" href="#ä¸­æ–­å±è”½ä¸ä¸­æ–­ç­‰å¾…">ä¸­æ–­å±è”½ä¸ä¸­æ–­ç­‰å¾…</a></h3>
<p><img src="../images/risc-v/riscv_interrupt_enable_pending.png" alt="ä¸­æ–­å±è”½å’Œç­‰å¾…ç›¸å…³é¢å¯„å­˜å™¨" /></p>
<h3 id="ä¸­æ–­ä¼˜å…ˆçº§"><a class="header" href="#ä¸­æ–­ä¼˜å…ˆçº§">ä¸­æ–­ä¼˜å…ˆçº§</a></h3>
<p><img src="../images/risc-v/riscv_interrupt_priority.png" alt="ä¸­æ–­ä¼˜å…ˆçº§" /></p>
<h3 id="å•æŒ‡ä»¤æ•°æ®é€šè·¯çš„ä¸­æ–­å“åº”ä¸é€€å‡º"><a class="header" href="#å•æŒ‡ä»¤æ•°æ®é€šè·¯çš„ä¸­æ–­å“åº”ä¸é€€å‡º">å•æŒ‡ä»¤æ•°æ®é€šè·¯çš„ä¸­æ–­å“åº”ä¸é€€å‡º</a></h3>
<p><img src="../images/risc-v/riscv_one_cycle_intruction_interrupt_enter.png" alt="ä¸­æ–­å“åº”" /></p>
<p><img src="../images/risc-v/riscv_one_cycle_intruction_interrupt_exit.png" alt="ä¸­æ–­é€€å‡º" /></p>
<h2 id="risc-v-æ¶æ„çš„å¯æ‰©å±•æ€§"><a class="header" href="#risc-v-æ¶æ„çš„å¯æ‰©å±•æ€§">RISC-V æ¶æ„çš„å¯æ‰©å±•æ€§</a></h2>
<h3 id="æŒ‡ä»¤é›†çš„æ‰©å±•"><a class="header" href="#æŒ‡ä»¤é›†çš„æ‰©å±•">æŒ‡ä»¤é›†çš„æ‰©å±•</a></h3>
<p><img src="../images/risc-v/riscv_isa_extension.png" alt="æŒ‡ä»¤é›†æ‰©å±•" /></p>
<h3 id="æŒ‡ä»¤ç¼–ç ç©ºé—´çš„æ‰©å±•"><a class="header" href="#æŒ‡ä»¤ç¼–ç ç©ºé—´çš„æ‰©å±•">æŒ‡ä»¤ç¼–ç ç©ºé—´çš„æ‰©å±•</a></h3>
<p><img src="../images/risc-v/riscv_isa_custom_instruction.png" alt="æŒ‡ä»¤ç¼–ç ç©ºé—´çš„æ‰©å±•" /></p>
<ul>
<li>custom-0ã€custom-1ç”¨äº RV32 çš„è‡ªå®šä¹‰æŒ‡ä»¤é›†æ‰©å±•</li>
<li>custom-2ã€custom-3é¢„ç•™ç»™ RV128ï¼Œä¹Ÿå¯ä»¥ç”¨äº RV32ã€RV64çš„ç”¨æˆ·è‡ªå®šä¹‰æŒ‡ä»¤é›†æ‰©å±•</li>
</ul>
<h2 id="å¸¸ç”¨ä¼ªæŒ‡ä»¤"><a class="header" href="#å¸¸ç”¨ä¼ªæŒ‡ä»¤">å¸¸ç”¨ä¼ªæŒ‡ä»¤</a></h2>
<h5 id="èµ‹å€¼æŒ‡ä»¤"><a class="header" href="#èµ‹å€¼æŒ‡ä»¤">èµ‹å€¼æŒ‡ä»¤</a></h5>
<pre><code class="language-assembly">mv rd, rs # ç­‰æ•ˆäº addi rd, rs, x0
</code></pre>
<h5 id="åŠ è½½ç«‹å³æ•°"><a class="header" href="#åŠ è½½ç«‹å³æ•°">åŠ è½½ç«‹å³æ•°</a></h5>
<pre><code class="language-assembly">li rd, 13 # ç­‰æ•ˆäº addi rd, x0, 13
</code></pre>
<h5 id="å‡½æ•°è°ƒç”¨å’Œè¿”å›"><a class="header" href="#å‡½æ•°è°ƒç”¨å’Œè¿”å›">å‡½æ•°è°ƒç”¨å’Œè¿”å›</a></h5>
<pre><code class="language-assembly">jal my_foo # å‡½æ•°è°ƒç”¨
ret # å‡½æ•°è¿”å›ï¼Œç­‰æ•ˆäº jr raï¼Œç­‰æ•ˆäº jalr x0, ra, 0
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../resume.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../cs/openwrt.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../resume.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../cs/openwrt.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_line_numbers = true;
        </script>
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="../editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
